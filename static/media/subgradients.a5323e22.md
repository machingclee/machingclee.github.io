title: Convex Analysis - More on Convex Functions and Characterize Convex lsc Functions by Biconjugate Functionals
date: 2021-08-11
id: blog0014
tag: math
intro: Digest the material from <a href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.591.6898&rep=rep1&type=pdf"> Convex Analysis</a> by  Gert Wanka. I modify the proofs by quite a bit once there is available theorem in my mind that is not presented in the text or I have alternative proofs from other material.

##### Continuity 

Denote $\nn (x_0)$ the set of open neighhorhoods of $x_0$ in $X$, where $X$ is a real normed vector space if not otherwise specified. 

Also recall that 
$$
\dom f = \{x\in X:f(x)<\infty\},
$$
which is defined in the previous article on convexity. We will always require a function be convex on the entire normed space $X$ ***for convenience***. For practical situation our $C:=\dom f$ will be convex and we can extend a function  $f$ defined on $C$ globally to a function $\tilde f$ on $X$ by defining $\tilde f|_{X\setminus C} \equiv \infty$.

Many nice properties are preserved in this global extension: convexity, lower semi-continuity, unique local minimum (if exists), etc, still hold. Convexity and unique local minimum are obvious, we can argue lower semi-continuity in this way: Let $C\subseteq X$ be **closed**, we will see that $f:C\to \R$ is lower semi-continuous iff $\{f\leq \alpha\}$ is closed in $C$ iff 
$$
\{x\in C: f(x)\leq \alpha\} =  (\{\tilde f\leq \alpha \}\cap C) \sqcup \underbrace{(\{\tilde f\leq \alpha \}\cap (X\setminus  C))}_{=\emptyset} = \{x\in X:\tilde f(x)\leq \alpha \}
$$
is closed in $X$ iff $\tilde f$ is lower semi-continuous.

We will keep our focus on convex functions defined on the entire $X$.


> **Proposition.** Let $X$ be a real normed space and  $f:X\to \ol\R$ a convex function. If there is a $U\in \nn(x_0)$ such that $f|_U$ is bounded above by a finite constant, then $f$ is continuous at $x_0$. 

<proof>

***Proof.***  WLOG we assume $x_0=0$ and $f(0)=0$, otherwise consider the new function $\tilde f (x):= f(x+x_0) - f(x_0)$.  We may also assume that the finite constant is positive and let $c = \sup_{x\in U}f(x) > 0$.

Now define $V=U\cap (-U)\in \nn(0)$, which is a symmetric region. If $x\in \epsilon V$, then  
$$
x=(1-\epsilon)\cdot 0 +\epsilon\brac{\frac{1}{\epsilon}x}\implies f(x)\leq  \epsilon f\brac{\frac{x}{\epsilon}}
$$
and
$$
0 = \frac{1}{1+\epsilon}x +\frac{\epsilon}{1+\epsilon}\brac{-\frac{1}{\epsilon}x}\implies f(x)\ge -\epsilon f\brac{-\frac{x}{\epsilon}},
$$
since $\pm \frac{1}{\epsilon}x \in V$, we have $f(x)\leq \epsilon c$ and $f(x)\ge -\epsilon c$, i.e., $|f(x)|\leq \epsilon c$.

</proof>

> **Proposition.** Let $X$ be a real normed space and $f:X\to \ol\R$ a convex function. The following statements are equivalent:
> 1.  There is a nonempty open set $M$ on which $f\not\equiv -\infty$ and is bounded above by a constant $c<\infty$.
> 2.  $f$ is a proper function and is continous at each point of $(\dom f)^\circ\neq \emptyset$.

**Proof.** 2) implies 1) obviously. 

Suppose now 1) holds, then for some $x_0\in X$, there is $U\in \nn (x_0)$ such that $f|_U<c$, then $f$ is continuous at $x_0$. Not only that, $f(x)>-\infty$ for every $x\in X$ by property 6 in [this blog post](#/blog/Convex-Analysis-Characterization-of-Convex-lsc-Functions)</a>, therefore $f$ is proper. 

WLOG let's assume $U=B(x_0,\rho)$.

**Intuition.**  For any $x_1\in X$, we choose $\delta>1$ such that $x_v=x_0+\delta(x_1-x_0)$ is a point beyond the line segment $[x_0,x_1]$. Now we can geometrically draw two lines from $x_v$ that are tangent to $B(x,\rho)$, and choose a maximal $r>0$ such that $B(x_1,r)$ lies within the cone generated by $x_v$ and the two tangents. 

<center>
<img width="520" src="/assets/maths/cone-extension.png"/>
</center>
<br/>


By similar triangles 
$$
\frac{r}{\rho} =  \frac{\|x_v-x_1\|}{\|x_v-x_0\|} = \frac{(\delta-1)\|x_1-x_0\|}{\delta\|x_1-x_0\|}, 
$$
and hence $r= (1-\frac{1}{\delta})\rho$. With this $r$, we can project every point in $B(x_1,r)$ uniquely to a point in $B(x_0,\rho)$, and hopefully boundedness of $f$ on $B(x_0,\rho)$ can shed some light to the boundedness of $f$ on $B(x_1,r)$.  


<proof>

**Actual Proof.** Let $x_1\in (\dom f)^\circ$, still denote $x_v =x_0+\delta(x_1-x_0) $ as above, where $\delta>1$ and close enough to $1$ so that $V:=B(x_1,(1-\frac{1}{\delta})\rho)\subseteq \dom f$ and that $x_v\in \dom f$. 

For every $x\in V$, $x = x_1 + (1-\frac{1}{\delta})z$ for some $z\in B(0,\rho)$, and thus 
$$
\begin{aligned}
x &=  x_1- \brac{1-\frac{1}{\delta}}x_0+ \brac{1-\frac{1}{\delta}}\overbrace{(x_0+z)}^{\in B(x_0,\rho)} \\
& =\frac{1}{\delta}(\underbrace{x_0+\delta(x_1-x_0)}_{=x_v}) + \brac{1-\frac{1}{\delta}}(x_0+z),
\end{aligned}
$$
it follows that 
$$
f(x)\leq \frac{1}{\delta}f(x_v) + \brac{1-\frac{1}{\delta}}f(x_0+z)\leq \frac{1}{\delta}f(x_v) +\brac{1-\frac{1}{\delta}} c=:c'.
$$
It is clear that $x_v = x_0+\delta(x_1-x_0)$ is independent of $x$, so is $c'$. Therefore $f|_{B(x_1,(1-\frac{1}{\delta})\rho)} < c'$. By the proposition right above, $f$ is continuous at $x_1$. But $x_1\in (\dom f)^\circ$ is arbitrary, thus $f$ is a proper continuous function on $(\dom f)^\circ$.

</proof>


> **Proposition.**  Let $X$ be a real normed space, $f:X\to \ol\R$ convex and continuous at $x_0\in (\dom f)^\circ$, then $f$ is locally lipschitz at $x_0$.

<proof>

***Proof.***  From $x_0$ an interior point and that $f$ continuous at $x_0$, we can choose $\delta>0$ such that $B(x_0,2\delta)\subseteq \dom f$ and that $f|_{B(x_0,2\delta)}\leq L$ for some $L>0$. Let $x,y\in B(x_0,2\delta)$ and $x\neq y$. The only trick in the proof is to construct the third point $z\in B(x_0,2\delta)$ which lies slightly outside the segment $[x,y]$. To this end, we pick 
$$
z = y + \delta \frac{y-x}{\|x-y\|},
$$
so that $z-x_0 = (y-x_0) + \delta \frac{y-x}{\|x-y\|}$ and thus $\|z-x_0\|< 2\delta$. Here comes the magic: Let $\alpha = \|x-y\|$, then 
$$
z =y+ \frac{\delta}{\alpha}(y-x) =\brac{1+\frac{\delta}{\alpha}}y - \frac{\delta}{\alpha}x\iff y =\frac{\alpha}{\alpha+\delta}z + \frac{\delta}{\alpha +\delta}x,
$$ 
convexity and subtraction by $f(x)$ tell us 
$$
f(y)-f(x)\leq \frac{\alpha}{\alpha+\delta}(f(z)-f(x))\leq \frac{\alpha}{\delta}|f(z)-f(x)|\leq \frac{2L\alpha}{\delta}.
$$ 
We interchange $x,y$ to get $f(x)-f(y)\leq \frac{2L\alpha}{\delta}$, and hence 
$$
|f(x)-f(y)|\leq \frac{2L\alpha}{\delta}=\frac{2L}{\delta} \|x-y\|.
$$

</proof>



##### Conjugate Functionals

> **Definition.** Let $f:X\to \ol \R$, the function $f^*:X^*\to \ol \R$ defined by 
> $$
> f^* (x^*) := \sup_{x\in X} (\inner{x^*,x}-f(x))
> $$
> is called the ***conjugate functional to $\bf{f}$***.  

For more computational examples of $f^*$ one may start from page 51 of this <a href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.591.6898&rep=rep1&type=pdf">lecture notes</a>.

> **Proposition.** Let $f:X\to \ol \R$, then $f$ has the following properties:
> 
> 1. **Young's inequality.** When $f(x)>-\infty$, $f(x)+f^*(x^*)\ge \inner{x^*,x}$
> 
> 2. $f^*(0)=\sup_{x\in X}(\inner{0, x} -f(x)) =\sup_{x\in X}(-f(x)) = -\inf_{x\in X} f(x)$
> 
> 3. $f\leq g$ on $X$ $\implies$ $f^*\ge g^*$ on $X^*$
> 
> 4. $(\sup_{i\in I}f_i)^* \leq \inf_{i\in I}f_i^*$
> 
> 5. $(\lambda f)^*(x^*) = \lambda f^*(\frac{1}{\lambda}x^*)$ for every $\lambda >0$
> 
> 6. Let $f_\alpha(x) = f(x-a)$, then $f^*_\alpha (x^*) = f^*(x^*) + \inner{x^*,\alpha}$

In the following recall that for convex function $f:X\to \ol\R$, lower semi-continuity and weakly sequentially lower semi-continuity are the same (we have proved it in <a href="#/blog/Convex-Analysis-Characterization-of-Convex-lsc-Functions">this post</a>).


> **Proposition.** Let $f:X\to \ol \R$, then $f^*$ is convex and weakly sequentially lower semi-continuous.

> **Proposition.** Let $f:X\to \ol\R$ be a proper convex and lower semi-continuous, then $f^*$ is also proper.

<proof>

***Proof.***  Since $f$ is proper, $\dom f\neq \emptyset$, therefore there is $x_0\in \dom f$ such that $f(x_0)<\infty$. Now for every $x^*\in X^*$, 
$$
f^*(x^*) = \sup_{x\in X}(\inner{x^*,x}-f(x)) \ge \inner{x^*,x_0}-f(x_0) >-\infty.
$$
Take $x_0\in \dom f$,  then $(x_0,f(x_0)-1)\not\in \epi f$. Since $f$ is lower semi-continuous, its epigraph $\epi f$ is norm closed, and therefore by Hahn-Banach theorem (with $A=\{(x_0,f(x_0)-1)\}$ compact and $B = \epi f$ closed), there is $x^*\in X^*$ and $\alpha^*\in \R$ and $c\in \R$ such that  
$$
\inner{x^*, x_0}+\alpha^*(f(x_0)-1)< c\leq \inner{x^*, y} +\alpha^*\beta\tag*{$(*)$}
$$
for every $(y,\beta)\in \epi f$. Now $c\in \R\implies \alpha^* \ge 0$, and if $\alpha^*=0$ then $\inner{x^*,x_0}<c\leq \inner{x^*,y} $ for every $y\in X$, which is a contradiction when $y=x_0$. Therefore $\alpha^*>0$.

Finally, take $(y,\beta)=(y,f(y))\in \epi f$, by the rightmost inequality of $(*)$ we rearrage to conclude 
$$
-\frac{c}{\alpha^*} \ge \inner{-\frac{x^*}{\alpha^*}, y} -f(y),\quad \forall y\in X\implies\infty> -\frac{c}{\alpha^*} \ge \sup_{y\in Y}\brac{\inner{-\frac{x^*}{\alpha^*}, y} -f(y)} = f^*(-x^*/\alpha^*),
$$
we conclude that $\dom f^*\neq \emptyset$.

</proof>


Note that it is tempting to define $f^{**}$ analogusly as a function on $X^{**}$. But then it losses its duality in the various properties of $f^*$. Instead we will define $f^{**}$ on $i(X)\subseteq X^{**}$, where $i:X\to X^{**}$ is the canonical embedding $i(x)=i_x$, with $i_x(T)=Tx$ for every $T\in X^*$. It is known that $\|x\| = \|i_x\|_{X^{**}}$.


> **Definition.**  Let $f^*:X^*\to \ol\R$ be the conjugate function to $f:X\to \ol\R$, then the function $f^{**}:X=i(X)\to \ol \R$ defined by 
> $$
> f^{**}(x=i_x) := \sup_{x^*\in X^*} (\underbrace{\inner{x^*,x}}_{=\inner{i_x,x^*}}-f^*(x^*))
> $$
> is called the **biconjugate functional to $\bf f$**.

From the discussion around the definition of $f^{**}$ we immediately obtain same set of properties of $f^*$. Morever, by Young's inequality we have 
$$
f^{**}(x) =\sup_{x^*\in X^*}(\inner{x^*,x}-f^*(x^*) )\leq \sup_{x^*\in  X^*}(\inner{x^*,x}-\inner{x^*,x}+f(x))=f(x).
$$
Therefore $f^{**}\leq f$ always holds by default. The following gives the chraracterization of all function $f$ that makes the equality hold:

> **Fenchel-Moreau Theorem.** Let $f:X\to \ol \R$ be proper, then $f$ is convex and lower semi-continuous if and only if $f^{**}=f$.

<proof>


***Proof.***  Suppose $f=f^{**}$, then since $f$ is proper, so is $f^{**}$, and since $f = (f^*)^*$, $f$ is convex and weakly sequentially lower semi-continuous, and thus lower semi-continuous.

Conversely, suppose that $f$ is convex and lsc, then by default $f^{**}\leq f$, we now prove the reverse inequality. Let $\alpha$ be any affine minorant of $f$, then $\alpha \leq f$, but then $\alpha^* \ge f^*$ and $\alpha=\alpha^{**}\leq f^{**}$. Here $\alpha =\alpha^{**}$ by brute force computation and the fact $\alpha(\cdot) = \inner{x^*,\cdot}+a$ for some $x^*\in X^*$ and $a\in \R$. By the last theorem of <a href="#/blog/Convex-Analysis-Characterization-of-Convex-lsc-Functions">this post</a>, $f$ is pointwise equal to the supremum of its affine minorants, we have $f\leq f^{**}$. 

</proof>

##### References
* https://www.math.utah.edu/~tan/Convex%20Analysis/CA%20-%20Chapter1.pdf
* https://www.math.cuhk.edu.hk/course_builder/1920/math4230/Note5.pdf
* https://webspace.science.uu.nl/~balde101/cao10/cursus10_1.pdf
* http://math.uchicago.edu/~may/REU2014/REUPapers/Peng.pdf
* https://www.math.cuhk.edu.hk/course_builder/1718/math2060a/Notes%201.%20Convex%20Functions%202018.pdf
* https://www.math.cuhk.edu.hk/course_builder/1920/math4230/fenchelconjugate.pdf