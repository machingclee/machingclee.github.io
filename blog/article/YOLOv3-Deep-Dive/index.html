<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><link href="https://cdn.rawgit.com/dreampulse/computer-modern-web-font/master/fonts.css" rel="stylesheet"><link rel="icon" href="/favicon.ico?version=2"><link href="/assets/fonts/font-style.css" rel="stylesheet"><link rel="preload" href="/assets/images/background_img.jpg" as="image"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#000000"><meta name="Ching Cheong" content="Ching Cheong"><meta name="Lee Ching Cheong" content="Lee Ching Cheong"><meta property="og:description" content="Lee Ching Cheong's Personal Homepage"><meta property="description" content="Lee Ching Cheong's Personal Homepage"><link rel="apple-touch-icon" href="/favicon.ico?version=2"><link rel="manifest" href="/manifest.json"><title>CCLee / Blog / YOLOv3 Deep Dive</title><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QGQRTXJSNS"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-QGQRTXJSNS")</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" id=""></script><link href="/static/css/2.d36edc37.chunk.css" rel="stylesheet"><link href="/static/css/main.4cf52b72.chunk.css" rel="stylesheet"><style data-jss="" data-meta="MuiTouchRipple">
.MuiTouchRipple-root {
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 0;
  overflow: hidden;
  position: absolute;
  border-radius: inherit;
  pointer-events: none;
}
.MuiTouchRipple-ripple {
  opacity: 0;
  position: absolute;
}
.MuiTouchRipple-rippleVisible {
  opacity: 0.3;
  animation: MuiTouchRipple-keyframes-enter 550ms cubic-bezier(0.4, 0, 0.2, 1);
  transform: scale(1);
}
.MuiTouchRipple-ripplePulsate {
  animation-duration: 200ms;
}
.MuiTouchRipple-child {
  width: 100%;
  height: 100%;
  display: block;
  opacity: 1;
  border-radius: 50%;
  background-color: currentColor;
}
.MuiTouchRipple-childLeaving {
  opacity: 0;
  animation: MuiTouchRipple-keyframes-exit 550ms cubic-bezier(0.4, 0, 0.2, 1);
}
.MuiTouchRipple-childPulsate {
  top: 0;
  left: 0;
  position: absolute;
  animation: MuiTouchRipple-keyframes-pulsate 2500ms cubic-bezier(0.4, 0, 0.2, 1) 200ms infinite;
}
@-webkit-keyframes MuiTouchRipple-keyframes-enter {
  0% {
    opacity: 0.1;
    transform: scale(0);
  }
  100% {
    opacity: 0.3;
    transform: scale(1);
  }
}
@-webkit-keyframes MuiTouchRipple-keyframes-exit {
  0% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}
@-webkit-keyframes MuiTouchRipple-keyframes-pulsate {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(0.92);
  }
  100% {
    transform: scale(1);
  }
}
</style><style data-jss="" data-meta="MuiButtonBase">
.MuiButtonBase-root {
  color: inherit;
  border: 0;
  cursor: pointer;
  margin: 0;
  display: inline-flex;
  outline: 0;
  padding: 0;
  position: relative;
  align-items: center;
  user-select: none;
  border-radius: 0;
  vertical-align: middle;
  -moz-appearance: none;
  justify-content: center;
  text-decoration: none;
  background-color: transparent;
  -webkit-appearance: none;
  -webkit-tap-highlight-color: transparent;
}
.MuiButtonBase-root::-moz-focus-inner {
  border-style: none;
}
.MuiButtonBase-root.Mui-disabled {
  cursor: default;
  pointer-events: none;
}
@media print {
  .MuiButtonBase-root {
    -webkit-print-color-adjust: exact;
  }
}
</style><style data-jss="" data-meta="MuiButton">
.MuiButton-root {
  color: rgba(0, 0, 0, 0.87);
  padding: 6px 16px;
  font-size: 0.875rem;
  min-width: 64px;
  box-sizing: border-box;
  transition: background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
  font-family: "Roboto", "Helvetica", "Arial", sans-serif;
  font-weight: 500;
  line-height: 1.75;
  border-radius: 4px;
  letter-spacing: 0.02857em;
  text-transform: uppercase;
}
.MuiButton-root:hover {
  text-decoration: none;
  background-color: rgba(0, 0, 0, 0.04);
}
.MuiButton-root.Mui-disabled {
  color: rgba(0, 0, 0, 0.26);
}
@media (hover: none) {
  .MuiButton-root:hover {
    background-color: transparent;
  }
}
.MuiButton-root:hover.Mui-disabled {
  background-color: transparent;
}
.MuiButton-label {
  width: 100%;
  display: inherit;
  align-items: inherit;
  justify-content: inherit;
}
.MuiButton-text {
  padding: 6px 8px;
}
.MuiButton-textPrimary {
  color: #3f51b5;
}
.MuiButton-textPrimary:hover {
  background-color: rgba(63, 81, 181, 0.04);
}
@media (hover: none) {
  .MuiButton-textPrimary:hover {
    background-color: transparent;
  }
}
.MuiButton-textSecondary {
  color: #f50057;
}
.MuiButton-textSecondary:hover {
  background-color: rgba(245, 0, 87, 0.04);
}
@media (hover: none) {
  .MuiButton-textSecondary:hover {
    background-color: transparent;
  }
}
.MuiButton-outlined {
  border: 1px solid rgba(0, 0, 0, 0.23);
  padding: 5px 15px;
}
.MuiButton-outlined.Mui-disabled {
  border: 1px solid rgba(0, 0, 0, 0.12);
}
.MuiButton-outlinedPrimary {
  color: #3f51b5;
  border: 1px solid rgba(63, 81, 181, 0.5);
}
.MuiButton-outlinedPrimary:hover {
  border: 1px solid #3f51b5;
  background-color: rgba(63, 81, 181, 0.04);
}
@media (hover: none) {
  .MuiButton-outlinedPrimary:hover {
    background-color: transparent;
  }
}
.MuiButton-outlinedSecondary {
  color: #f50057;
  border: 1px solid rgba(245, 0, 87, 0.5);
}
.MuiButton-outlinedSecondary:hover {
  border: 1px solid #f50057;
  background-color: rgba(245, 0, 87, 0.04);
}
.MuiButton-outlinedSecondary.Mui-disabled {
  border: 1px solid rgba(0, 0, 0, 0.26);
}
@media (hover: none) {
  .MuiButton-outlinedSecondary:hover {
    background-color: transparent;
  }
}
.MuiButton-contained {
  color: rgba(0, 0, 0, 0.87);
  box-shadow: 0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12);
  background-color: #e0e0e0;
}
.MuiButton-contained:hover {
  box-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);
  background-color: #d5d5d5;
}
.MuiButton-contained.Mui-focusVisible {
  box-shadow: 0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12);
}
.MuiButton-contained:active {
  box-shadow: 0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12);
}
.MuiButton-contained.Mui-disabled {
  color: rgba(0, 0, 0, 0.26);
  box-shadow: none;
  background-color: rgba(0, 0, 0, 0.12);
}
@media (hover: none) {
  .MuiButton-contained:hover {
    box-shadow: 0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12);
    background-color: #e0e0e0;
  }
}
.MuiButton-contained:hover.Mui-disabled {
  background-color: rgba(0, 0, 0, 0.12);
}
.MuiButton-containedPrimary {
  color: #fff;
  background-color: #3f51b5;
}
.MuiButton-containedPrimary:hover {
  background-color: #303f9f;
}
@media (hover: none) {
  .MuiButton-containedPrimary:hover {
    background-color: #3f51b5;
  }
}
.MuiButton-containedSecondary {
  color: #fff;
  background-color: #f50057;
}
.MuiButton-containedSecondary:hover {
  background-color: #c51162;
}
@media (hover: none) {
  .MuiButton-containedSecondary:hover {
    background-color: #f50057;
  }
}
.MuiButton-disableElevation {
  box-shadow: none;
}
.MuiButton-disableElevation:hover {
  box-shadow: none;
}
.MuiButton-disableElevation.Mui-focusVisible {
  box-shadow: none;
}
.MuiButton-disableElevation:active {
  box-shadow: none;
}
.MuiButton-disableElevation.Mui-disabled {
  box-shadow: none;
}
.MuiButton-colorInherit {
  color: inherit;
  border-color: currentColor;
}
.MuiButton-textSizeSmall {
  padding: 4px 5px;
  font-size: 0.8125rem;
}
.MuiButton-textSizeLarge {
  padding: 8px 11px;
  font-size: 0.9375rem;
}
.MuiButton-outlinedSizeSmall {
  padding: 3px 9px;
  font-size: 0.8125rem;
}
.MuiButton-outlinedSizeLarge {
  padding: 7px 21px;
  font-size: 0.9375rem;
}
.MuiButton-containedSizeSmall {
  padding: 4px 10px;
  font-size: 0.8125rem;
}
.MuiButton-containedSizeLarge {
  padding: 8px 22px;
  font-size: 0.9375rem;
}
.MuiButton-fullWidth {
  width: 100%;
}
.MuiButton-startIcon {
  display: inherit;
  margin-left: -4px;
  margin-right: 8px;
}
.MuiButton-startIcon.MuiButton-iconSizeSmall {
  margin-left: -2px;
}
.MuiButton-endIcon {
  display: inherit;
  margin-left: 8px;
  margin-right: -4px;
}
.MuiButton-endIcon.MuiButton-iconSizeSmall {
  margin-right: -2px;
}
.MuiButton-iconSizeSmall > *:first-child {
  font-size: 18px;
}
.MuiButton-iconSizeMedium > *:first-child {
  font-size: 20px;
}
.MuiButton-iconSizeLarge > *:first-child {
  font-size: 22px;
}
</style><style data-jss="" data-meta="makeStyles">

</style><style data-jss="" data-meta="MuiCollapse">
.MuiCollapse-container {
  height: 0;
  overflow: hidden;
  transition: height 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
}
.MuiCollapse-entered {
  height: auto;
  overflow: visible;
}
.MuiCollapse-hidden {
  visibility: hidden;
}
.MuiCollapse-wrapper {
  display: flex;
}
.MuiCollapse-wrapperInner {
  width: 100%;
}
</style><style data-jss="" data-meta="MuiSvgIcon">
.MuiSvgIcon-root {
  fill: currentColor;
  width: 1em;
  height: 1em;
  display: inline-block;
  font-size: 1.5rem;
  transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
  flex-shrink: 0;
  user-select: none;
}
.MuiSvgIcon-colorPrimary {
  color: #3f51b5;
}
.MuiSvgIcon-colorSecondary {
  color: #f50057;
}
.MuiSvgIcon-colorAction {
  color: rgba(0, 0, 0, 0.54);
}
.MuiSvgIcon-colorError {
  color: #f44336;
}
.MuiSvgIcon-colorDisabled {
  color: rgba(0, 0, 0, 0.26);
}
.MuiSvgIcon-fontSizeInherit {
  font-size: inherit;
}
.MuiSvgIcon-fontSizeSmall {
  font-size: 1.25rem;
}
.MuiSvgIcon-fontSizeLarge {
  font-size: 2.1875rem;
}
</style><style data-jss="" data-meta="return-button-modified">
.jss936 {
  color: #394852;
  padding: 2px 12px;
  font-size: 16px;
  min-width: unset;
  margin-left: -8px;
  font-variant: small-caps;
  padding-left: 0;
  text-transform: capitalize;
}
.jss936 svg {
  color: #394852;
  font-size: 30px!important;
}
</style><style data-jss="" data-meta="custom-code-style">
.jss20 {
  border-left: 3px solid rgba(123,185,209,0.3);
  padding-left: calc(2em - 3px);
}
.jss21 {
  margin-top: 20px;
  padding-left: calc(2em - 3px);
  margin-bottom: 20px;
}
.jss21 > p:nth-child(1) {
  text-indent: calc(3px - 2em) !important;
}
.jss22 .react-syntax-highlighter-line-number {
  min-width: 2.5em !important;
}
.jss22 pre {
  border: 1px solid #E0E0E0;
  background: #F5F5F5!important;
  padding-top: 0.95em !important;
  border-radius: 2px;
}
.jss22 .no-bg {
  background: transparent !important;
}
.jss22 .no-bg code {
  background: transparent !important;
}
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="fade-in">
@-webkit-keyframes jss934 {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}
.jss935.fade-in {
  animation: jss934 .3s ease-in-out;
}
</style><style data-jss="" data-meta="makeStyles">

</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="custom-articles">
.jss28 .mtext, .jss28 .mjx-char {
  font-size: 1.15rem;
}
.jss28 a {
  color: #2a718d !important;
}
.jss28 h5 ~ h6 {
  margin-top: 40px;
}
.jss28 h4 ~ h5 {
  margin-top: 40px;
}
.jss28 ol li::marker {
  font-weight: 700;
}
.jss28 ol li {
  padding-left: 6px;
}
.jss28 .article-content ol ul li {
  margin-bottom: 20px;
}
.jss29 code {
  border: 1px solid rgba(0,0,0,0.03);
  font-size: 0.9em !important;
  background: #F5F5F5!important;
  line-height: 1.4em !important;
  border-radius: 4px;
}
.jss29 pre {
  margin: 1em 0;
}
.jss29 pre code {
  border: none;
  font-size: 0.9em !important;
  line-height: 1.4em !important;
}
.jss30 {
  display: block;
  border-right: 6px solid transparent;
  padding-right: 10px;
}
.jss31 {
  transition: border-color 0.2s ease-in-out;
  border-right: 6px solid #6fa8cd;
}
.jss32 {
  color: inherit;
  border-right: 6px solid transparent;
  background-color: inherit;
}
.jss33 {
  top: 70px;
  left: 50px;
  width: 360px;
  border: 1px solid rgba(0,0,0,0.1);
  opacity: 0;
  padding: 20px;
  position: sticky;
  transform: translate(-500px,-30px);
  max-height: 650px;
  overflow-y: scroll;
  transition: top 0.1s linear;
  padding-top: 0;
  border-radius: 6px;
  pointers-event: none;
  background-color: white;
}
.jss33 .TOC-heading {
  font-size: 16px;
}
.jss33 .content-row {
  top: 0;
  position: sticky;
  background: rgba(255,255,255,0.7);
  padding-top: 20px;
  backdrop-filter: blur(8px);
}
.jss33 h5 {
  margin-top: 0;
}
.jss33.open {
  opacity: 1;
  transition: opacity 0.1s linear;
  pointers-event: auto;
}
@media (max-width:1700px) {
  .jss33 {
    opacity: 0 !important;
    pointers-event: none !important;
  }
}
</style><style data-jss="" data-meta="MuiBackdrop">
.MuiBackdrop-root {
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  z-index: -1;
  position: fixed;
  align-items: center;
  justify-content: center;
  background-color: rgba(0, 0, 0, 0.5);
  -webkit-tap-highlight-color: transparent;
}
.MuiBackdrop-invisible {
  background-color: transparent;
}
</style><style data-jss="" data-meta="MuiPaper">
.MuiPaper-root {
  color: rgba(0, 0, 0, 0.87);
  transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
  background-color: #fff;
}
.MuiPaper-rounded {
  border-radius: 4px;
}
.MuiPaper-outlined {
  border: 1px solid rgba(0, 0, 0, 0.12);
}
.MuiPaper-elevation0 {
  box-shadow: none;
}
.MuiPaper-elevation1 {
  box-shadow: 0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation2 {
  box-shadow: 0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation3 {
  box-shadow: 0px 3px 3px -2px rgba(0,0,0,0.2),0px 3px 4px 0px rgba(0,0,0,0.14),0px 1px 8px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation4 {
  box-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation5 {
  box-shadow: 0px 3px 5px -1px rgba(0,0,0,0.2),0px 5px 8px 0px rgba(0,0,0,0.14),0px 1px 14px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation6 {
  box-shadow: 0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation7 {
  box-shadow: 0px 4px 5px -2px rgba(0,0,0,0.2),0px 7px 10px 1px rgba(0,0,0,0.14),0px 2px 16px 1px rgba(0,0,0,0.12);
}
.MuiPaper-elevation8 {
  box-shadow: 0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12);
}
.MuiPaper-elevation9 {
  box-shadow: 0px 5px 6px -3px rgba(0,0,0,0.2),0px 9px 12px 1px rgba(0,0,0,0.14),0px 3px 16px 2px rgba(0,0,0,0.12);
}
.MuiPaper-elevation10 {
  box-shadow: 0px 6px 6px -3px rgba(0,0,0,0.2),0px 10px 14px 1px rgba(0,0,0,0.14),0px 4px 18px 3px rgba(0,0,0,0.12);
}
.MuiPaper-elevation11 {
  box-shadow: 0px 6px 7px -4px rgba(0,0,0,0.2),0px 11px 15px 1px rgba(0,0,0,0.14),0px 4px 20px 3px rgba(0,0,0,0.12);
}
.MuiPaper-elevation12 {
  box-shadow: 0px 7px 8px -4px rgba(0,0,0,0.2),0px 12px 17px 2px rgba(0,0,0,0.14),0px 5px 22px 4px rgba(0,0,0,0.12);
}
.MuiPaper-elevation13 {
  box-shadow: 0px 7px 8px -4px rgba(0,0,0,0.2),0px 13px 19px 2px rgba(0,0,0,0.14),0px 5px 24px 4px rgba(0,0,0,0.12);
}
.MuiPaper-elevation14 {
  box-shadow: 0px 7px 9px -4px rgba(0,0,0,0.2),0px 14px 21px 2px rgba(0,0,0,0.14),0px 5px 26px 4px rgba(0,0,0,0.12);
}
.MuiPaper-elevation15 {
  box-shadow: 0px 8px 9px -5px rgba(0,0,0,0.2),0px 15px 22px 2px rgba(0,0,0,0.14),0px 6px 28px 5px rgba(0,0,0,0.12);
}
.MuiPaper-elevation16 {
  box-shadow: 0px 8px 10px -5px rgba(0,0,0,0.2),0px 16px 24px 2px rgba(0,0,0,0.14),0px 6px 30px 5px rgba(0,0,0,0.12);
}
.MuiPaper-elevation17 {
  box-shadow: 0px 8px 11px -5px rgba(0,0,0,0.2),0px 17px 26px 2px rgba(0,0,0,0.14),0px 6px 32px 5px rgba(0,0,0,0.12);
}
.MuiPaper-elevation18 {
  box-shadow: 0px 9px 11px -5px rgba(0,0,0,0.2),0px 18px 28px 2px rgba(0,0,0,0.14),0px 7px 34px 6px rgba(0,0,0,0.12);
}
.MuiPaper-elevation19 {
  box-shadow: 0px 9px 12px -6px rgba(0,0,0,0.2),0px 19px 29px 2px rgba(0,0,0,0.14),0px 7px 36px 6px rgba(0,0,0,0.12);
}
.MuiPaper-elevation20 {
  box-shadow: 0px 10px 13px -6px rgba(0,0,0,0.2),0px 20px 31px 3px rgba(0,0,0,0.14),0px 8px 38px 7px rgba(0,0,0,0.12);
}
.MuiPaper-elevation21 {
  box-shadow: 0px 10px 13px -6px rgba(0,0,0,0.2),0px 21px 33px 3px rgba(0,0,0,0.14),0px 8px 40px 7px rgba(0,0,0,0.12);
}
.MuiPaper-elevation22 {
  box-shadow: 0px 10px 14px -6px rgba(0,0,0,0.2),0px 22px 35px 3px rgba(0,0,0,0.14),0px 8px 42px 7px rgba(0,0,0,0.12);
}
.MuiPaper-elevation23 {
  box-shadow: 0px 11px 14px -7px rgba(0,0,0,0.2),0px 23px 36px 3px rgba(0,0,0,0.14),0px 9px 44px 8px rgba(0,0,0,0.12);
}
.MuiPaper-elevation24 {
  box-shadow: 0px 11px 15px -7px rgba(0,0,0,0.2),0px 24px 38px 3px rgba(0,0,0,0.14),0px 9px 46px 8px rgba(0,0,0,0.12);
}
</style><style data-jss="" data-meta="MuiDrawer">
.MuiDrawer-docked {
  flex: 0 0 auto;
}
.MuiDrawer-paper {
  top: 0;
  flex: 1 0 auto;
  height: 100%;
  display: flex;
  outline: 0;
  z-index: 1200;
  position: fixed;
  overflow-y: auto;
  flex-direction: column;
  -webkit-overflow-scrolling: touch;
}
.MuiDrawer-paperAnchorLeft {
  left: 0;
  right: auto;
}
.MuiDrawer-paperAnchorRight {
  left: auto;
  right: 0;
}
.MuiDrawer-paperAnchorTop {
  top: 0;
  left: 0;
  right: 0;
  bottom: auto;
  height: auto;
  max-height: 100%;
}
.MuiDrawer-paperAnchorBottom {
  top: auto;
  left: 0;
  right: 0;
  bottom: 0;
  height: auto;
  max-height: 100%;
}
.MuiDrawer-paperAnchorDockedLeft {
  border-right: 1px solid rgba(0, 0, 0, 0.12);
}
.MuiDrawer-paperAnchorDockedTop {
  border-bottom: 1px solid rgba(0, 0, 0, 0.12);
}
.MuiDrawer-paperAnchorDockedRight {
  border-left: 1px solid rgba(0, 0, 0, 0.12);
}
.MuiDrawer-paperAnchorDockedBottom {
  border-top: 1px solid rgba(0, 0, 0, 0.12);
}
</style><style data-jss="" data-meta="makeStyles">
.jss4 {
  transition: margin 195ms cubic-bezier(0.4, 0, 0.6, 1) 0ms,width 195ms cubic-bezier(0.4, 0, 0.6, 1) 0ms;
}
.jss5 {
  transition: margin 225ms cubic-bezier(0.0, 0, 0.2, 1) 0ms,width 225ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;
}
.jss6 {
  flex-grow: 1;
}
.jss7 {
  display: none;
}
.jss8 {
  flex-shrink: 0;
}
.jss10 {
  display: flex;
  padding: 0px 8px;
  min-height: 56px;
  align-items: center;
  justify-content: flex-start;
}
@media (min-width:0px) and (orientation: landscape) {
  .jss10 {
    min-height: 48px;
  }
}
@media (min-width:600px) {
  .jss10 {
    min-height: 64px;
  }
}
.jss11 {
  padding: 24px;
  flex-grow: 1;
  transition: margin 195ms cubic-bezier(0.4, 0, 0.6, 1) 0ms;
}
.jss12 {
  transition: margin 225ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;
  margin-right: 0;
}
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
.jss19 {
  border: 1px solid rgba(0,0,0,0);
  outline: none;
  padding: 10px;
  border-left: none;
  border-radius: 80px;
  background-color: #F3F3F3;
}
</style><style data-jss="" data-meta="makeStyles">
.jss18 .tags {
  display: flex;
  justify-content: flex-end;
}
.jss18 p {
  margin-bottom: 0;
}
.jss18 .info {
  padding: 10px;
}
.jss18 .info:hover {
  background-color: rgba(220,220,220);
}
.jss18 .tags div {
  display: flex;
  margin-bottom: 6px;
  justify-content: flex-end;
}
.jss18 .tags div:not(.tags-container) {
  height: 21px;
}
</style><style data-jss="" data-meta="my-blog">
.jss2 {
  display: flex;
}
.jss2 button {
  width: 140px;
  border: 1px solid #31343a;
  opacity: 0.5;
  padding: 3px 14px;
  font-size: 14px;
  transition: opacity 0.1s ease-in-out;
  font-weight: 500;
  font-variant: small-caps;
  letter-spacing: unset;
  text-transform: none;
}
.jss2 button.active {
  color: white;
  opacity: 1;
  background: #3b62918c;
  border-color: transparent;
}
.jss2 button:hover {
  opacity: 0.87;
}
</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script type="text/javascript" charset="utf8" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="App"><div class="main" id="background-animated" style="background-repeat: no-repeat; background-size: cover; position: relative; z-index: 1;"><div class="jss1" style="height: 100vh; overflow-y: hidden;"><div class="site-top-menu" style="height: 40px;"><div class="container"><div class="button-row"><a href="/"><button class="MuiButtonBase-root MuiButton-root MuiButton-text menu-button" tabindex="0" type="button"><span class="MuiButton-label"><div class="title-container">About Me</div></span><span class="MuiTouchRipple-root"></span></button></a><a href="/portfolio"><button class="MuiButtonBase-root MuiButton-root MuiButton-text menu-button" tabindex="0" type="button"><span class="MuiButton-label"><div class="title-container">Portfolio</div></span><span class="MuiTouchRipple-root"></span></button></a><a href="/blog"><button class="MuiButtonBase-root MuiButton-root MuiButton-text menu-button active" tabindex="0" type="button"><span class="MuiButton-label"><div class="title-container">Blog</div></span><span class="MuiTouchRipple-root"></span></button></a><a href="/artworks"><button class="MuiButtonBase-root MuiButton-root MuiButton-text menu-button" tabindex="0" type="button"><span class="MuiButton-label"><div class="title-container">Artworks</div></span><span class="MuiTouchRipple-root"></span></button></a><a href="/math-material"><button class="MuiButtonBase-root MuiButton-root MuiButton-text menu-button" tabindex="0" type="button"><span class="MuiButton-label"><div class="title-container">Math Material</div></span><span class="MuiTouchRipple-root"></span></button></a></div></div></div><div class="os-host os-host-foreign os-theme-dark os-host-resize-disabled main-content os-host-overflow os-host-overflow-y os-host-overflow-x os-host-transition" id="top-overlayscroll-container" style="height: calc(100vh - 40px); width: 100%; overflow: hidden;"><div class="os-resize-observer-host observed"><div class="os-resize-observer" style="left: 0px; right: auto;"></div></div><div class="os-size-auto-observer observed" style="height: calc(100% + 1px); float: left;"><div class="os-resize-observer"></div></div><div class="os-content-glue" style="margin: 0px -40px; width: 799px; height: 559px;"></div><div class="os-padding"><div class="os-viewport os-viewport-native-scrollbars-invisible os-viewport-native-scrollbars-overlaid" style="overflow: scroll;"><div class="os-content" style="padding: 0px 40px; height: 100%; width: 100%;"><div class="total-container container"><div class="right" style="padding-left: 0px;"><div style="height: 40px; width: 5px; min-height: 40px; user-select: none; display: block;"></div><div class="blog"><div class="scroll-top-meter" style="position: fixed; right: 60px; bottom: 60px; z-index: 2; background-color: rgba(0, 0, 0, 0.5); color: white; padding: 5px 6px; border-radius: 3px; font-size: 0.8rem; user-select: none; width: 55px; height: 30px;"><div style="display: flex; justify-content: center; transform: scale(1.5, 0.75); margin-top: -9px; margin-bottom: -10px; opacity: 0.2;"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></svg></div><div style="display: flex; justify-content: center;">0%</div><button class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" type="button" style="position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; min-width: 0px;"><span class="MuiButton-label"></span><span class="MuiTouchRipple-root"></span></button></div><div class="message-block-container" style="opacity: 1; transition: opacity 225ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;"><div class="MuiCollapse-container MuiCollapse-entered" style="min-height: 0px;"><div class="MuiCollapse-wrapper"><div class="MuiCollapse-wrapperInner"><div style="background: inherit;"><div style="display: flex;"><div class="box" style="border-top-left-radius: 10px; border-top-right-radius: 10px;"><div class="message-block"><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="position: relative;"><div style="display: flex;"><div style="max-height: 35px; padding: 22px; display: flex; justify-content: center; align-items: center; background-color: rgb(243, 243, 243); border-top-left-radius: 80px; border-top: 1px solid rgba(0, 0, 0, 0); border-right: none; border-bottom: 1px solid rgba(0, 0, 0, 0); border-left: 1px solid rgba(0, 0, 0, 0); border-image: initial; border-bottom-left-radius: 80px;"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path></svg> </div><input placeholder="Tag, title or content" class="jss19" style="flex: 1 1 0%; border-top-left-radius: 0px; border-bottom-left-radius: 0px;"></div></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div class="articles tech-blog" style="position: relative;"><div class="articles-container"><div class="container"><div style="display: flex; justify-content: center; width: 100%; margin: 0px;"><div class="content jss29"><div style="position: absolute; height: 100%;"><div class="os-host os-host-foreign os-theme-dark os-host-resize-disabled os-host-scrollbar-horizontal-hidden os-host-scrollbar-vertical-hidden jss33" id="floating-toc"><div class="os-resize-observer-host observed"><div class="os-resize-observer" style="left: 0px; right: auto;"></div></div><div class="os-size-auto-observer observed" style="height: calc(100% + 1px); float: left;"><div class="os-resize-observer"></div></div><div class="os-content-glue" style="margin: 0px -20px -20px; height: 526px; width: 357px;"></div><div class="os-padding"><div class="os-viewport os-viewport-native-scrollbars-invisible os-viewport-native-scrollbars-overlaid"><div class="os-content" style="padding: 0px 20px 20px; height: auto; width: 100%;"><div class="content-row"><h5> Contents </h5><div style="height: 10px; width: 5px; min-height: 10px; user-select: none; display: block;"></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1); margin-top: -12px;"></div><p></p></div><div class="TOC-heading"><ul><li><a href="#About-this-Article">About this Article</a></li><li><a href="#dataset::{-parse_annotation,-bbox_iou-}">dataset::{ parse_annotation, bbox_iou }</a></li><li><a href="#Model-Structure-of-YOLOv3">Model Structure of YOLOv3</a></li><li><a href="#yolov3::{-YOLOv3,-decode-}">yolov3::{ YOLOv3, decode }</a></li><li><a href="#yolov3::{-compute_loss-}">yolov3::{ compute_loss }</a></li><li><a href="#Training">Training</a><ul><li><a href="#Recap-of-Customized-Training-Loop-with-tf.GradientTape">Recap of Customized Training Loop with tf.GradientTape</a></li><li><a href="#Start-Training">Start Training</a></li></ul></li><li><a href="#Reference">Reference</a></li></ul></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div></div></div></div><div class="os-scrollbar os-scrollbar-horizontal os-scrollbar-unusable os-scrollbar-auto-hidden"><div class="os-scrollbar-track os-scrollbar-track-off"><div class="os-scrollbar-handle" style="width: 100%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar os-scrollbar-vertical os-scrollbar-unusable os-scrollbar-auto-hidden"><div class="os-scrollbar-track os-scrollbar-track-off"><div class="os-scrollbar-handle" style="height: 100%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar-corner"></div></div></div><div class="article jss28"><div style="opacity: 1;"><div class="jss935 fade-in"><div> <button class="MuiButtonBase-root MuiButton-root MuiButton-text jss936" tabindex="0" type="button"><span class="MuiButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg> Return</span><span class="MuiTouchRipple-root"></span></button> </div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div><div class="first-row"><div class="date">April 22, 2022</div><div class="archive-button-row"><button class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" type="button"><span class="MuiButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true" style="transform: scale(0.9);"><path d="M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"></path></svg><div style="width: 7px; min-width: 7px; user-select: none;"></div>Print</span><span class="MuiTouchRipple-root"></span></button></div></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="border-top: 3px solid rgba(0, 0, 0, 0.1);"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><h3 style="margin-bottom: 10px;">YOLOv3 Deep Dive</h3><div class="jss35 jss937 tags-container" style="margin-bottom: 0px;"><div><p><code>deep-learning</code></p></div></div><div class="os-host os-host-foreign os-theme-dark os-host-resize-disabled os-host-scrollbar-horizontal-hidden os-host-scrollbar-vertical-hidden" id=""><div class="os-resize-observer-host observed"><div class="os-resize-observer" style="left: 0px; right: auto;"></div></div><div class="os-size-auto-observer observed" style="height: calc(100% + 1px); float: left;"><div class="os-resize-observer"></div></div><div class="os-content-glue" style="margin: 0px; height: 474px; width: 739px;"></div><div class="os-padding"><div class="os-viewport os-viewport-native-scrollbars-invisible os-viewport-native-scrollbars-overlaid"><div class="os-content" style="padding: 0px; height: auto; width: 100%;"><div class="content-row"><h5> Contents </h5><div style="height: 10px; width: 5px; min-height: 10px; user-select: none; display: block;"></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1); margin-top: -12px;"></div><p></p></div><div class="TOC-heading"><ul><li><a href="#About-this-Article">About this Article</a></li><li><a href="#dataset::{-parse_annotation,-bbox_iou-}">dataset::{ parse_annotation, bbox_iou }</a></li><li><a href="#Model-Structure-of-YOLOv3">Model Structure of YOLOv3</a></li><li><a href="#yolov3::{-YOLOv3,-decode-}">yolov3::{ YOLOv3, decode }</a></li><li><a href="#yolov3::{-compute_loss-}">yolov3::{ compute_loss }</a></li><li><a href="#Training">Training</a><ul><li><a href="#Recap-of-Customized-Training-Loop-with-tf.GradientTape">Recap of Customized Training Loop with tf.GradientTape</a></li><li><a href="#Start-Training">Start Training</a></li></ul></li><li><a href="#Reference">Reference</a></li></ul></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div></div></div></div><div class="os-scrollbar os-scrollbar-horizontal os-scrollbar-unusable os-scrollbar-auto-hidden"><div class="os-scrollbar-track os-scrollbar-track-off"><div class="os-scrollbar-handle" style="width: 100%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar os-scrollbar-vertical os-scrollbar-unusable os-scrollbar-auto-hidden"><div class="os-scrollbar-track os-scrollbar-track-off"><div class="os-scrollbar-handle" style="height: 100%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar-corner"></div></div><div class="cross-sensor"></div><div class="article-content"><a class="md-title" id="About-this-Article"></a><h4><div class="h4-left-block" style="height: 100%; display: inline;"></div>About this Article</h4>
<p>The main objective of this article is to understand every function of YOLO-v3 implemented in tensorfow. We will understand the algorithm by examining the shape of every output.</p>
<p>The sections below are named by <code>module_name::{ function_1, function_2, ... }</code>, where <code>module_name</code> means we are studying the file <code>module_name.py</code>.</p>
<p>The link of <strong><em>source code</em></strong> are provided at the beginning of each of such sections.</p>
<a class="md-title" id="dataset::{-parse_annotation,-bbox_iou-}"></a><h4><div class="h4-left-block" style="height: 100%; display: inline;"></div>dataset::{ parse_annotation, bbox_iou }</h4>
<p><a href="https://github.com/machingclee/deep-learning-study/blob/main/2021-02-15-yolo-trials/2021-02-15-YOLOV3-head-detection/core/dataset.py" target="_blank"><i>Source Code</i></a></p>
<pre><div class="jss22 jss942"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">parse_annotation</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> annotation</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span><span>    line </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> annotation</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>split</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span><span>    image_path </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> line</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">not</span><span> os</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>path</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>exists</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_path</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">raise</span><span> KeyError</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"%s does not exist ... "</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">%</span><span> imagparse_annotation
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>        e_path</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span><span>    image </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> cv2</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>imread</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_path</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>    bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>array</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(181, 118, 20);">list</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(181, 118, 20);">map</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(181, 118, 20);">int</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> box</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>split</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">','</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> box </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> line</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>data_aug</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span><span>        image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>random_horizontal_flip</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>        image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>random_crop</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span><span>        image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>random_translate</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span><span>    image </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> cv2</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>cvtColor</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> cv2</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>COLOR_BGR2RGB</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>    image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> utils</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>image_preporcess</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>train_input_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>train_input_size</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>    line </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> annotation</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>split</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>    image_path </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> line</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">not</span><span> os</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>path</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>exists</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_path</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">raise</span><span> KeyError</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"%s does not exist ... "</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">%</span><span> image_path</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span><span>    image </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> cv2</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>imread</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_path</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>    bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>array</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(181, 118, 20);">list</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(181, 118, 20);">map</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(181, 118, 20);">int</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> box</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>split</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">','</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> box </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> line</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>data_aug</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>        image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>random_horizontal_flip</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span><span>        image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>random_crop</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span><span>        image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>random_translate</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">30</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">31</span><span>    image </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> cv2</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>cvtColor</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> cv2</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>COLOR_BGR2RGB</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">32</span><span>    image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> utils</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>image_preporcess</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>train_input_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>train_input_size</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">33</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes</span></span></code></pre></div></pre>
<p>This part is straightforward. </p>
<pre><div class="jss22 jss943"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">bbox_iou</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span><span>    boxes1 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>array</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span><span>    boxes2 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>array</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>    boxes1_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>    boxes2_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>    boxes1 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concatenate</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>                             boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span><span>    boxes2 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concatenate</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span><span>                             boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>From the function we can deduce that , therefore</p>
<div class="display-math"></div>
<p>and</p>
<div class="display-math"></div>
<p>while concatenating  np-array along the last axis simpliy means combing them into one  np-array. Numerically in training  and  are like:</p>
<pre><div class="jss22 jss944"><pre class="no-bg" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-none" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 1.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span>[[0.59375 3.78125 0.5     0.625  ]]</span></span></code></pre></div></pre>
<p>and</p>
<pre><div class="jss22 jss945"><pre class="no-bg" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-none" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 1.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span>[[ 0.5      3.5      3.625    2.8125 ]
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 1.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span> [ 0.5      3.5      4.875    6.1875 ]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 1.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span> [ 0.5      3.5     11.65625 10.1875 ]]</span></code></pre></div></pre>
<p>respectively,</p>
<pre><div class="jss22 jss946"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>    left_up </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span><span>    right_down </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>minimum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>Think of the above as entrywise comparisons that give an array of maximum, which yields the coordinates of intersection rectangle for each fixed  to boxes in .</p>
<pre><div class="jss22 jss947"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span><span>    inter_section </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>right_down </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> left_up</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.0</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>The entries in  are the  and  of the intersection, the (broadcasted)  is just a tricky way to handle empty intersection.</p>
<pre><div class="jss22 jss948"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span><span>    inter_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> inter_section</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> inter_section</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>    union_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> boxes1_area </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> boxes2_area </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> inter_area
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> inter_area </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> union_area</span></span></code></pre></div></pre>
<p></p>
<pre><div class="jss22 jss949"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">preprocess_true_boxes</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span></span></code></pre></div></pre>
<p>Here  are the boxes from annotation file in which each line takes the form:</p>
<div class="display-math"></div>
<pre><div class="jss22 jss950"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span><span>    label </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>zeros</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>train_output_sizes</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span><span>                       self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>train_output_sizes</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span><span>                       self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>anchor_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span><span>                       </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>num_classes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> i </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>    bboxes_xywh </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>zeros</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>max_bbox_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> _ </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>    bbox_count </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>zeros</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> bbox </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>        bbox_coor </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span><span>        bbox_class_ind </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>        onehot </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>zeros</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>num_classes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> dtype</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(181, 118, 20);">float</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span><span>        onehot</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>bbox_class_ind</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span><span>        uniform_distribution </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>full</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>num_classes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>num_classes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span><span>        deta </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.01</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>        smooth_onehot </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> onehot </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> deta</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> deta </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> uniform_distribution
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span><span>        </span><span class="token token" style="color: rgb(124, 111, 100);"># bbox_xywh is ground truth</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>        bbox_xywh </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concatenate</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_coor</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> bbox_coor</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bbox_coor</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> bbox_coor</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>        </span><span class="token token" style="color: rgb(124, 111, 100);"># bbox_xywh_scaled is scaled ground truth relative to stride (13, 26, 52, as a unit)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span><span>        bbox_xywh_scaled </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> bbox_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>strides</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">]</span></span></code></pre></div></pre>
<p>Note that</p>
<div class="display-math"></div>
<p>is of shape  and</p>
<div class="display-math"></div>
<p>is of shape , their multiplication will be conducted by "broadcasting'' in numpy, which yields a  dimensional numpy array. The product  consists of  which use "stride" as a unit, so 1 means "1 grid" (recall there are , ,  grids predictions from Darknet backbone).</p>
<pre><div class="jss22 jss951"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span><span>        iou </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span><span>        exist_positive </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> i </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span><span>            anchors_xywh </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>zeros</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>anchor_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>            anchors_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>floor</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_xywh_scaled</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>astype</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>int32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>            anchors_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>anchors</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span></span></code></pre></div></pre>
<p> essentially moves centers of  to the middle of the grid where the original center lies in, then the anchor boxes' width and height are assigned, replacing the original width, height of .</p>
<pre><div class="jss22 jss952"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span><span>            iou_scale </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>bbox_iou</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_xywh_scaled</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> anchors_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>The presence of  is simply because multiplication between  and  array does not make sense. The additional dimension expand  array into  array, which is broadcasted and multiplied to  array to give another  array, and therefore, .</p>
<pre><div class="jss22 jss953"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span><span>            iou</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>append</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>iou_scale</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">30</span><span>            iou_mask </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> iou_scale </span><span class="token token" style="color: rgb(124, 111, 100);">&gt;</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.3</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);"># a boolean list of length 3</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">31</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">32</span><span>            </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(181, 118, 20);">any</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>iou_mask</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);"># if one of them is True</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">33</span><span>                xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> yind </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>floor</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_xywh_scaled</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>astype</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>int32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">34</span><span>                label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> iou_mask</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">35</span><span>                label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> iou_mask</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox_xywh
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">36</span><span>                label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> iou_mask</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">37</span><span>                label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> iou_mask</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> smooth_onehot</span></span></code></pre></div></pre>
<p> is initialized at the beginning which is of size</p>
<div class="display-math"></div>
<p>for each , where  or .</p>
<pre><div class="jss22 jss954"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">38</span><span>                bbox_ind </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">int</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_count</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">%</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>max_bbox_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">39</span><span>                bboxes_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>bbox_ind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox_xywh</span></span></code></pre></div></pre>
<p> is initialized (with zeros) at the beginning, .</p>
<pre><div class="jss22 jss955"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">40</span><span>                bbox_count</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">41</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">42</span><span>                exist_positive </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">True</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">43</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">44</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">not</span><span> exist_positive</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">45</span><span>            best_anchor_ind </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>argmax</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>array</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>iou</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reshape</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);"># flatten and take max</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">46</span><span>            </span><span class="token token" style="color: rgb(124, 111, 100);"># best_detect belongs to which "i", namely, best "i"</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">47</span><span>            best_detect </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">int</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>best_anchor_ind </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>anchor_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">48</span><span>            </span><span class="token token" style="color: rgb(124, 111, 100);"># for this i, which index it is:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">49</span><span>            best_anchor </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">int</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>best_anchor_ind </span><span class="token token" style="color: rgb(124, 111, 100);">%</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>anchor_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">50</span><span>            </span><span class="token token" style="color: rgb(124, 111, 100);"># get the grid point in our 13x13, 26x26, 52x52 grid:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">51</span><span>            xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> yind </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>floor</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_xywh_scaled</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>astype</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>int32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">52</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">53</span><span>            label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> best_anchor</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">54</span><span>            label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> best_anchor</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox_xywh
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">55</span><span>            label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> best_anchor</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">56</span><span>            label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> best_anchor</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> smooth_onehot
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">57</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">58</span><span>            bbox_ind </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">int</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_count</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">%</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>max_bbox_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">59</span><span>            bboxes_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>bbox_ind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox_xywh
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">60</span><span>            </span><span class="token token" style="color: rgb(124, 111, 100);"># assign bbox_xywh into the list instead of append,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">61</span><span>            </span><span class="token token" style="color: rgb(124, 111, 100);"># this is to make sure there are at most 150 boxes within all 3 scales.</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">62</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">63</span><span>            bbox_count</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">64</span><span>    label_sbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> label_mbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> label_lbbox </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> label
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">65</span><span>    sbboxes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> mbboxes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> lbboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bboxes_xywh
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">66</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> label_sbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> label_mbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> label_lbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> sbboxes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> mbboxes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> lbboxes</span></span></code></pre></div></pre>
<p>In short,</p>
<div class="display-math"></div>
<p>are just ground truth bounding boxes (center, width and height), while</p>
<div class="display-math"></div>
<p>are ground truth bounding boxes with objectiveness and probabilities of <strong><em>each grid</em></strong>.
</p>
<a class="md-title" id="Model-Structure-of-YOLOv3"></a><h4><div class="h4-left-block" style="height: 100%; display: inline;"></div>Model Structure of YOLOv3</h4>
<p>In  after a bunch of residue modules we get 3 branches ,  and , where <code>route_1, route_2, conv = backbone.darknet53(input_layer)</code> in <code>YOLOv3</code> function. Moreover,</p>
<div class="display-math"></div>
<div class="display-math"></div>
<div class="display-math"></div>
<center>
<a href="/assets/tech/042-yolo_structure.png" target="_blank">
<img src="/assets/tech/042-yolo_structure.png" width="100%">
</a>
<p></p>
</center>
<p>Each branch then jumps into several stages of feature extractions, the whole process finally gives another 3 branches of undecoded/raw data of features, and they are endowed with the meaning of "grid-based detection" after reshaping into</p>
<div class="display-math"></div>
<p>dimensional array in <code>decode</code> function (see <code>conv_output</code> in the body).</p>
<a class="md-title" id="yolov3::{-YOLOv3,-decode-}"></a><h4><div class="h4-left-block" style="height: 100%; display: inline;"></div>yolov3::{ YOLOv3, decode }</h4>
<p><a href="https://github.com/machingclee/deep-learning-study/blob/main/2021-02-15-yolo-trials/2021-02-15-YOLOV3-head-detection/core/yolov3.py" target="_blank"><i>Source Code</i></a></p>
<pre><div class="jss22 jss960"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">YOLOv3</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>input_layer</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span><span>    route_1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> route_2</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> backbone</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>darknet53</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>input_layer</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>As <code>padding="same"</code> is being used along the chain of conv nets, there is no spatial dimension change.</p>
<pre><div class="jss22 jss962"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>    conv_lobj_branch </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>    conv_lbbox </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_lobj_branch</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>NUM_CLASS </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> activate</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bn</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>upsample</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> route_2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">768</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span><span>    conv_mobj_branch </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>    conv_mbbox </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_mobj_branch</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>NUM_CLASS </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> activate</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bn</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>upsample</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> route_1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">30</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">31</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">384</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">32</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">33</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">34</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">35</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">36</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">37</span><span>    conv_sobj_branch </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">38</span><span>    conv_sbbox </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_sobj_branch</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>NUM_CLASS </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> activate</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bn</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">39</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">40</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>conv_sbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conv_mbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conv_lbbox</span><span class="token token" style="color: rgb(124, 111, 100);">]</span></span></code></pre></div></pre>
<p></p>
<pre><div class="jss22 jss963"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">decode</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> i</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span><span>    </span><span class="token token triple-quoted-string" style="color: rgb(121, 116, 3);">"""
</span></span><span class="token token triple-quoted-string" style="color: rgb(121, 116, 3);"><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span>    return tensor of shape [batch_size, output_size, output_size, anchor_per_scale, 5 + num_classes]
</span><span class="token token triple-quoted-string" style="color: rgb(121, 116, 3);"><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span>            contains (x, y, w, h, score, probability)
</span><span class="token token triple-quoted-string" style="color: rgb(121, 116, 3);"><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span>    """</span></code></pre></div></pre>
<p> is the output of  (i.e., ,  or ).</p>
<pre><div class="jss22 jss964"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>    conv_shape       </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>shape</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>    batch_size       </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_shape</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span><span>    output_size      </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_shape</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>    conv_output </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reshape</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>batch_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> NUM_CLASS</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span><span>    conv_raw_dxdy </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>    conv_raw_dwdh </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span><span>    conv_raw_conf </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span><span>    conv_raw_prob </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>    y </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>tile</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> dtype</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>int32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> output_size</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span><span>    x </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>tile</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> dtype</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>int32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>For example, let's take , then</p>
<div class="display-math"></div>
<p>and</p>
<div class="display-math"></div>
<p>are respectively:</p>
<pre><div class="jss22 jss965"><pre class="no-bg" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-none" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span>[[ 0  0  0  0  0  0  0  0  0  0  0  0  0]   [[ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span> [ 1  1  1  1  1  1  1  1  1  1  1  1  1]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span> [ 2  2  2  2  2  2  2  2  2  2  2  2  2]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span> [ 3  3  3  3  3  3  3  3  3  3  3  3  3]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span> [ 4  4  4  4  4  4  4  4  4  4  4  4  4]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span> [ 5  5  5  5  5  5  5  5  5  5  5  5  5]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span> [ 6  6  6  6  6  6  6  6  6  6  6  6  6]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span> [ 7  7  7  7  7  7  7  7  7  7  7  7  7]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span> [ 8  8  8  8  8  8  8  8  8  8  8  8  8]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span> [ 9  9  9  9  9  9  9  9  9  9  9  9  9]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span> [10 10 10 10 10 10 10 10 10 10 10 10 10]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span> [11 11 11 11 11 11 11 11 11 11 11 11 11]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span> [12 12 12 12 12 12 12 12 12 12 12 12 12]]   [ 0  1  2  3  4  5  6  7  8  9 10 11 12]]</span></code></pre></div></pre>
<p>For  and  we expand dimension again along the last axis (break every single element into a bracketed element) before concatenation:</p>
<pre><div class="jss22 jss966"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>    xy_grid </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>x</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> y</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>At this point,  is  dimensional.</p>
<pre><div class="jss22 jss967"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>    xy_grid </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>tile</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>xy_grid</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>batch_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span><span>    xy_grid </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>cast</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>xy_grid</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>float32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>Now  is  dimensional. Recall that</p>
<center>
<img src="/assets/tech/042-decode_anchor.png" width="360">
</center>
<pre><div class="jss22 jss968"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span><span>    pred_xy </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>sigmoid</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_raw_dxdy</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> xy_grid</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> STRIDES</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span><span>    pred_wh </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>exp</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_raw_dwdh</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> ANCHORS</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> STRIDES</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>    pred_xywh </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>pred_xy</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> pred_wh</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>    pred_conf </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>sigmoid</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_raw_conf</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>    pred_prob </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>sigmoid</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_raw_prob</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>pred_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> pred_conf</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> pred_prob</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>Bear in mind that decoded ,  in  denote the center of prediction rectangle, as is the output of the function . </p>
<a class="md-title" id="yolov3::{-compute_loss-}"></a><h4><div class="h4-left-block" style="height: 100%; display: inline;"></div>yolov3::{ compute_loss }</h4>
<p><a href="https://github.com/machingclee/deep-learning-study/blob/main/2021-02-15-yolo-trials/2021-02-15-YOLOV3-head-detection/core/yolov3.py" target="_blank"><i>Source Code</i></a></p>
<pre><div class="jss22 jss969"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">bbox_giou</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span><span>    boxes1 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span><span>                        boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span><span>    boxes2 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>                        boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span><span>    boxes1 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>minimum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>                        tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>    boxes2 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>minimum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span><span>                        tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>    boxes1_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span><span>    boxes2_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span><span>    left_up </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>    right_down </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>minimum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>    inter_section </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>right_down </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> left_up</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.0</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>    inter_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> inter_section</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> inter_section</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span><span>    union_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> boxes1_area </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> boxes2_area </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> inter_area
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span><span>    iou </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> inter_area </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> union_area
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>    enclose_left_up </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>minimum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span><span>    enclose_right_down </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>    enclose </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>enclose_right_down </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> enclose_left_up</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.0</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>    enclose_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> enclose</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> enclose</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span><span>    giou </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> iou </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>enclose_area </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> union_area</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> enclose_area
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">30</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> giou</span></span></code></pre></div></pre>
<pre><div class="jss22 jss970"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">compute_loss</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>pred</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> label</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> i</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span><span>    conv_shape  </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>shape</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span><span>    batch_size  </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_shape</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span><span>    output_size </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_shape</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>    input_size  </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> STRIDES</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> output_size
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reshape</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>batch_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> NUM_CLASS</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>    conv_raw_conf </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>    conv_raw_prob </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span><span>    pred_xywh     </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> pred</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>    pred_conf     </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> pred</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span><span>    label_xywh    </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span><span>    respond_bbox  </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);"># objectiveness</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>    label_prob    </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>    giou </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>expand_dims</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_giou</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>pred_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> label_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>    input_size </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>cast</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>input_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>float32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span><span>    bbox_loss_scale </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2.0</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> label_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> label_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>input_size </span><span class="token token" style="color: rgb(124, 111, 100);">**</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span><span>    giou_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> respond_bbox </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> bbox_loss_scale </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> giou</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>Note that for two sets , where , the function  defines a metric, so  makes sense.</p>
<pre><div class="jss22 jss971"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>    iou </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox_iou</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>pred_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p> are batched inside <code>Dataset("train").__next__</code> before passing into  (in a while loop until image count reaches batch size). Therefore , where  is the maximal number of anchors (most of them are zeros due to initialization), so we see 3 <code>:</code>'s in .</p>
<p>Finally</p>
<div class="display-math"></div>
<p>and</p>
<div class="display-math"></div>
<p>where computation gets rid of the last dimension.  is copied to every grid for computation because from the original paper of YOLOv3:</p>
<blockquote>
<p>"the confidence prediction represents the IOU between the predicted box and any ground truth box"</p>
</blockquote>
<pre><div class="jss22 jss974"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span><span>    max_iou </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>expand_dims</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_max</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>iou</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>    respond_bgd </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> respond_bbox</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>cast</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span> max_iou </span><span class="token token" style="color: rgb(124, 111, 100);">&lt;</span><span> IOU_LOSS_THRESH</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>float32 </span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>In the internet some people call  as .  determines whether to penalize a prediction</p>
<ul>
<li>that overlaps too few with ground truth anchors (i.e., detected wrong location) <strong><em>and</em></strong></li>
<li>that makes false positive error.</li>
</ul>
<pre><div class="jss22 jss975"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>    conf_focal </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(181, 118, 20);">pow</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>respond_bbox </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> pred_conf</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>The concept of focal loss with  was introduced in <strong>[TY]</strong>, which down-weights the loss contributed by well-classificed (high confidence) examples.</p>
<pre><div class="jss22 jss976"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span><span>    conf_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conf_focal </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span><span>    </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">30</span><span>        respond_bbox </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>nn</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>sigmoid_cross_entropy_with_logits</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>labels</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>respond_bbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> logits</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>conv_raw_conf</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">31</span><span>        </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">32</span><span>        respond_bgd </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>nn</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>sigmoid_cross_entropy_with_logits</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>labels</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>respond_bbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> logits</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>conv_raw_conf</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">33</span><span>    </span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>Where  is</p>
<div class="display-math"></div>
<p>therefore  has to be a raw prediction data (i.e., without signmoid).</p>
<pre><div class="jss22 jss977"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">34</span><span>    prob_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> respond_bbox </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>nn</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>sigmoid_cross_entropy_with_logits</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>labels</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>label_prob</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> logits</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>conv_raw_prob</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">35</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">36</span><span>    giou_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_mean</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_sum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>giou_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">37</span><span>    conf_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_mean</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_sum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conf_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">38</span><span>    prob_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_mean</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_sum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>prob_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">39</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">40</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> giou_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conf_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> prob_loss</span></span></code></pre></div></pre>
<p></p>
<a class="md-title" id="Training"></a><h4><div class="h4-left-block" style="height: 100%; display: inline;"></div>Training</h4>
<p><a href="https://github.com/machingclee/deep-learning-study/blob/main/2021-02-15-yolo-trials/2021-02-15-YOLOV3-head-detection/train.py" target="_blank"><i>Source Code</i></a></p>
<a class="md-title" id="Recap-of-Customized-Training-Loop-with-tf.GradientTape"></a><h6><div class="h6-left-block" style="height: 100%; display: inline;"></div>Recap of Customized Training Loop with tf.GradientTape</h6>
<p>Apart from predefined loss functions (such as  for classfication,  for regression, etc), it is ocassional to come across non-standard loss functions from other repository with the use of .</p>
<p>Such implementation usually involves 4 components:</p>
<ul>
<li>
<p><strong>Component 1.</strong> The model <strong>architecture</strong></p>
</li>
<li>
<p><strong>Component 2.</strong> The <strong>loss function</strong> used when computing the model loss</p>
</li>
<li>
<p><strong>Component 3.</strong> The <strong>optimizer</strong> used to update the model weights</p>
</li>
<li>
<p><strong>Component 4.</strong> The <strong>step function</strong> that encapsulates the forward and backward pass of the network</p>
</li>
</ul>
<p>Now the code below is self-explanatory:</p>
<a class="md-title" id="Start-Training"></a><h6><div class="h6-left-block" style="height: 100%; display: inline;"></div>Start Training</h6>
<pre><div class="jss22 jss978"><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">train_step</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_data</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> target</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> epoch</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span><span>    </span><span class="token token" style="color: rgb(124, 111, 100);"># image_data = batch of images</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">with</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>GradientTape</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">as</span><span> tape</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>        pred_result </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> model</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_data</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> training</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">True</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>        giou_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conf_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> prob_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>        </span><span class="token token" style="color: rgb(124, 111, 100);"># optimizing process</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> i </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span><span>            conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> pred </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> pred_result</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> pred_result</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span><span>            batch_label</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> batch_bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> target</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>            loss_items </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> compute_loss</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>pred</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> batch_label</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> batch_bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> i</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span><span>            giou_loss </span><span class="token token" style="color: rgb(124, 111, 100);">+=</span><span> loss_items</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span><span>            conf_loss </span><span class="token token" style="color: rgb(124, 111, 100);">+=</span><span> loss_items</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span><span>            prob_loss </span><span class="token token" style="color: rgb(124, 111, 100);">+=</span><span> loss_items</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span><span>        total_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> giou_loss </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> conf_loss </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> prob_loss
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>        gradients </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tape</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>gradient</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>total_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> model</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>trainable_variables</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span><span>        optimizer</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>apply_gradients</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(181, 118, 20);">zip</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>gradients</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> model</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>trainable_variables</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span><span>        </span><span class="token token" style="color: rgb(124, 111, 100);"># update learning rate</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>        global_steps</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>assign_add</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> global_steps </span><span class="token token" style="color: rgb(124, 111, 100);">&lt;</span><span> warmup_steps</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>            lr </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> global_steps </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> warmup_steps </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> cfg</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>TRAIN</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>LR_INIT
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">else</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span><span>            lr </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> cfg</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>TRAIN</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>LR_END </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>cfg</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>TRAIN</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>LR_INIT </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> cfg</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>TRAIN</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>LR_END</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span><span>                </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>cos</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>global_steps </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> warmup_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>total_steps </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> warmup_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>pi</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">30</span><span>            </span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">31</span><span>        optimizer</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>lr</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>assign</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>lr</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>numpy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">32</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">33</span><span>        </span><span class="token token" style="color: rgb(124, 111, 100);"># writing summary data</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">34</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">with</span><span> writer</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>as_default</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">35</span><span>            tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>summary</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>scalar</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"lr"</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> optimizer</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>lr</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> step</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>global_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">36</span><span>            tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>summary</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>scalar</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"loss/total_loss"</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> total_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> step</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>global_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">37</span><span>            tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>summary</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>scalar</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"loss/giou_loss"</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> giou_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> step</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>global_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">38</span><span>            tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>summary</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>scalar</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"loss/conf_loss"</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conf_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> step</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>global_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">39</span><span>            tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>summary</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>scalar</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"loss/prob_loss"</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> prob_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> step</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>global_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">40</span><span>        writer</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>flush</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">41</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">42</span><span></span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> epoch </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>cfg</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>TRAIN</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>EPOCHS</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">43</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> index</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_data</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> target</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">enumerate</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>trainset</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">44</span><span>        train_step</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_data</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> target</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> epoch</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">45</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">46</span><span>    model</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>save_weights</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"./checkpoints/yolov3-{}-{}.h5"</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(181, 118, 20);">format</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>cfg</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>WEIGHT_NAME_TO_SAVE</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> epoch</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<a class="md-title" id="Reference"></a><h4><div class="h4-left-block" style="height: 100%; display: inline;"></div>Reference</h4>
<ul>
<li>
<p>YOLOv3 源码解析 1-5, <a href="https://blog.csdn.net/sxlsxl119/article/details/103028021" target="_blank">https://blog.csdn.net/sxlsxl119/article/details/103028021</a></p>
</li>
<li>
<p>YOLOv3 算法的一点理解, <a href="https://yunyang1994.gitee.io/2018/12/28/YOLOv3/" target="_blank">https://yunyang1994.gitee.io/2018/12/28/YOLOv3/</a></p>
</li>
<li>
<p>Joseph Redmon, Ali Farhadi, <a href="https://arxiv.org/abs/1804.02767" target="_blank"> <i>YOLOv3: An Incremental Improvement </i></a></p>
</li>
<li>
<p><strong>[TY]</strong> Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He and Piotr Dollar, <a href="https://arxiv.org/pdf/1708.02002.pdf?fbclid=IwAR38T65chV0UNPhBDbAExH021_afC0L6o9PEztpBPBAzqY3dBR8vOGy2qwg" target="_blank"><i>Focal Loss for Dense Object Detection</i></a></p>
</li>
<li>
<p>Adrian Rosebrock, <a href="https://www.pyimagesearch.com/2020/03/23/using-tensorflow-and-gradienttape-to-train-a-keras-model/" target="_blank"><i>Using TensorFlow and GradientTape to train a Keras model</i></a></p>
</li>
</ul></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="height: 40px; width: 5px; min-height: 40px; user-select: none; display: block;"></div><div style="border-top: 3px solid rgba(0, 0, 0, 0.1);"></div><div style="height: 10px; width: 5px; min-height: 10px; user-select: none; display: block;"></div></div></div></div></div><div style="user-select: none;"></div><div class="prev-next-article-buttons-row"><div><button class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" type="button" title="WGAN and WGAN-GP"><span class="MuiButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg> WGAN and WGAN-GP</span><span class="MuiTouchRipple-root"></span></button></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" type="button" title="Different Kinds of Residue Blocks"><span class="MuiButton-label">Different Kinds of Residu ... <svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></span><span class="MuiTouchRipple-root"></span></button></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div></div></div></div></div></div><div class="os-scrollbar os-scrollbar-horizontal"><div class="os-scrollbar-track os-scrollbar-track-off"><div class="os-scrollbar-handle" style="width: 92.6999%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar os-scrollbar-vertical"><div class="os-scrollbar-track os-scrollbar-track-off"><div class="os-scrollbar-handle" style="height: 3.51009%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar-corner"></div></div></div></div><canvas class="vanta-canvas" width="400" height="300" style="position: absolute; z-index: 0; top: 0px; left: 0px; width: 800px; height: 600px;"></canvas></div></div><script>!function(e){function r(r){for(var n,i,a=r[0],c=r[1],l=r[2],s=0,p=[];s<a.length;s++)i=a[s],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(f&&f(r);p.length;)p.shift()();return u.push.apply(u,l||[]),t()}function t(){for(var e,r=0;r<u.length;r++){for(var t=u[r],n=!0,a=1;a<t.length;a++){var c=t[a];0!==o[c]&&(n=!1)}n&&(u.splice(r--,1),e=i(i.s=t[0]))}return e}var n={},o={1:0},u=[];function i(r){if(n[r])return n[r].exports;var t=n[r]={i:r,l:!1,exports:{}};return e[r].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.e=function(e){var r=[],t=o[e];if(0!==t)if(t)r.push(t[2]);else{var n=new Promise((function(r,n){t=o[e]=[r,n]}));r.push(t[2]=n);var u,a=document.createElement("script");a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=function(e){return i.p+"static/js/"+({}[e]||e)+"."+{3:"200ca4e2",4:"eb42c265",5:"2445c647"}[e]+".chunk.js"}(e);var c=new Error;u=function(r){a.onerror=a.onload=null,clearTimeout(l);var t=o[e];if(0!==t){if(t){var n=r&&("load"===r.type?"missing":r.type),u=r&&r.target&&r.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+u+")",c.name="ChunkLoadError",c.type=n,c.request=u,t[1](c)}o[e]=void 0}};var l=setTimeout((function(){u({type:"timeout",target:a})}),12e4);a.onerror=a.onload=u,document.head.appendChild(a)}return Promise.all(r)},i.m=e,i.c=n,i.d=function(e,r,t){i.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,r){if(1&r&&(e=i(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)i.d(t,n,function(r){return e[r]}.bind(null,n));return t},i.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(r,"a",r),r},i.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},i.p="/",i.oe=function(e){throw console.error(e),e};var a=this["webpackJsonpgithub.io.source"]=this["webpackJsonpgithub.io.source"]||[],c=a.push.bind(a);a.push=r,a=a.slice();for(var l=0;l<a.length;l++)r(a[l]);var f=c;t()}([])</script><script src="/static/js/2.e71dbb1d.chunk.js"></script><script src="/static/js/main.1a86c2be.chunk.js"></script><div role="presentation" class="MuiDrawer-root MuiDrawer-modal" aria-hidden="true" style="position: fixed; z-index: 1300; right: 0px; bottom: 0px; top: 0px; left: 0px; visibility: hidden;"><div class="MuiBackdrop-root" aria-hidden="true" style="opacity: 0; visibility: hidden;"></div><div tabindex="0" data-test="sentinelStart"></div><div class="MuiPaper-root MuiDrawer-paper jss9 jss16 MuiDrawer-paperAnchorRight MuiPaper-elevation16" tabindex="-1" style="visibility: hidden; transform: translateX(800px) translateX(-200px);"><div><div class="achive-drawer"><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>AWS Presigned URLs for File-Uploading</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 12, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>① Swagger-UI for Spring Boot in SnapStarted Lambda ② Automation of  Authorization-Header Assignment for API Testings ③ Basic Functionalities</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 2, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>React-Query Fundamentals</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 1, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Unit Testing in Kotlin with MockK</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 31, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Pragmatic drag and drop from Atlassian Design System</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 29, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>JPA and DDD Notes from Real Project Experience</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 29, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>General Purpose Dialog using MUI with Flexible { xs, sm, md, lg, ...etc } Widths</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Auto-generated Mapper From Entity Classes into DTO Classes</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 24, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Redirect from 3rd-party Subdomain (WIX in our example) to AWS Cloudfront Distribution Where we host our Frontend</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 22, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Architecture for Private Lamdba functions called via another lambda function</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 19, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Multiple Ngroks Via Docker Compose</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 18, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Set up ESLINT and Husky for Vite React Project</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 16, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Useful Util Functions to Log Excutation time and the Hibernate Generated Query within a code block by Trailing Closures</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 2, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Email Configuration for Spring Boot in SnapStarted Lambda</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 1, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Redis Task Distribution in Kotlin</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 30, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>HTTP Request Logger in Springboot</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Testcontainer, a Replacement of In-Memory Database in Testing</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 18, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Postman Scripts for Testing and Setting Results into Environment Variables</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 17, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Snapstarted Lambda running Spring Boot and Transition into Spring Boot as a Node.js Developer</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 16, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>ApplicationEventPublisher with Decorators for Domain Driven Design</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 9, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Doubly-Linked List in Typescript</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 8, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Lambda Function Running Python Docker Image</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 6, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Github Action: Docker Action in Python to get Artifact of CloudWatch Logging</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 5, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Scheduled Tasks in ECS: Demonstration via Regular Database Backup</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 27, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Create an HTML via a PDF File!</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 26, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Restore MongoDB from Backup</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 25, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Restore PostgreSQL DB from Backup</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 25, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Github Action: workflow_dispatch</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 24, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>JPA with DB-First Approach: Surgery on JOOQ's POJO into Base @Entity Class</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 20, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>RevenueCat Fundamentals</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 10, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Distributive Lock in Kotlin</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 4, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Application Event Publisher for Monolithic DDD in Nodejs</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 30, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Run Blocking Servlet Requests to Achieve Non-Blocking Performance</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 23, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>SSE, Coroutine and Channel to Notify Frontend for Stripe Events in Spring Boot and Kotlin</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 21, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Function Literals with Receiver</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 16, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Stripe Technical Detail for Add, Upgrade, Downgrade, and Cancel Subscrpition</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 15, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Customization on build.gradle.kts</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 12, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Postgresql and MySQL DB from Docker-Compose and Clone From Existing DB</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 8, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Lambda Function Running Spring Boot in Docker Image</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 7, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Lambda Function Running Nodejs Docker Image</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 6, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Containerization of Spring Boot Application in Kotlin and Troubles in Deployment through ECS</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 5, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Joda Time</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 27, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Monolithic DDD Without ORM by Separating Data and Domain Behaviour</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 21, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Dockerfile for Springboot Application in Gradle</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 17, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Useful Query in JOOQ</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 12, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Custom Overlay Scrollbar Container</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 11, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Stripe Events and metadata in Stripe Checkout Sessions</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 10, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Quartz DeadlineManager in Saga</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 10, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Json Query in PostgreSQL for domain_event_entry in Axon Framework</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 9, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Access Nested Properties from Json String in Kotlin</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 8, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>CORS Configuration for HandlerInterceptors via Spring Security</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 7, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Logging of Commands and Events in Axon Framework</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 6, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>AOP in Kotlin</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 5, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Send Gmail in Kotlin</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 4, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Subscription Query and Error Handling of API Calls</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 3, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Logger in Kotlin</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 1, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Routing Config in React Router v6</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 29, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>A Minimal Example for react-beautiful-dnd</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Git-Crypt Study</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 27, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Create a React-App via Vite, Config for MUI, Load Env Variable from Custom Files.</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 14, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Various ways of Implementing Chatroom Input Field in React Native</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 13, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>K8S Basics Part III: EKS and Container Logging of Pods in CloudWatch via Fluentbit</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 29, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>K8S Basics Part II: Networking</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>K8S Basics Part I: Deployment, Service, Volume and ConfigMap</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 27, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Time-Series Data via WIDTH_BUCKET and Multi-Column Chart</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 26, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>JWT in Spring boot II: Get rid of Spring-Security. More on Parsing Json String into Pojo</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 24, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>JWT in Spring boot I: Using Spring-Security</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 23, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Gradle Fundamentals: Modularization of Spring Boot Project and Dependencies Control</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 22, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Global Exception Handler</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 18, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Simple Study of Transaction</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 17, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Event Publishing and Listening in Spring boot</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 16, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>① Spring boot in Kotlin with JOOQ and Prisma ② Simple Commands for Gradles ③ Integration and Unit Tests</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 15, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Role and User Management in PostgreSQL</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 7, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Record my IntelliJ IDE Setting</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 6, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Get the full type hint from VSCode</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 31, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Github Actions for Serverless Functions</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 23, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Download the Entire CloudWatch Log</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 9, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Self-Reflection on Database Schema Design</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 2, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Kafka and Debezium with Everything Hosted Locally Without Confluent</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>EAS Update</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 17, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>CRUD in DynamoDB</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 16, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>AWS CDK in Typescript and Python with ① Application in S3 ② Lambda Functions with Debugging ③ API Gateway and ④ DynamoDB</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 15, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Create Custom Layer for Lambda Functions in Python</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 12, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>More About Lambda Functions, Thottling, Concurrency, RDS Proxy and Integration with CloudWatch Events</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 4, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Dev Container</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 29, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>CDC in Confluent and Kafka</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Read Write Lock for Go</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 24, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Channel and WaitGroup</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 23, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Custom HashTable by Separate Chaining</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 15, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>In-App Notification</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 14, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Code Organization for RabbitMQ</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 3, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>How to <code>node your-script.js --env=some_env</code></p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 2, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>SQL Functions to Generate created_at, human-readable created_at and updated_at</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 1, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>As-With Clause in SQL</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Javascript Compatible Timestamp in PostgreSQL</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 27, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Use ULID in PostgreSQL</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 26, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Forcefully Make Prisma Ignore The Changes in a Migrated .sql File</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 25, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Prisma Migration Script</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 25, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Declare Types for Non-typed 3rd Party Library</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 24, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Push-Notification in Android and iOS via Expo</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 20, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Code Organization for Redis</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 27, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Auto-hotkey Config for Vscode Switching (Windows)</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 26, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Github Action for Deployment on ECS Fargate</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 22, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Algolia Revisit</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 21, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Fundamentals of Github Actions</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 16, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Advanced Combat Tracker (ACT): Scriping for Trigger</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 11, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Reverse Engineer PostgreSQL to Go Structs</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 6, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Minimal Code for Setting Prisma as Just a Table Migration tool</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 5, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Paste Image in Markdown Files from Clipboard</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 4, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Dead-letter and Delayed Queues</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 24, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Run Kysely Generated SQL in Tableplus</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 23, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Springboot with JOOQ and Functional Endpoints</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 17, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>TSS as a Replacement of makeStyles</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Manage Environment Varisbles for Dev, Uat, Prod in Springboot Using a Single Yaml File</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 8, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Prisma, Prisma-Kysely and Kysely</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 30, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Frontend Retry Mechanism for Refresh Token</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 20, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Load Test and Stress Test by Gatling</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 19, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Record Table Migration Script in SQL</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 17, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Load Environment Variables from Aws Secret Managers and Run Shell Script in Go for DB Schema Migration Based on DB_URL from Secrets</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 15, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Two Stage Docker Image; Docker-Compose with Service B waiting for the Connection of Service A</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 14, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Complete Golang Project Structure</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 13, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Send Google Gmail Without Sendgrid</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 12, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>SQL for Table Migrations in the Course of Developement</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 11, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Transactions, Go and sqlc</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 6, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Make a Custom Swipable Item</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 5, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>PostgreSQL Revisit</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 4, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Docker Containerization of Nodejs with Typescript</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Custom Winston Logger in Nodejs</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Mongoose way to Convert String into Objectid in Aggregation</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 2, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Goose and Sqlc for Database Migration and Query Function Generation</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 28, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Push Data to Frontend by SSE via Event-Driven Approach with NO Short Polling</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 22, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>@gorhom/bottom-sheet</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 21, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Generate Excel by Openpyxl</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 20, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Long Running Task in Background for Mobile App</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 17, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Terraform Modules</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 16, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Remote State for Whole Development Team; Create and Deploy on a Public Subnet of Custom VPC</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 15, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Conditions and Loops</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 14, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Variables and Remote Execution</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 13, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>AWS Resources Instanciation in Terraform</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Pin to Zoom Camera</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 9, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Audio Recording in React-Native</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 7, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>AWS Fargate: Let's Create Service and Run Task!</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 7, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>File Upload and Download Using Stream and FormData in React-Native</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 5, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Custom BottomSheet</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Custom Toast Messages</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 1, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Expo-CLI for Development Build</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 30, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Clone a Swipable Page Inspired from Discord Mobile App</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 26, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Auto-Incremented Id for Mongo Collection</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 24, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Voice Chat on Mobile Using AgoraRTC</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 23, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Create a left-join in Mongoose</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 21, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Scaling Websocket Chat Sever by Redis</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 20, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Simple Chat Server in Rust via Telnet</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 19, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Setup of Express with Socket.io with JWT Authentication Using Cookie</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 16, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Jest Fundamentals in TS</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 15, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Environment Variable by env-cmdrc</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 11, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Rust Formatter Configruation</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Elliptic Curve and Operator Overloading</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 9, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Custom Rendering of Custom Child Component</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 6, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Routing Schema for Frontend Project</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 5, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Rust Study Notes</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 4, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Restrict CORS to Limited Origins</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Handle Streams in File-Responding Request</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Server Sent Event in Java and Node.js Backend</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Scroll Up and Down Events in React</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 2, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Box Shadow</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 27, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Hook to Rerender Component By Making use of the Single Threaded Event Driven Model Behind v8</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 15, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>forwardRef and useImperativeHandle</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 14, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Google Login</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 13, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Getting Path Parameters</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 11, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Snackbar Utils</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Multi-Selections</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Write Mongo Aggregation Using JSON in Springboot</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 30, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Detect Click Outside</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 27, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Build a Search Function</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 26, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Serverless Flask and Serverless Express-ts</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 19, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Gmail and Inbox Push Notification</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 17, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Flask with Uwsgi and Docker Image Deployment</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Deployment of React Project Using S3 and Cloudfront</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 8, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Lazy Loading</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 5, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>normalizr --- Convert Array of Data Into Hashmap</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 5, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Remote Debugger for Spring Application</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 2, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>.gitlab-ci.yml for Deploying Static Pages to S3</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 28, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Docker Run Indefinitely</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 25, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>tsconfig.json</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 24, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Revisit Docker and Gitlab-CI</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 23, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Quick Step to Make a Reducer Persist its Data</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 21, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Radio Buttons Group and General Dropdown List</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 21, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Scrollbar Style Like Mac</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 20, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Write Middlewares in Redux-Toolkit</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 20, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Use of dayjs</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 16, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Two Kinds of $lookup, and use Javascript in Advanced lookup</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 15, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Inner and Left Joining Multiple Collections in Mongo --- The preserveNullAndEmptyArrays in $unwind</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 15, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Redux Slice Template</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 13, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>List of Mongo Aggregation Pipelines that I have Used.</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Mui CSS Animation with Keyframes</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 9, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Data Scrapping for Data that Requires Click by Click</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 27, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>General Post Request in Springboot and File Uploading</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 25, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Register URL Scheme for an Application</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 6, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>std::variant</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 5, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Libtorch Study Notes With OpenCV</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 2, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Precompiled Header in CMake Project</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 27, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Control C++ Standard Accurately</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 24, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Install Opencv and Libtorch for CMake Project</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 20, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Diffusion Model Study</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 7, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Commuication Between Two Threads</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 27, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>C++ Useful Util Functions Mimiced from Python, Regular Expression</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 9, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>C++ VSCode says it cannot open source file when it really can</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 28, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Pytorch/libtorch with CPP API</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 11, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Socket Programming Fundamentals by winsock</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Simple Introduction to CMake Files</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Gray Matter</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 14, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>TCP Server Fundamental</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 12, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Variadic Version of Print in C++</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 9, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Iterator</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 30, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Array and Dynamic Array Class</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 29, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Precompiled Header</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 27, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Copy Constructor</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 23, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Visual Studio Solution Configuration</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 16, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>makeStyles for react-mui v5.0 and tss-react/mui</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Redux Toolkit Quick Setup</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Config Files Organization in Frontend Project (Next.js Specific)</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Onnx Model Deployment to Frontend From Pytorch Model</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 14, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>RetinaFace</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 6, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Albumentations and Common Helper Functions with PyTorch</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 5, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>collate_fn in pytorch</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 3, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>CPP VSCode Configuration for 2020 Standard</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 8, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Cascade RCNN</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 30, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Squeeze and Excitation Network</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 29, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Gradient Clipping</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 22, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Swin-Transformer Backbone in Faster RCNN</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 20, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Swin Transformer with einops Implementation</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 19, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Mesh Grid Trick</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 7, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Vision Transformer with einops Implementation</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 6, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Angular Fundamental</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 18, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Transformer 2: A More in Depth Training with Real World Dataset Using Modern NLP Dataset Pipeline in Pytorch</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 17, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Transformer 1: The Model Definition and Naive Training Dataset for Machine Translation</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 11, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Retrain Model when Nan Occurs</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 22, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Feature Extractors</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 14, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Data Augmentation for Object Detection</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 30, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Faster RCNN in PyTorch</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 27, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>EAST: A Text Detection Algorithm</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 29, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>CV2, Pillow and shapely for Polygons</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 28, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Masks in Numpy and Retrive Corresponding Indexes</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 28, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>tqdm: The Progress bar for Iterations</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 27, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Logging Without Printing New Lines</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 23, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Pytorch Fundamentals</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 23, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Shell Script Fundamentals</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 20, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Install tensorflow-gpu</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>DefectGAN</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 9, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Singular Value Decomposition</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 30, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Principal Component Analysis</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 30, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Pandoc</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 29, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>WGAN and WGAN-GP</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 22, 2022</i></div></div><div class="toc-home-row active"><div class="toc-home-title"><span class="toc-home-title-text"><p>YOLOv3 Deep Dive</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 22, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Different Kinds of Residue Blocks</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 20, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Element that has Default Fade-in Transition on Mount</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 19, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Discrete Cosine Transform and JPEG Compression Implementation in Python</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 16, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Summarize Rust Beginning Tutorial by a Simplified Multithreading Web Server</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>SSH Config and Download File in SSH Client</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 12, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Typescript Debugger Config</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 11, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>pathlib and json in Python</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 7, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Countability of a kind of Discontinuity</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 4, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Color-GAN with Auto-Coloring on Animated Gray Images</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 1, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Ctrl- and Middle-Clickable Button;  Method to Scroll to Target Element</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 30, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Mongoose in Nodejs and Mongoengine in Python</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 29, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Cycle-GAN in Tensorflow</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 25, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Two Methods to Read Excel Files in Python</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 24, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Type Annotation Record in Typescript for 3rd-party Library and Usual Import</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 23, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Resulting Shapes of Conv-net by Direct Experiment</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 23, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Simple Introduction to mAP and F1-Score</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 21, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Additional Configuration for makeStyles in Next js</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 13, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>How to Configure S3 to Send SQS Message</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 10, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Customized Logger in Python and Javascript</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 7, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Set up Local Environment for Mongo using Docker</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 25, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>GAN and DCGAN in Tensorflow</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Python Generator</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 4, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Nodejs Image Compression in Backend with sharp</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 16, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Call Python Script in Node.js</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 11, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Nextjs with Electron</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 6, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Debug Nextjs with Typescript in VSCode</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 2, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Debug Javascript For Individual File</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 1, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Datetime Object in Python</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 20, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Decompose a Class into Separate Files</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 26, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Python Debugger with Project Directory Included in sys.path</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 25, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>How to Include Project Directory in sys.path when Running pytest</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 20, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Auto Hotkey Record</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 17, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Automation Task for Chrome</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 2, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>First to Leave Problem of Elevator</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 1, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Live2D 心得</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 18, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p> template</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 10, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>C++ Beginner Notes 02 - Shallow Copy, Deep Copy and Move Semantics</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 9, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>C++ Beginner Notes 01 - Stack and Heap</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 8, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Scrapping Images with Selenium and Beautifulsoup on Chrome</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 30, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Image Augmentation with Custom Dataset Pipeline</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 29, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Transfer Learning Based on VGG-16</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 28, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Tensorflow Callbacks and Restart Training Process Based on Past Epoches</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 28, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Comprehensive List of SVG Icon Available in React</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 27, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Colab Setting</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 27, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Dataset Pipeline and Custom Training in Tensorflow</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 26, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>The Set Equality  for Convex Set </p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 20, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Understand Pytorch via GAN</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 20, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Computational Example on Probability Distribution</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 19, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Make your React App Scrapable by Google Search Engine</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 14, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Disqus Comment Plug-in in React</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 12, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Convex Analysis - More on Convex Functions and Characterize Convex lsc Functions by Biconjugate Functionals</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 11, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Convex Analysis - Characterization of Convex lsc Functions</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 8, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Exercises on Algorithms</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 26, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Algorithm: Merge Sort and its Time Complexity</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 25, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>On Redux-Saga</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 19, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Useful Conda Commands</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 18, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Review of Basic Statistics</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 15, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Typescript Type Tricks</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 14, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>On Looping all Files in Frontend</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 13, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Lazy React Router</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 12, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><p>Study Notes on Distribution and Latent Variable Model in Vartiaonal Auto Encoder</p></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 10, 2021</i></div></div></div></div></div></div><div tabindex="0" data-test="sentinelEnd"></div></div></body></html>