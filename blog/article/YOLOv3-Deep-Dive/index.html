<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><link href="https://cdn.rawgit.com/dreampulse/computer-modern-web-font/master/fonts.css" rel="stylesheet"><link rel="icon" href="/favicon.ico?version=2"><link href="/assets/fonts/font-style.css" rel="stylesheet"><link rel="preload" href="/assets/images/background_img.jpg" as="image"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#000000"><meta name="Ching Cheong" content="Ching Cheong"><meta name="Lee Ching Cheong" content="Lee Ching Cheong"><meta property="og:description" content="Lee Ching Cheong's Personal Homepage"><meta property="description" content="Lee Ching Cheong's Personal Homepage"><link rel="apple-touch-icon" href="/favicon.ico?version=2"><link rel="manifest" href="/manifest.json"><title>CCLee / Blog / YOLOv3 Deep Dive</title><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QGQRTXJSNS"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-QGQRTXJSNS")</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" id=""></script><link href="/static/css/2.d36edc37.chunk.css" rel="stylesheet"><link href="/static/css/main.38565740.chunk.css" rel="stylesheet"><style data-jss="" data-meta="MuiTouchRipple">
.MuiTouchRipple-root {
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 0;
  overflow: hidden;
  position: absolute;
  border-radius: inherit;
  pointer-events: none;
}
.MuiTouchRipple-ripple {
  opacity: 0;
  position: absolute;
}
.MuiTouchRipple-rippleVisible {
  opacity: 0.3;
  animation: MuiTouchRipple-keyframes-enter 550ms cubic-bezier(0.4, 0, 0.2, 1);
  transform: scale(1);
}
.MuiTouchRipple-ripplePulsate {
  animation-duration: 200ms;
}
.MuiTouchRipple-child {
  width: 100%;
  height: 100%;
  display: block;
  opacity: 1;
  border-radius: 50%;
  background-color: currentColor;
}
.MuiTouchRipple-childLeaving {
  opacity: 0;
  animation: MuiTouchRipple-keyframes-exit 550ms cubic-bezier(0.4, 0, 0.2, 1);
}
.MuiTouchRipple-childPulsate {
  top: 0;
  left: 0;
  position: absolute;
  animation: MuiTouchRipple-keyframes-pulsate 2500ms cubic-bezier(0.4, 0, 0.2, 1) 200ms infinite;
}
@-webkit-keyframes MuiTouchRipple-keyframes-enter {
  0% {
    opacity: 0.1;
    transform: scale(0);
  }
  100% {
    opacity: 0.3;
    transform: scale(1);
  }
}
@-webkit-keyframes MuiTouchRipple-keyframes-exit {
  0% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}
@-webkit-keyframes MuiTouchRipple-keyframes-pulsate {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(0.92);
  }
  100% {
    transform: scale(1);
  }
}
</style><style data-jss="" data-meta="MuiButtonBase">
.MuiButtonBase-root {
  color: inherit;
  border: 0;
  cursor: pointer;
  margin: 0;
  display: inline-flex;
  outline: 0;
  padding: 0;
  position: relative;
  align-items: center;
  user-select: none;
  border-radius: 0;
  vertical-align: middle;
  -moz-appearance: none;
  justify-content: center;
  text-decoration: none;
  background-color: transparent;
  -webkit-appearance: none;
  -webkit-tap-highlight-color: transparent;
}
.MuiButtonBase-root::-moz-focus-inner {
  border-style: none;
}
.MuiButtonBase-root.Mui-disabled {
  cursor: default;
  pointer-events: none;
}
@media print {
  .MuiButtonBase-root {
    -webkit-print-color-adjust: exact;
  }
}
</style><style data-jss="" data-meta="MuiButton">
.MuiButton-root {
  color: rgba(0, 0, 0, 0.87);
  padding: 6px 16px;
  font-size: 0.875rem;
  min-width: 64px;
  box-sizing: border-box;
  transition: background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
  font-family: "Roboto", "Helvetica", "Arial", sans-serif;
  font-weight: 500;
  line-height: 1.75;
  border-radius: 4px;
  letter-spacing: 0.02857em;
  text-transform: uppercase;
}
.MuiButton-root:hover {
  text-decoration: none;
  background-color: rgba(0, 0, 0, 0.04);
}
.MuiButton-root.Mui-disabled {
  color: rgba(0, 0, 0, 0.26);
}
@media (hover: none) {
  .MuiButton-root:hover {
    background-color: transparent;
  }
}
.MuiButton-root:hover.Mui-disabled {
  background-color: transparent;
}
.MuiButton-label {
  width: 100%;
  display: inherit;
  align-items: inherit;
  justify-content: inherit;
}
.MuiButton-text {
  padding: 6px 8px;
}
.MuiButton-textPrimary {
  color: #3f51b5;
}
.MuiButton-textPrimary:hover {
  background-color: rgba(63, 81, 181, 0.04);
}
@media (hover: none) {
  .MuiButton-textPrimary:hover {
    background-color: transparent;
  }
}
.MuiButton-textSecondary {
  color: #f50057;
}
.MuiButton-textSecondary:hover {
  background-color: rgba(245, 0, 87, 0.04);
}
@media (hover: none) {
  .MuiButton-textSecondary:hover {
    background-color: transparent;
  }
}
.MuiButton-outlined {
  border: 1px solid rgba(0, 0, 0, 0.23);
  padding: 5px 15px;
}
.MuiButton-outlined.Mui-disabled {
  border: 1px solid rgba(0, 0, 0, 0.12);
}
.MuiButton-outlinedPrimary {
  color: #3f51b5;
  border: 1px solid rgba(63, 81, 181, 0.5);
}
.MuiButton-outlinedPrimary:hover {
  border: 1px solid #3f51b5;
  background-color: rgba(63, 81, 181, 0.04);
}
@media (hover: none) {
  .MuiButton-outlinedPrimary:hover {
    background-color: transparent;
  }
}
.MuiButton-outlinedSecondary {
  color: #f50057;
  border: 1px solid rgba(245, 0, 87, 0.5);
}
.MuiButton-outlinedSecondary:hover {
  border: 1px solid #f50057;
  background-color: rgba(245, 0, 87, 0.04);
}
.MuiButton-outlinedSecondary.Mui-disabled {
  border: 1px solid rgba(0, 0, 0, 0.26);
}
@media (hover: none) {
  .MuiButton-outlinedSecondary:hover {
    background-color: transparent;
  }
}
.MuiButton-contained {
  color: rgba(0, 0, 0, 0.87);
  box-shadow: 0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12);
  background-color: #e0e0e0;
}
.MuiButton-contained:hover {
  box-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);
  background-color: #d5d5d5;
}
.MuiButton-contained.Mui-focusVisible {
  box-shadow: 0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12);
}
.MuiButton-contained:active {
  box-shadow: 0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12);
}
.MuiButton-contained.Mui-disabled {
  color: rgba(0, 0, 0, 0.26);
  box-shadow: none;
  background-color: rgba(0, 0, 0, 0.12);
}
@media (hover: none) {
  .MuiButton-contained:hover {
    box-shadow: 0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12);
    background-color: #e0e0e0;
  }
}
.MuiButton-contained:hover.Mui-disabled {
  background-color: rgba(0, 0, 0, 0.12);
}
.MuiButton-containedPrimary {
  color: #fff;
  background-color: #3f51b5;
}
.MuiButton-containedPrimary:hover {
  background-color: #303f9f;
}
@media (hover: none) {
  .MuiButton-containedPrimary:hover {
    background-color: #3f51b5;
  }
}
.MuiButton-containedSecondary {
  color: #fff;
  background-color: #f50057;
}
.MuiButton-containedSecondary:hover {
  background-color: #c51162;
}
@media (hover: none) {
  .MuiButton-containedSecondary:hover {
    background-color: #f50057;
  }
}
.MuiButton-disableElevation {
  box-shadow: none;
}
.MuiButton-disableElevation:hover {
  box-shadow: none;
}
.MuiButton-disableElevation.Mui-focusVisible {
  box-shadow: none;
}
.MuiButton-disableElevation:active {
  box-shadow: none;
}
.MuiButton-disableElevation.Mui-disabled {
  box-shadow: none;
}
.MuiButton-colorInherit {
  color: inherit;
  border-color: currentColor;
}
.MuiButton-textSizeSmall {
  padding: 4px 5px;
  font-size: 0.8125rem;
}
.MuiButton-textSizeLarge {
  padding: 8px 11px;
  font-size: 0.9375rem;
}
.MuiButton-outlinedSizeSmall {
  padding: 3px 9px;
  font-size: 0.8125rem;
}
.MuiButton-outlinedSizeLarge {
  padding: 7px 21px;
  font-size: 0.9375rem;
}
.MuiButton-containedSizeSmall {
  padding: 4px 10px;
  font-size: 0.8125rem;
}
.MuiButton-containedSizeLarge {
  padding: 8px 22px;
  font-size: 0.9375rem;
}
.MuiButton-fullWidth {
  width: 100%;
}
.MuiButton-startIcon {
  display: inherit;
  margin-left: -4px;
  margin-right: 8px;
}
.MuiButton-startIcon.MuiButton-iconSizeSmall {
  margin-left: -2px;
}
.MuiButton-endIcon {
  display: inherit;
  margin-left: 8px;
  margin-right: -4px;
}
.MuiButton-endIcon.MuiButton-iconSizeSmall {
  margin-right: -2px;
}
.MuiButton-iconSizeSmall > *:first-child {
  font-size: 18px;
}
.MuiButton-iconSizeMedium > *:first-child {
  font-size: 20px;
}
.MuiButton-iconSizeLarge > *:first-child {
  font-size: 22px;
}
</style><style data-jss="" data-meta="makeStyles">

</style><style data-jss="" data-meta="MuiCollapse">
.MuiCollapse-container {
  height: 0;
  overflow: hidden;
  transition: height 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
}
.MuiCollapse-entered {
  height: auto;
  overflow: visible;
}
.MuiCollapse-hidden {
  visibility: hidden;
}
.MuiCollapse-wrapper {
  display: flex;
}
.MuiCollapse-wrapperInner {
  width: 100%;
}
</style><style data-jss="" data-meta="MuiSvgIcon">
.MuiSvgIcon-root {
  fill: currentColor;
  width: 1em;
  height: 1em;
  display: inline-block;
  font-size: 1.5rem;
  transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
  flex-shrink: 0;
  user-select: none;
}
.MuiSvgIcon-colorPrimary {
  color: #3f51b5;
}
.MuiSvgIcon-colorSecondary {
  color: #f50057;
}
.MuiSvgIcon-colorAction {
  color: rgba(0, 0, 0, 0.54);
}
.MuiSvgIcon-colorError {
  color: #f44336;
}
.MuiSvgIcon-colorDisabled {
  color: rgba(0, 0, 0, 0.26);
}
.MuiSvgIcon-fontSizeInherit {
  font-size: inherit;
}
.MuiSvgIcon-fontSizeSmall {
  font-size: 1.25rem;
}
.MuiSvgIcon-fontSizeLarge {
  font-size: 2.1875rem;
}
</style><style data-jss="" data-meta="fade-in">
@-webkit-keyframes jss127 {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}
.jss128.fade-in {
  animation: jss127 .3s ease-in-out;
}
</style><style data-jss="" data-meta="custom-code-style">
.jss29 {
  border: 1px solid rgba(0,0,0,0.3);
  cursor: pointer;
  padding: 0 4px;
  transition: all 0.2s ease;
  margin-left: 4px;
  border-radius: 3px;
  text-decoration: none !important;
}
.jss29:hover {
  border-color: rgba(0,0,0,0.5);
  background-color: rgba(0,0,0,0.1);
}
.jss30 {
  margin-left: 10px;
}
.jss31 {
  box-shadow: rgba(9, 30, 66, 0.25) 0px 4px 8px -2px,rgba(9, 30, 66, 0.08) 0px 0px 0px 1px;
  margin-top: 30px;
  border-left: 6px solid rgba(123,185,209,0.3);
  margin-left: 20px;
  padding-top: 10px;
  padding-left: calc(1.5em - 3px);
  border-radius: 6px;
  margin-bottom: 30px;
  padding-right: 10px;
  padding-bottom: 2px;
  background-color: rgba(0,0,0,0.015);
}
.jss32 {
  margin-top: 20px;
  padding-left: calc(2em - 3px);
  margin-bottom: 20px;
}
.jss32 > p:nth-child(1) {
  text-indent: calc(3px - 2em) !important;
}
.jss33 .react-syntax-highlighter-line-number {
  min-width: 2.5em !important;
}
.jss33 pre {
  border: 1px solid #E0E0E0;
  background: #F5F5F5!important;
  padding-top: 0.95em !important;
  border-radius: 2px;
}
.jss33 .no-bg {
  background: transparent !important;
}
.jss33 .no-bg code {
  background: transparent !important;
}
.jss34 ul li::marker {
  color: rgba(0,0,0,0.65);
}
.jss34 .tech-row:first-child {
  padding-top: 5px;
}
.jss34 .tech-row {
  padding: 20px;
  padding-top: 15px;
  padding-bottom: 0;
}
.jss34 .tech-row:nth-child(2n) {
  background-color: rgba(0,0,0,0.05);
}
.jss34 .tech-row:nth-child(4) {
  border-bottom-left-radius: 6px;
  border-bottom-right-radius: 6px;
}
.jss34 .tech-row:last-child {
  margin-bottom: 4px;
}
.jss34 .tech-label {
  font-weight: 600;
}
@media (max-width: 768px) {
  .jss34 .tech-content {
    flex: unset;
    width: 100%;
  }
}
@media (max-width: 768px) {
  .jss34 .tech-label {
    width: 100%;
    margin-bottom: 8px;
  }
}
@media (max-width: 768px) {
  .jss34 .tech-row {
    align-items: flex-start;
    flex-direction: column;
  }
}
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="custom-code-style">
</style><style data-jss="" data-meta="return-button-modified">
.jss129 {
  color: #394852;
  border: 1px solid #e5e7eb;
  padding: 4px 16px;
  font-size: 16px;
  min-width: unset;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  transition: all 0.2s ease;
  font-variant: small-caps;
  padding-left: 8px;
  border-radius: 6px;
  text-transform: capitalize;
  background-color: #f3f4f6;
}
.jss129:hover {
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  border-color: #d1d5db;
  background-color: #e5e7eb;
}
.jss129 svg {
  color: #394852;
  font-size: 24px!important;
  margin-right: 4px;
}
</style><style data-jss="" data-meta="makeStyles">

</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="custom-articles">
.jss40 a {
  color: #2a718d !important;
}
.jss40 h5 ~ h6 {
  margin-top: 40px;
}
.jss40 h4 ~ h5 {
  margin-top: 40px;
}
.jss40 ol li::marker {
  font-weight: 700;
}
.jss40 ol li {
  padding-left: 6px;
}
.jss40 .article-content ul {
  margin-bottom: 15px;
}
.jss40 .article-content ol {
  margin-bottom: 15px;
}
.jss40 .article-content ol ul li {
  margin-bottom: 0;
}
.jss41 code {
  border: 1px solid rgba(0,0,0,0.03);
  font-size: 0.85em !important;
  background: #F5F5F5!important;
  line-height: 1.4em !important;
  border-radius: 4px;
}
.jss41 pre {
  margin: 1em 0;
}
.jss41 pre code {
  border: none;
  font-size: 0.9em !important;
  line-height: 1.4em !important;
}
.jss42 {
  display: block;
  border-right: 6px solid transparent;
  padding-right: 10px;
}
.jss43 {
  transition: border-color 0.2s ease-in-out;
  border-right: 6px solid #6fa8cd;
}
.jss44 {
  color: inherit;
  border-right: 6px solid transparent;
  background-color: inherit;
}
.jss45 {
  top: 70px;
  left: 50px;
  width: 360px;
  border: 1px solid rgba(0,0,0,0.1);
  opacity: 0;
  padding: 20px;
  position: sticky;
  transform: translate(-500px,-30px);
  max-height: 650px;
  overflow-y: scroll;
  transition: top 0.1s linear;
  padding-top: 0;
  border-radius: 6px;
  pointers-event: none;
  background-color: white;
}
.jss45 .TOC-heading {
  font-size: 16px;
}
.jss45 .content-row {
  top: 0;
  position: sticky;
  background: rgba(255,255,255,0.7);
  padding-top: 20px;
  backdrop-filter: blur(8px);
}
.jss45 h5 {
  margin-top: 0;
}
.jss45.open {
  opacity: 1;
  transition: opacity 0.1s linear;
  pointers-event: auto;
}
@media (max-width:1768px) {
  .jss45 {
    opacity: 0 !important;
    pointers-event: none !important;
  }
}
.jss46 {
  color: #394852;
  border: 1px solid #e5e7eb;
  padding: 4px 16px;
  font-size: 16px;
  min-width: unset;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  transition: all 0.2s ease;
  font-variant: small-caps;
  padding-left: 16px;
  border-radius: 6px;
  text-transform: capitalize;
  background-color: #f3f4f6;
}
.jss46:hover {
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  border-color: #d1d5db;
  background-color: #e5e7eb;
}
.jss46 svg {
  color: #394852;
  font-size: 20px!important;
  margin-right: 4px;
}
</style><style data-jss="" data-meta="MuiBackdrop">
.MuiBackdrop-root {
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  z-index: -1;
  position: fixed;
  align-items: center;
  justify-content: center;
  background-color: rgba(0, 0, 0, 0.5);
  -webkit-tap-highlight-color: transparent;
}
.MuiBackdrop-invisible {
  background-color: transparent;
}
</style><style data-jss="" data-meta="MuiPaper">
.MuiPaper-root {
  color: rgba(0, 0, 0, 0.87);
  transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
  background-color: #fff;
}
.MuiPaper-rounded {
  border-radius: 4px;
}
.MuiPaper-outlined {
  border: 1px solid rgba(0, 0, 0, 0.12);
}
.MuiPaper-elevation0 {
  box-shadow: none;
}
.MuiPaper-elevation1 {
  box-shadow: 0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation2 {
  box-shadow: 0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation3 {
  box-shadow: 0px 3px 3px -2px rgba(0,0,0,0.2),0px 3px 4px 0px rgba(0,0,0,0.14),0px 1px 8px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation4 {
  box-shadow: 0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation5 {
  box-shadow: 0px 3px 5px -1px rgba(0,0,0,0.2),0px 5px 8px 0px rgba(0,0,0,0.14),0px 1px 14px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation6 {
  box-shadow: 0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12);
}
.MuiPaper-elevation7 {
  box-shadow: 0px 4px 5px -2px rgba(0,0,0,0.2),0px 7px 10px 1px rgba(0,0,0,0.14),0px 2px 16px 1px rgba(0,0,0,0.12);
}
.MuiPaper-elevation8 {
  box-shadow: 0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12);
}
.MuiPaper-elevation9 {
  box-shadow: 0px 5px 6px -3px rgba(0,0,0,0.2),0px 9px 12px 1px rgba(0,0,0,0.14),0px 3px 16px 2px rgba(0,0,0,0.12);
}
.MuiPaper-elevation10 {
  box-shadow: 0px 6px 6px -3px rgba(0,0,0,0.2),0px 10px 14px 1px rgba(0,0,0,0.14),0px 4px 18px 3px rgba(0,0,0,0.12);
}
.MuiPaper-elevation11 {
  box-shadow: 0px 6px 7px -4px rgba(0,0,0,0.2),0px 11px 15px 1px rgba(0,0,0,0.14),0px 4px 20px 3px rgba(0,0,0,0.12);
}
.MuiPaper-elevation12 {
  box-shadow: 0px 7px 8px -4px rgba(0,0,0,0.2),0px 12px 17px 2px rgba(0,0,0,0.14),0px 5px 22px 4px rgba(0,0,0,0.12);
}
.MuiPaper-elevation13 {
  box-shadow: 0px 7px 8px -4px rgba(0,0,0,0.2),0px 13px 19px 2px rgba(0,0,0,0.14),0px 5px 24px 4px rgba(0,0,0,0.12);
}
.MuiPaper-elevation14 {
  box-shadow: 0px 7px 9px -4px rgba(0,0,0,0.2),0px 14px 21px 2px rgba(0,0,0,0.14),0px 5px 26px 4px rgba(0,0,0,0.12);
}
.MuiPaper-elevation15 {
  box-shadow: 0px 8px 9px -5px rgba(0,0,0,0.2),0px 15px 22px 2px rgba(0,0,0,0.14),0px 6px 28px 5px rgba(0,0,0,0.12);
}
.MuiPaper-elevation16 {
  box-shadow: 0px 8px 10px -5px rgba(0,0,0,0.2),0px 16px 24px 2px rgba(0,0,0,0.14),0px 6px 30px 5px rgba(0,0,0,0.12);
}
.MuiPaper-elevation17 {
  box-shadow: 0px 8px 11px -5px rgba(0,0,0,0.2),0px 17px 26px 2px rgba(0,0,0,0.14),0px 6px 32px 5px rgba(0,0,0,0.12);
}
.MuiPaper-elevation18 {
  box-shadow: 0px 9px 11px -5px rgba(0,0,0,0.2),0px 18px 28px 2px rgba(0,0,0,0.14),0px 7px 34px 6px rgba(0,0,0,0.12);
}
.MuiPaper-elevation19 {
  box-shadow: 0px 9px 12px -6px rgba(0,0,0,0.2),0px 19px 29px 2px rgba(0,0,0,0.14),0px 7px 36px 6px rgba(0,0,0,0.12);
}
.MuiPaper-elevation20 {
  box-shadow: 0px 10px 13px -6px rgba(0,0,0,0.2),0px 20px 31px 3px rgba(0,0,0,0.14),0px 8px 38px 7px rgba(0,0,0,0.12);
}
.MuiPaper-elevation21 {
  box-shadow: 0px 10px 13px -6px rgba(0,0,0,0.2),0px 21px 33px 3px rgba(0,0,0,0.14),0px 8px 40px 7px rgba(0,0,0,0.12);
}
.MuiPaper-elevation22 {
  box-shadow: 0px 10px 14px -6px rgba(0,0,0,0.2),0px 22px 35px 3px rgba(0,0,0,0.14),0px 8px 42px 7px rgba(0,0,0,0.12);
}
.MuiPaper-elevation23 {
  box-shadow: 0px 11px 14px -7px rgba(0,0,0,0.2),0px 23px 36px 3px rgba(0,0,0,0.14),0px 9px 44px 8px rgba(0,0,0,0.12);
}
.MuiPaper-elevation24 {
  box-shadow: 0px 11px 15px -7px rgba(0,0,0,0.2),0px 24px 38px 3px rgba(0,0,0,0.14),0px 9px 46px 8px rgba(0,0,0,0.12);
}
</style><style data-jss="" data-meta="MuiDrawer">
.MuiDrawer-docked {
  flex: 0 0 auto;
}
.MuiDrawer-paper {
  top: 0;
  flex: 1 0 auto;
  height: 100%;
  display: flex;
  outline: 0;
  z-index: 1200;
  position: fixed;
  overflow-y: auto;
  flex-direction: column;
  -webkit-overflow-scrolling: touch;
}
.MuiDrawer-paperAnchorLeft {
  left: 0;
  right: auto;
}
.MuiDrawer-paperAnchorRight {
  left: auto;
  right: 0;
}
.MuiDrawer-paperAnchorTop {
  top: 0;
  left: 0;
  right: 0;
  bottom: auto;
  height: auto;
  max-height: 100%;
}
.MuiDrawer-paperAnchorBottom {
  top: auto;
  left: 0;
  right: 0;
  bottom: 0;
  height: auto;
  max-height: 100%;
}
.MuiDrawer-paperAnchorDockedLeft {
  border-right: 1px solid rgba(0, 0, 0, 0.12);
}
.MuiDrawer-paperAnchorDockedTop {
  border-bottom: 1px solid rgba(0, 0, 0, 0.12);
}
.MuiDrawer-paperAnchorDockedRight {
  border-left: 1px solid rgba(0, 0, 0, 0.12);
}
.MuiDrawer-paperAnchorDockedBottom {
  border-top: 1px solid rgba(0, 0, 0, 0.12);
}
</style><style data-jss="" data-meta="makeStyles">
.jss4 {
  transition: margin 195ms cubic-bezier(0.4, 0, 0.6, 1) 0ms,width 195ms cubic-bezier(0.4, 0, 0.6, 1) 0ms;
}
.jss5 {
  transition: margin 225ms cubic-bezier(0.0, 0, 0.2, 1) 0ms,width 225ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;
}
.jss6 {
  flex-grow: 1;
}
.jss7 {
  display: none;
}
.jss8 {
  flex-shrink: 0;
}
.jss10 {
  display: flex;
  padding: 0px 8px;
  min-height: 56px;
  align-items: center;
  justify-content: flex-start;
}
@media (min-width:0px) and (orientation: landscape) {
  .jss10 {
    min-height: 48px;
  }
}
@media (min-width:600px) {
  .jss10 {
    min-height: 64px;
  }
}
.jss11 {
  padding: 24px;
  flex-grow: 1;
  transition: margin 195ms cubic-bezier(0.4, 0, 0.6, 1) 0ms;
}
.jss12 {
  transition: margin 225ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;
  margin-right: 0;
}
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="makeStyles">
</style><style data-jss="" data-meta="MuiInputBase">
@-webkit-keyframes mui-auto-fill {}
@-webkit-keyframes mui-auto-fill-cancel {}
.MuiInputBase-root {
  color: rgba(0, 0, 0, 0.87);
  cursor: text;
  display: inline-flex;
  position: relative;
  font-size: 1rem;
  box-sizing: border-box;
  align-items: center;
  font-family: "Roboto", "Helvetica", "Arial", sans-serif;
  font-weight: 400;
  line-height: 1.1876em;
  letter-spacing: 0.00938em;
}
.MuiInputBase-root.Mui-disabled {
  color: rgba(0, 0, 0, 0.38);
  cursor: default;
}
.MuiInputBase-multiline {
  padding: 6px 0 7px;
}
.MuiInputBase-multiline.MuiInputBase-marginDense {
  padding-top: 3px;
}
.MuiInputBase-fullWidth {
  width: 100%;
}
.MuiInputBase-input {
  font: inherit;
  color: currentColor;
  width: 100%;
  border: 0;
  height: 1.1876em;
  margin: 0;
  display: block;
  padding: 6px 0 7px;
  min-width: 0;
  background: none;
  box-sizing: content-box;
  animation-name: mui-auto-fill-cancel;
  letter-spacing: inherit;
  animation-duration: 10ms;
  -webkit-tap-highlight-color: transparent;
}
.MuiInputBase-input::-webkit-input-placeholder {
  color: currentColor;
  opacity: 0.42;
  transition: opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
}
.MuiInputBase-input::-moz-placeholder {
  color: currentColor;
  opacity: 0.42;
  transition: opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
}
.MuiInputBase-input:-ms-input-placeholder {
  color: currentColor;
  opacity: 0.42;
  transition: opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
}
.MuiInputBase-input::-ms-input-placeholder {
  color: currentColor;
  opacity: 0.42;
  transition: opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
}
.MuiInputBase-input:focus {
  outline: 0;
}
.MuiInputBase-input:invalid {
  box-shadow: none;
}
.MuiInputBase-input::-webkit-search-decoration {
  -webkit-appearance: none;
}
.MuiInputBase-input.Mui-disabled {
  opacity: 1;
}
.MuiInputBase-input:-webkit-autofill {
  animation-name: mui-auto-fill;
  animation-duration: 5000s;
}
label[data-shrink=false] + .MuiInputBase-formControl .MuiInputBase-input::-webkit-input-placeholder {
  opacity: 0 !important;
}
label[data-shrink=false] + .MuiInputBase-formControl .MuiInputBase-input::-moz-placeholder {
  opacity: 0 !important;
}
label[data-shrink=false] + .MuiInputBase-formControl .MuiInputBase-input:-ms-input-placeholder {
  opacity: 0 !important;
}
label[data-shrink=false] + .MuiInputBase-formControl .MuiInputBase-input::-ms-input-placeholder {
  opacity: 0 !important;
}
label[data-shrink=false] + .MuiInputBase-formControl .MuiInputBase-input:focus::-webkit-input-placeholder {
  opacity: 0.42;
}
label[data-shrink=false] + .MuiInputBase-formControl .MuiInputBase-input:focus::-moz-placeholder {
  opacity: 0.42;
}
label[data-shrink=false] + .MuiInputBase-formControl .MuiInputBase-input:focus:-ms-input-placeholder {
  opacity: 0.42;
}
label[data-shrink=false] + .MuiInputBase-formControl .MuiInputBase-input:focus::-ms-input-placeholder {
  opacity: 0.42;
}
.MuiInputBase-inputMarginDense {
  padding-top: 3px;
}
.MuiInputBase-inputMultiline {
  height: auto;
  resize: none;
  padding: 0;
}
.MuiInputBase-inputTypeSearch {
  -moz-appearance: textfield;
  -webkit-appearance: textfield;
}
</style><style data-jss="" data-meta="PrivateNotchedOutline">
.jss47 {
  top: -5px;
  left: 0;
  right: 0;
  bottom: 0;
  margin: 0;
  padding: 0 8px;
  overflow: hidden;
  position: absolute;
  border-style: solid;
  border-width: 1px;
  border-radius: inherit;
  pointer-events: none;
}
.jss48 {
  padding: 0;
  text-align: left;
  transition: width 150ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;
  line-height: 11px;
}
.jss49 {
  width: auto;
  height: 11px;
  display: block;
  padding: 0;
  font-size: 0.75em;
  max-width: 0.01px;
  text-align: left;
  transition: max-width 50ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;
  visibility: hidden;
}
.jss49 > span {
  display: inline-block;
  padding-left: 5px;
  padding-right: 5px;
}
.jss50 {
  max-width: 1000px;
  transition: max-width 100ms cubic-bezier(0.0, 0, 0.2, 1) 50ms;
}
</style><style data-jss="" data-meta="MuiOutlinedInput">
.MuiOutlinedInput-root {
  position: relative;
  border-radius: 4px;
}
.MuiOutlinedInput-root:hover .MuiOutlinedInput-notchedOutline {
  border-color: rgba(0, 0, 0, 0.87);
}
@media (hover: none) {
  .MuiOutlinedInput-root:hover .MuiOutlinedInput-notchedOutline {
    border-color: rgba(0, 0, 0, 0.23);
  }
}
.MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline {
  border-color: #3f51b5;
  border-width: 2px;
}
.MuiOutlinedInput-root.Mui-error .MuiOutlinedInput-notchedOutline {
  border-color: #f44336;
}
.MuiOutlinedInput-root.Mui-disabled .MuiOutlinedInput-notchedOutline {
  border-color: rgba(0, 0, 0, 0.26);
}
.MuiOutlinedInput-colorSecondary.Mui-focused .MuiOutlinedInput-notchedOutline {
  border-color: #f50057;
}
.MuiOutlinedInput-adornedStart {
  padding-left: 14px;
}
.MuiOutlinedInput-adornedEnd {
  padding-right: 14px;
}
.MuiOutlinedInput-multiline {
  padding: 18.5px 14px;
}
.MuiOutlinedInput-multiline.MuiOutlinedInput-marginDense {
  padding-top: 10.5px;
  padding-bottom: 10.5px;
}
.MuiOutlinedInput-notchedOutline {
  border-color: rgba(0, 0, 0, 0.23);
}
.MuiOutlinedInput-input {
  padding: 18.5px 14px;
}
.MuiOutlinedInput-input:-webkit-autofill {
  border-radius: inherit;
}
.MuiOutlinedInput-inputMarginDense {
  padding-top: 10.5px;
  padding-bottom: 10.5px;
}
.MuiOutlinedInput-inputMultiline {
  padding: 0;
}
.MuiOutlinedInput-inputAdornedStart {
  padding-left: 0;
}
.MuiOutlinedInput-inputAdornedEnd {
  padding-right: 0;
}
</style><style data-jss="" data-meta="MuiFormControl">
.MuiFormControl-root {
  border: 0;
  margin: 0;
  display: inline-flex;
  padding: 0;
  position: relative;
  min-width: 0;
  flex-direction: column;
  vertical-align: top;
}
.MuiFormControl-marginNormal {
  margin-top: 16px;
  margin-bottom: 8px;
}
.MuiFormControl-marginDense {
  margin-top: 8px;
  margin-bottom: 4px;
}
.MuiFormControl-fullWidth {
  width: 100%;
}
</style><style data-jss="" data-meta="MuiTextField">

</style><style data-jss="" data-meta="TOC-articles">
.jss37 {
  padding-top: 40px;
}
.jss38 {
  text-decoration: none !important;
}
.jss38:hover {
  color: inherit !important;
}
.jss39 .tag {
  color: #394852;
  font-size: 1.4rem;
  font-weight: 550;
  font-variant: small-caps;
  text-transform: capitalize;
}
.jss39 .entity {
  transition: opacity 0.1s ease-in-out;
  margin-bottom: 15px;
}
.jss39 .title {
  display: flex;
}
.jss39 .intro {
  opacity: 0.85;
  font-size: 15px;
  margin-left: 30px;
}
.jss39 p {
  margin-bottom: 2px;
}
.jss39 .title:hover {
  opacity: 0.5;
}
.jss39 .title .bullet {
  width: 30px;
  display: flex;
  transform: translateY(1px);
  align-items: center;
  justify-content: center;
}
.jss39 .title .content {
  font-weight: 500;
}
.jss39 .title .bullet svg {
  font-size: 8px;
}
</style><style data-jss="" data-meta="makeStyles">
.jss28 {
  border: 1px solid #e5e7eb;
  outline: none;
  padding: 10px;
  border-left: none;
  border-radius: 80px;
  background-color: #F3F3F3;
}
</style><style data-jss="" data-meta="makeStyles">
.jss23 .tags {
  display: flex;
  justify-content: flex-end;
}
.jss23 p {
  margin-bottom: 0;
}
.jss23 .info {
  padding: 10px;
}
.jss23 .info:hover {
  background-color: rgba(220,220,220);
}
.jss23 .tags div {
  display: flex;
  margin-bottom: 6px;
  justify-content: flex-end;
}
.jss23 .tags div:not(.tags-container) {
  height: 21px;
}
.jss24 {
  display: flex;
}
@media (max-width: 768px) {
  .jss24 {
    align-items: flex-start !important;
    flex-direction: column !important;
  }
}
.jss25 {
  width: 144px;
}
@media (max-width: 768px) {
  .jss25 {
    width: 100% !important;
    margin-bottom: 8px !important;
  }
}
.jss26 {
  flex: 1;
  border-left: 4px solid #3b629126;
  padding-left: 20px;
}
@media (max-width: 768px) {
  .jss26 {
    width: 100%;
    border-top: 2px solid #3b629126 !important;
    border-left: none !important;
    padding-top: 8px !important;
    padding-left: 0 !important;
  }
}
@media (max-width: 991px) {
  .jss27 {
    border: 2px solid #9ca3af !important;
    box-shadow: none !important;
  }
}
@media (max-width: 768px) {
  .jss27 {
    max-height: calc(100vh - 200px) !important;
  }
}
</style><style data-jss="" data-meta="my-blog">
.jss2 {
  display: flex;
}
.jss2 button {
  width: 140px;
  border: 1px solid #31343a;
  opacity: 0.5;
  padding: 3px 14px;
  font-size: 14px;
  transition: opacity 0.1s ease-in-out;
  font-weight: 500;
  font-variant: small-caps;
  letter-spacing: unset;
  text-transform: none;
}
.jss2 button.active {
  color: white;
  opacity: 1;
  background: #3b62918c;
  border-color: transparent;
}
.jss2 button:hover {
  opacity: 0.87;
}
</style><style data-emotion="css" data-s=""></style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><script type="text/javascript" charset="utf8" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head><body><div id="MathJax_Message" style="display: none;"></div><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="App"><div class="main" id="background-animated" style="background-repeat: no-repeat; background-size: cover; position: relative; z-index: 1;"><div class="jss1" style="height: 100vh; overflow-y: hidden;"><div class="site-top-menu" style="height: 40px;"><div class="container"><div class="button-row"><a href="/"><button class="MuiButtonBase-root MuiButton-root MuiButton-text menu-button" tabindex="0" type="button"><span class="MuiButton-label"><div class="title-container">About Me</div></span><span class="MuiTouchRipple-root"></span></button></a><a href="/portfolio"><button class="MuiButtonBase-root MuiButton-root MuiButton-text menu-button" tabindex="0" type="button"><span class="MuiButton-label"><div class="title-container">Portfolio</div></span><span class="MuiTouchRipple-root"></span></button></a><a href="/blog"><button class="MuiButtonBase-root MuiButton-root MuiButton-text menu-button active" tabindex="0" type="button"><span class="MuiButton-label"><div class="title-container">Blog</div></span><span class="MuiTouchRipple-root"></span></button></a><a href="/artworks"><button class="MuiButtonBase-root MuiButton-root MuiButton-text menu-button" tabindex="0" type="button"><span class="MuiButton-label"><div class="title-container">Artworks</div></span><span class="MuiTouchRipple-root"></span></button></a><a href="/math-material"><button class="MuiButtonBase-root MuiButton-root MuiButton-text menu-button" tabindex="0" type="button"><span class="MuiButton-label"><div class="title-container">Math Material</div></span><span class="MuiTouchRipple-root"></span></button></a></div></div></div><div class="os-host os-host-foreign os-theme-dark os-host-resize-disabled os-host-scrollbar-horizontal-hidden main-content os-host-overflow os-host-overflow-y os-host-transition" id="top-overlayscroll-container" style="height: calc(100vh - 40px); width: 100%; overflow: hidden;"><div class="os-resize-observer-host observed"><div class="os-resize-observer" style="left: 0px; right: auto;"></div></div><div class="os-size-auto-observer observed" style="height: calc(100% + 1px); float: left;"><div class="os-resize-observer"></div></div><div class="os-content-glue" style="margin: 0px; width: 799px; height: 559px;"></div><div class="os-padding"><div class="os-viewport os-viewport-native-scrollbars-invisible os-viewport-native-scrollbars-overlaid" style="overflow-y: scroll;"><div class="os-content" style="padding: 0px; height: 100%; width: 100%;"><div class="total-container container"><div class="right" style="padding-left: 0px;"><div class="top-spacer" style="height: 40px; width: 5px; min-height: 40px; user-select: none; display: block;"></div><div class="blog"><div class="scroll-top-meter" style="position: fixed; right: 60px; bottom: 60px; z-index: 2; background-color: rgba(0, 0, 0, 0.5); color: white; padding: 5px 6px; border-radius: 3px; font-size: 0.8rem; user-select: none; width: 55px; height: 30px;"><div style="display: flex; justify-content: center; transform: scale(1.5, 0.75); margin-top: -9px; margin-bottom: -10px; opacity: 0.2;"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></svg></div><div style="display: flex; justify-content: center;">0%</div><button class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" type="button" style="position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; min-width: 0px;"><span class="MuiButton-label"></span><span class="MuiTouchRipple-root"></span></button></div><div class="message-block-container" style="opacity: 1; transition: opacity 225ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;"><div class="title-row"><div class="title"><div><p>YOLOv3 Deep Dive</p></div></div></div><div class="MuiCollapse-container MuiCollapse-entered" style="min-height: 0px;"><div class="MuiCollapse-wrapper"><div class="MuiCollapse-wrapperInner"><div style="background: inherit;"><div style="display: flex;"><div class="box" style="border-top-left-radius: 0px; border-top-right-radius: 0px;"><div class="message-block"><div class="search-wrapper"><div style="position: relative;"><div style="display: flex;"><div style="max-height: 35px; padding: 22px; display: flex; justify-content: center; align-items: center; background-color: rgb(243, 243, 243); border-top-left-radius: 80px; border-top: 1px solid rgb(229, 231, 235); border-right: none; border-bottom: 1px solid rgb(229, 231, 235); border-left: 1px solid rgb(229, 231, 235); border-image: initial; border-bottom-left-radius: 80px;"> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path></svg> </div><input placeholder="Tag, title or content" class="jss28" style="flex: 1 1 0%; border-top-left-radius: 0px; border-bottom-left-radius: 0px;"></div></div></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div hidden=""><div class="toc-wrapper"><div style="margin-top: 10px; margin-bottom: 40px; opacity: 0.7;"><div><blockquote>
<p><strong>Remark.</strong> Unless specified otherwise our <code>serverless</code> framework will be kept at <code>3.38.0</code>.</p>
</blockquote></div></div><div class="toc-home"><div data-virtuoso-scroller="true" style="position: relative; width: 100%; height: 59436px;"><div data-viewport-type="window" style="width: 100%; height: 100%; position: absolute; top: 0px;"><div data-test-id="virtuoso-item-list" style="box-sizing: border-box; padding-top: 0px; padding-bottom: 56160px; margin-top: 0px;"><div data-index="0" data-known-size="156" data-item-index="0" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Convenient-BottomSheet-Trigger-in-React-Native"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-09-21-25-07.png" alt="Convenient `BottomSheet` Trigger in React-Native" style="transform: translate(-3px, -6px) scale(1.3); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Convenient <code>BottomSheet</code> Trigger in React-Native</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>October 17,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss58 tags-container"><div><div><p><code>React-Native</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>Record a customized component for open a bottomsheet conveniently.</p></div></div></div></div></a></div></div></div><div data-index="1" data-known-size="156" data-item-index="1" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Prisma-with-SQLite-for-GUI-Application-in-Rust"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-04-19-53-51.png" alt="Prisma with SQLite for GUI Application in Rust" style="transform: translate(1px, 44px) scale(1.9); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Prisma with SQLite for GUI Application in Rust</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>October 14,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss60 tags-container"><div><div><p><code>Prisma</code></p></div></div><div><div><p><code>Rust</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>Record prisma setup for GUI application.</p></div></div></div></div></a></div></div></div><div data-index="2" data-known-size="156" data-item-index="2" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Iced-First-Trial-to-GUI-Application-in-Rust"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-14-02-25-45.png" alt="Iced: First Trial to GUI Application in Rust" style="transform: translate(0px, 4px) scale(1.3); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Iced: First Trial to GUI Application in Rust</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>October 13,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss63 tags-container"><div><div><p><code>Iced</code></p></div></div><div><div><p><code>Rust</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>We introduce the message system in iced.</p></div></div></div></div></a></div></div></div><div data-index="3" data-known-size="156" data-item-index="3" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Open-Draw-io-by-Clicking-a-Redirect-HTML"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-05-18-33-42.png" alt="Open Draw.io by Clicking a &quot;Redirect&quot; HTML" style="transform: translate(0px, 11px) scale(1.3); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Open Draw.io by Clicking a "Redirect" HTML</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>October 12,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss66 tags-container"><div><div><p><code>Draw.io</code></p></div></div><div><div><p><code>Html</code></p></div></div><div><div><p><code>System-Design</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>Record a simple file</p></div></div></div></div></a></div></div></div><div data-index="4" data-known-size="156" data-item-index="4" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Temporary-Values-get-Killed-After-the-end-of-a-Statement"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-04-19-53-51.png" alt="Temporary Values get Killed After the end of a Statement" style="transform: translate(1px, 44px) scale(1.9); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Temporary Values get Killed After the end of a Statement</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>October 11,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss70 tags-container"><div><div><p><code>Rust</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>Study temporary value</p></div></div></div></div></a></div></div></div><div data-index="5" data-known-size="156" data-item-index="5" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/References-don-t-Track-Ownership-Changes"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-04-19-53-51.png" alt="References don't Track Ownership Changes" style="transform: translate(1px, 44px) scale(1.9); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>References don't Track Ownership Changes</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>October 11,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss72 tags-container"><div><div><p><code>Rust</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>Study owndership in rust</p></div></div></div></div></a></div></div></div><div data-index="6" data-known-size="156" data-item-index="6" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Implement-ECDSA-for-Transaction-Verification-in-a-Blockchain"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-09-05-22-00.png" alt="Implement ECDSA for Transaction Verification in a Blockchain" style="transform: translate(0px, -9px) scale(1.3); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Implement ECDSA for Transaction Verification in a Blockchain</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>October 8,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss74 tags-container"><div><div><p><code>Blockchain</code></p></div></div><div><div><p><code>Elliptic-Curve</code></p></div></div><div><div><p><code>Rust</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>Study verificaiton mechanism in a blockchain system.</p></div></div></div></div></a></div></div></div><div data-index="7" data-known-size="156" data-item-index="7" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Rust-Fundamentals"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-04-19-53-51.png" alt="Rust Fundamentals" style="transform: translate(1px, 44px) scale(1.9); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Rust Fundamentals</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>September 30,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss78 tags-container"><div><div><p><code>Rust</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>We study basic structure of a rust project</p></div></div></div></div></a></div></div></div><div data-index="8" data-known-size="156" data-item-index="8" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Event-Storming-via-PUML-Improved-"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-09-29-09-17-15.png" alt="Event Storming via PUML (Improved)" style="transform: translate(42px, 84px) scale(3.5); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Event Storming via PUML (Improved)</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>September 28,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss80 tags-container"><div><div><p><code>DDD</code></p></div></div><div><div><p><code>Puml</code></p></div></div><div><div><p><code>System-Design</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>We improved the flow of using <code>puml</code> by defining custom functions and procedures.</p></div></div></div></div></a></div></div></div><div data-index="9" data-known-size="156" data-item-index="9" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/FastAPI-and-SqlAlchemy-ORM-in-Python"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-04-20-03-51.png" alt="FastAPI and SqlAlchemy ORM in Python" style="transform: translate(7px, 21px) scale(1.5); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>FastAPI and SqlAlchemy ORM in Python</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>September 26,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss85 tags-container"><div><div><p><code>Fastapi</code></p></div></div><div><div><p><code>Orm</code></p></div></div><div><div><p><code>Python</code></p></div></div><div><div><p><code>Sql</code></p></div></div><div><div><p><code>Sqlalchemy</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>We introduce ORM and basic web framework for python backend.</p></div></div></div></div></a></div></div></div><div data-index="10" data-known-size="156" data-item-index="10" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Create-a-Paging-API-in-Spring-Boot"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-05-04-35-31.png" alt="Create a Paging API in Spring Boot" style="transform: translate(0px, 0px) scale(1.2); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Create a Paging API in Spring Boot</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>September 24,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss91 tags-container"><div><div><p><code>Springboot</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>Record the detail for how to create a paging API easily by using spring's default repository.</p></div></div></div></div></a></div></div></div><div data-index="11" data-known-size="156" data-item-index="11" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Drawing-Fractal-Mandelbrot-Set-in-Rust"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-09-23-18-47-14.png" alt="Drawing Fractal (Mandelbrot Set) in Rust" style="transform: translate(0px, 11px) scale(1.3); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Drawing Fractal (Mandelbrot Set) in Rust</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>September 23,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss93 tags-container"><div><div><p><code>Math</code></p></div></div><div><div><p><code>Rust</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>Practice the syntax of rust by drawing fractal derived from simple mathematics.</p></div></div></div></div></a></div></div></div><div data-index="12" data-known-size="156" data-item-index="12" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Problem-of-SQL-Based-Nodejs-Backend-Should-we-use-Query-Builder-"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-04-21-01-28.png" alt="Problem of SQL Based Nodejs Backend, Should we use Query Builder?" style="transform: translate(25px, 15px) scale(1.4); transform-origin: center center;"></div></div><div class="toc-card-title-section no-intro"><div class="toc-card-title"><div><p>Problem of SQL Based Nodejs Backend, Should we use Query Builder?</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>September 17,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss96 tags-container"><div><div><p><code>Nodejs</code></p></div></div><div><div><p><code>Sql</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"></div></div></a></div></div></div><div data-index="13" data-known-size="156" data-item-index="13" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Problems-in-Controller-Service-Repository-That-are-Solvable-by-Tactical-Design-in-DDD-Domain-Driven-Design-"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-04-21-29-15.png" alt="Problems in Controller-Service-Repository That are Solvable by Tactical Design in DDD (Domain Driven Design)" style="transform: translate(0px, 0px) scale(1.3); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Problems in Controller-Service-Repository That are Solvable by Tactical Design in DDD (Domain Driven Design)</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>September 16,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss99 tags-container"><div><div><p><code>DDD</code></p></div></div><div><div><p><code>Kotlin</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>Traditional controller-service-repository is known as the most easiest architecture in backend development, however,  it comes with a cost.</p></div></div></div></div></a></div></div></div><div data-index="14" data-known-size="156" data-item-index="14" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Performance-Boost-Batch-Insert-in-Spring-Boot-with-Relations"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-05-17-07-24.png" alt="Performance Boost: Batch Insert in Spring Boot with Relations" style="transform: translate(-6px, 12px) scale(1.4); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Performance Boost: Batch Insert in Spring Boot with Relations</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>September 14,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss102 tags-container"><div><div><p><code>Kotlin</code></p></div></div><div><div><p><code>Springboot</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>We introduce a utility class that generate batch insertion SQL in the signature of <code>batchInsert(entities: List&lt;Entity&gt;): List&lt;Entity&gt;</code>.</p></div></div></div></div></a></div></div></div><div data-index="15" data-known-size="156" data-item-index="15" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Use-Bytecode-Enhancement-to-Solve-the-Problem-that-JoinColumn-and-OneToOne-Cannot-be-Truely-Lazy"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-04-20-54-38.png" alt="Use Bytecode Enhancement to Solve the Problem that @JoinColumn and @OneToOne Cannot be Truely Lazy" style="transform: translate(0px, 12px) scale(1.4); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Use Bytecode Enhancement to Solve the Problem that @JoinColumn and @OneToOne Cannot be Truely Lazy</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>September 11,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss106 tags-container"><div><div><p><code>Kotlin</code></p></div></div><div><div><p><code>Springboot</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>An <code>application.yml</code> config to turn on bytecode enhancement in order to prevent @JoinColumn or @OneToOne annotated column from being always eagerly loading.</p></div></div></div></div></a></div></div></div><div data-index="16" data-known-size="156" data-item-index="16" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/New-Side-Project-using-DDD-was-Added-to-Portfolio-"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-04-22-29-29.png" alt="New Side Project using DDD was Added to Portfolio!" style="transform: translate(15px, 0px) scale(1.2); transform-origin: center center;"></div></div><div class="toc-card-title-section no-intro"><div class="toc-card-title"><div><p>New Side Project using DDD was Added to Portfolio!</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>September 8,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss110 tags-container"><div><div><p><code>DDD</code></p></div></div><div><div><p><code>Kotlin</code></p></div></div><div><div><p><code>Springboot</code></p></div></div><div><div><p><code>System-Design</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"></div></div></a></div></div></div><div data-index="17" data-known-size="156" data-item-index="17" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/-react-dev-inspector-an-Alternative-to-click-to-react-component-"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-05-00-28-31.png" alt="`react-dev-inspector`, an Alternative to `click-to-react-component`" style="transform: translate(0px, -15px) scale(0.9); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p><code>react-dev-inspector</code>, an Alternative to <code>click-to-react-component</code></p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>September 4,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss117 tags-container"><div><div><p><code>React</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>Inspect react component by clicking</p></div></div></div></div></a></div></div></div><div data-index="18" data-known-size="156" data-item-index="18" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Links-to-Lucid-React-Resources"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-05-00-28-31.png" alt="Links to Lucid-React Resources" style="transform: translate(0px, -15px) scale(0.9); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Links to Lucid-React Resources</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>September 2,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss119 tags-container"><div><div><p><code>React</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>A replacement of react-icons as the styles of icons are much more consistent</p></div></div></div></div></a></div></div></div><div data-index="19" data-known-size="156" data-item-index="19" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Spring-Data-MongoDB"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-04-20-54-38.png" alt="Spring Data MongoDB" style="transform: translate(0px, 12px) scale(1.4); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Spring Data MongoDB</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>August 28,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss121 tags-container"><div><div><p><code>Kotlin</code></p></div></div><div><div><p><code>Springboot</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>Suppose that we need to handle mongoDB using kotlin due to whatever strange reason, let's define simple repository and caveats that we may encounter due to extra-ordinary flexibility in  schema of MongoDB.</p></div></div></div></div></a></div></div></div><div data-index="20" data-known-size="156" data-item-index="20" style="overflow-anchor: none;"><div class="toc-card-wrapper"><div class="toc-card toc-card-horizontal"><a class="jss38 toc-card-link" href="/blog/article/Multithreading-with-Semaphore"><div class="toc-card-image-container"><div class="toc-card-image"><img src="/assets/img/2025-10-04-23-58-07.png" alt="Multithreading with Semaphore" style="transform: translate(0px, 5px) scale(1); transform-origin: center center;"></div></div><div class="toc-card-title-section "><div class="toc-card-title"><div><p>Multithreading with Semaphore</p></div></div><div class="toc-card-date-inline"><div class="toc-card-date-section"><div class="toc-card-date-main"><span>August 27,</span><span>2025</span></div></div><div class="toc-card-tags"><div class="jss57 jss124 tags-container"><div><div><p><code>Kotlin</code></p></div></div><div><div><p><code>Springboot</code></p></div></div></div></div></div></div><div class="toc-card-content-area"><div class="toc-card-content"><div class="toc-card-intro"><div><p>In the past we have studied how to do limited number of concurrent tasks via buffered channels, an approach inspired from golang. This time we make use of native API of Semaphore to achieve the same goal.</p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div class="articles tech-blog" style="position: relative;"><div class="articles-container"><div style="display: flex; justify-content: center; width: 100%; margin: 0px;"><div class="content jss41"><div style="position: absolute; height: 100%;"><div class="os-host os-host-foreign os-theme-dark os-host-resize-disabled os-host-scrollbar-vertical-hidden jss45 os-host-scrollbar-horizontal-hidden" id="floating-toc"><div class="os-resize-observer-host observed"><div class="os-resize-observer" style="left: 0px; right: auto;"></div></div><div class="os-size-auto-observer observed" style="height: calc(100% + 1px); float: left;"><div class="os-resize-observer"></div></div><div class="os-content-glue" style="margin: 0px -20px -20px; height: 432px; width: 357px;"></div><div class="os-padding"><div class="os-viewport os-viewport-native-scrollbars-invisible os-viewport-native-scrollbars-overlaid" style=""><div class="os-content" style="padding: 0px 20px 20px; height: auto; width: 100%;"><div class="content-row"><h5 style="margin-top: 0px;"> Contents </h5><div style="height: 10px; width: 5px; min-height: 10px; user-select: none; display: block;"></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1); margin-top: -12px;"></div><p></p></div><div class="TOC-heading MuiBox-root css-1dl8pc3"><ul><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">1.</span><a href="#1.-about-this-article" class="toc-link" style="color: inherit; justify-self: start;">About this Article</a></div></li><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">2.</span><a href="#2.-dataset::{-parse_annotation,-bbox_iou-}" class="toc-link" style="color: inherit; justify-self: start;">dataset::{ parse_annotation, bbox_iou }</a></div></li><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">3.</span><a href="#3.-model-structure-of-yolov3" class="toc-link" style="color: inherit; justify-self: start;">Model Structure of YOLOv3</a></div></li><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">4.</span><a href="#4.-yolov3::{-yolov3,-decode-}" class="toc-link" style="color: inherit; justify-self: start;">yolov3::{ YOLOv3, decode }</a></div></li><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">5.</span><a href="#5.-yolov3::{-compute_loss-}" class="toc-link" style="color: inherit; justify-self: start;">yolov3::{ compute_loss }</a></div></li><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">6.</span><a href="#6.-training" class="toc-link" style="color: inherit; justify-self: start;">Training</a></div><ul><li data-level="6"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 58px 1fr; gap: 6px 6px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 0.2;">1.</span><a href="#1.-recap-of-customized-training-loop-with-tf.gradienttape" class="toc-link" style="color: inherit; justify-self: start;">Recap of Customized Training Loop with tf.GradientTape</a></div></li><li data-level="6"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 58px 1fr; gap: 6px 6px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 0.2;">2.</span><a href="#2.-start-training" class="toc-link" style="color: inherit; justify-self: start;">Start Training</a></div></li></ul></li><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">7.</span><a href="#7.-reference" class="toc-link" style="color: inherit; justify-self: start;">Reference</a></div></li></ul></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div></div></div></div><div class="os-scrollbar os-scrollbar-horizontal os-scrollbar-auto-hidden os-scrollbar-unusable"><div class="os-scrollbar-track os-scrollbar-track-off"><div class="os-scrollbar-handle" style="width: 100%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar os-scrollbar-vertical os-scrollbar-unusable os-scrollbar-auto-hidden"><div class="os-scrollbar-track os-scrollbar-track-off"><div class="os-scrollbar-handle" style="height: 100%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar-corner"></div></div></div><div class="article jss40"><div style="opacity: 1;"><div class="jss128 fade-in"><div> <button class="MuiButtonBase-root MuiButton-root MuiButton-text jss129" tabindex="0" type="button"><span class="MuiButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg> Return</span><span class="MuiTouchRipple-root"></span></button> </div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div><div class="first-row"><div class="date">April 22, 2022</div><div class="archive-button-row"><button class="MuiButtonBase-root MuiButton-root MuiButton-text jss46" tabindex="0" type="button"><span class="MuiButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"></path></svg>Print</span><span class="MuiTouchRipple-root"></span></button></div></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="display: flex; justify-content: space-between;"><div class="jss57 jss130 tags-container" style="margin-bottom: 20px;"><div><div><p><code>Deep-Learning</code></p></div></div></div><div class="MuiBox-root css-cbxemk"><button class="show-all-button"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg" style="margin-right: 6px; font-size: 1.1rem;"><path d="M483.2 790.3L861.4 412c1.7-1.7 2.5-4 2.3-6.3l-25.5-301.4c-.7-7.8-6.8-13.9-14.6-14.6L522.2 64.3c-2.3-.2-4.7.6-6.3 2.3L137.7 444.8a8.03 8.03 0 0 0 0 11.3l334.2 334.2c3.1 3.2 8.2 3.2 11.3 0zm62.6-651.7l224.6 19 19 224.6L477.5 694 233.9 450.5l311.9-311.9zm60.16 186.23a48 48 0 1 0 67.88-67.89 48 48 0 1 0-67.88 67.89zM889.7 539.8l-39.6-39.5a8.03 8.03 0 0 0-11.3 0l-362 361.3-237.6-237a8.03 8.03 0 0 0-11.3 0l-39.6 39.5a8.03 8.03 0 0 0 0 11.3l243.2 242.8 39.6 39.5c3.1 3.1 8.2 3.1 11.3 0l407.3-406.6c3.1-3.1 3.1-8.2 0-11.3z"></path></svg>Show All Tags</button></div></div><div class="os-host os-host-foreign os-theme-dark os-host-resize-disabled os-host-scrollbar-horizontal-hidden os-host-scrollbar-vertical-hidden" id=""><div class="os-resize-observer-host observed"><div class="os-resize-observer" style="left: 0px; right: auto;"></div></div><div class="os-size-auto-observer observed" style="height: calc(100% + 1px); float: left;"><div class="os-resize-observer"></div></div><div class="os-content-glue" style="margin: 0px; height: 364px; width: 539px;"></div><div class="os-padding"><div class="os-viewport os-viewport-native-scrollbars-invisible os-viewport-native-scrollbars-overlaid"><div class="os-content" style="padding: 0px; height: auto; width: 100%;"><div class="content-row"><h5 style="margin-top: 0px;"> Contents </h5><div style="height: 10px; width: 5px; min-height: 10px; user-select: none; display: block;"></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1); margin-top: -12px;"></div><p></p></div><div class="TOC-heading MuiBox-root css-1dl8pc3"><ul><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">1.</span><a href="#1.-about-this-article" class="toc-link" style="color: inherit; justify-self: start;">About this Article</a></div></li><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">2.</span><a href="#2.-dataset::{-parse_annotation,-bbox_iou-}" class="toc-link" style="color: inherit; justify-self: start;">dataset::{ parse_annotation, bbox_iou }</a></div></li><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">3.</span><a href="#3.-model-structure-of-yolov3" class="toc-link" style="color: inherit; justify-self: start;">Model Structure of YOLOv3</a></div></li><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">4.</span><a href="#4.-yolov3::{-yolov3,-decode-}" class="toc-link" style="color: inherit; justify-self: start;">yolov3::{ YOLOv3, decode }</a></div></li><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">5.</span><a href="#5.-yolov3::{-compute_loss-}" class="toc-link" style="color: inherit; justify-self: start;">yolov3::{ compute_loss }</a></div></li><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">6.</span><a href="#6.-training" class="toc-link" style="color: inherit; justify-self: start;">Training</a></div><ul><li data-level="6"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 58px 1fr; gap: 6px 6px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 0.2;">1.</span><a href="#1.-recap-of-customized-training-loop-with-tf.gradienttape" class="toc-link" style="color: inherit; justify-self: start;">Recap of Customized Training Loop with tf.GradientTape</a></div></li><li data-level="6"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 58px 1fr; gap: 6px 6px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 0.2;">2.</span><a href="#2.-start-training" class="toc-link" style="color: inherit; justify-self: start;">Start Training</a></div></li></ul></li><li data-level="4"><div style="cursor: default; text-decoration: none; color: inherit; display: grid; grid-template-columns: 40px 1fr; gap: 2px 2px; align-items: baseline;"><span style="font-weight: bold; justify-self: start; opacity: 1;">7.</span><a href="#7.-reference" class="toc-link" style="color: inherit; justify-self: start;">Reference</a></div></li></ul></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div></div></div></div><div class="os-scrollbar os-scrollbar-horizontal os-scrollbar-unusable os-scrollbar-auto-hidden"><div class="os-scrollbar-track os-scrollbar-track-off"><div class="os-scrollbar-handle" style="width: 100%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar os-scrollbar-vertical os-scrollbar-unusable os-scrollbar-auto-hidden"><div class="os-scrollbar-track os-scrollbar-track-off"><div class="os-scrollbar-handle" style="height: 100%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar-corner"></div></div><div class="cross-sensor"></div><div class="article-content"><div class="portfolio-article-font"><h4 id="1.-about-this-article" class="md-title"><div class="h4-left-block" style="height: 100%; display: inline;"></div><div class="MuiBox-root css-9hkc"><div style="flex: 1 1 0%; margin-right: 20px; display: flex; padding-bottom: 6px; align-items: center;"><div class="MuiBox-root css-o7pfz8" style="color: white; background-color: rgba(59, 98, 145, 0.55); padding: 3px 50px 6px 30px; border-top-left-radius: 10px; border-right: 10px solid rgb(215, 219, 232); margin-bottom: 0px;">1. About this Article</div></div></div></h4>
<p>The main objective of this article is to understand every function of YOLO-v3 implemented in tensorfow. We will understand the algorithm by examining the shape of every output.</p>
<p>The sections below are named by <code>module_name::{ function_1, function_2, ... }</code>, where <code>module_name</code> means we are studying the file <code>module_name.py</code>.</p>
<p>The link of <strong><em>source code</em></strong> are provided at the beginning of each of such sections.</p>
<h4 id="2.-dataset::{-parse_annotation,-bbox_iou-}" class="md-title"><div class="h4-left-block" style="height: 100%; display: inline;"></div><div class="MuiBox-root css-9hkc"><div style="flex: 1 1 0%; margin-right: 20px; display: flex; padding-bottom: 6px; align-items: center;"><div class="MuiBox-root css-o7pfz8" style="color: white; background-color: rgba(59, 98, 145, 0.55); padding: 3px 50px 6px 30px; border-top-left-radius: 10px; border-right: 10px solid rgb(215, 219, 232); margin-bottom: 0px;">2. dataset::{ parse_annotation, bbox_iou }</div></div></div></h4>
<p><a href="https://github.com/machingclee/deep-learning-study/blob/main/2021-02-15-yolo-trials/2021-02-15-YOLOV3-head-detection/core/dataset.py" target="_blank" rel="noopener noreferrer"><i>Source Code</i></a></p>
<pre><div class="jss33 jss136" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">parse_annotation</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> annotation</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span><span>    line </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> annotation</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>split</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span><span>    image_path </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> line</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">not</span><span> os</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>path</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>exists</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_path</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">raise</span><span> KeyError</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"%s does not exist ... "</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">%</span><span> imagparse_annotation
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>        e_path</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span><span>    image </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> cv2</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>imread</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_path</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>    bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>array</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(181, 118, 20);">list</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(181, 118, 20);">map</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(181, 118, 20);">int</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> box</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>split</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">','</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> box </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> line</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>data_aug</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span><span>        image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>random_horizontal_flip</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>        image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>random_crop</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span><span>        image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>random_translate</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span><span>    image </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> cv2</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>cvtColor</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> cv2</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>COLOR_BGR2RGB</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>    image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> utils</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>image_preporcess</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>train_input_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>train_input_size</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>    line </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> annotation</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>split</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>    image_path </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> line</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">not</span><span> os</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>path</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>exists</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_path</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">raise</span><span> KeyError</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"%s does not exist ... "</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">%</span><span> image_path</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span><span>    image </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> cv2</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>imread</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_path</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>    bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>array</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(181, 118, 20);">list</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(181, 118, 20);">map</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(181, 118, 20);">int</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> box</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>split</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">','</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> box </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> line</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>data_aug</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>        image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>random_horizontal_flip</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span><span>        image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>random_crop</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span><span>        image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>random_translate</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">30</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">31</span><span>    image </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> cv2</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>cvtColor</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> cv2</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>COLOR_BGR2RGB</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">32</span><span>    image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> utils</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>image_preporcess</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>train_input_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>train_input_size</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>copy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">33</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> image</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes</span></span></code></pre></div></pre>
<p>This part is straightforward. <span><script type="math/tex; ">\qed</script></span></p>
<pre><div class="jss33 jss137" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">bbox_iou</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span><span>    boxes1 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>array</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span><span>    boxes2 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>array</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>    boxes1_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>    boxes2_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>    boxes1 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concatenate</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>                             boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span><span>    boxes2 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concatenate</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span><span>                             boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>From the function we can deduce that <span><script type="math/tex; ">\texttt{box}=(c_x,c_y,\text{width},\text{height})</script></span>, therefore</p>
<div class="display-math"><div><script type="math/tex; mode=display">l
\texttt{boxes[...,:2]} -  \texttt{boxes[...,2:]}*0.5 = \texttt{[all upper-left corners]}</script></div></div>
<p>and</p>
<div class="display-math"><div><script type="math/tex; mode=display">    \texttt{boxes1[..., :2]} + \texttt{boxes1[..., 2:]} * 0.5=\texttt{[all lower-right corners]},</script></div></div>
<p>while concatenating <span><script type="math/tex; ">(2,)</script></span> np-array along the last axis simpliy means combing them into one <span><script type="math/tex; ">(4,)</script></span> np-array. Numerically in training <span><script type="math/tex; ">\texttt{boxes1}</script></span> and <span><script type="math/tex; ">\texttt{boxes2}</script></span> are like:</p>
<pre><div class="jss33 jss138" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="no-bg" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-none" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 1.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span>[[0.59375 3.78125 0.5     0.625  ]]</span></span></code></pre></div></pre>
<p>and</p>
<pre><div class="jss33 jss139" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="no-bg" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-none" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 1.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span>[[ 0.5      3.5      3.625    2.8125 ]
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 1.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span> [ 0.5      3.5      4.875    6.1875 ]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 1.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span> [ 0.5      3.5     11.65625 10.1875 ]]</span></code></pre></div></pre>
<p>respectively,</p>
<pre><div class="jss33 jss140" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>    left_up </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span><span>    right_down </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>minimum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>Think of the above as entrywise comparisons that give an array of maximum, which yields the coordinates of intersection rectangle for each fixed <span><script type="math/tex; ">\texttt{boxes1}</script></span> to boxes in <span><script type="math/tex; ">\texttt{boxes}</script></span>.</p>
<pre><div class="jss33 jss141" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span><span>    inter_section </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>right_down </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> left_up</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.0</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>The entries in <span><script type="math/tex; ">\texttt{inter_section}</script></span> are the <span><script type="math/tex; ">\textit{width}</script></span> and <span><script type="math/tex; ">\textit{height}</script></span> of the intersection, the (broadcasted) <span><script type="math/tex; ">\texttt{np.maximum}</script></span> is just a tricky way to handle empty intersection.</p>
<pre><div class="jss33 jss142" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span><span>    inter_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> inter_section</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> inter_section</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>    union_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> boxes1_area </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> boxes2_area </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> inter_area
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> inter_area </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> union_area</span></span></code></pre></div></pre>
<p><span><script type="math/tex; ">\qed</script></span></p>
<pre><div class="jss33 jss143" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">preprocess_true_boxes</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span></span></code></pre></div></pre>
<p>Here <span><script type="math/tex; ">\texttt{bboxes}</script></span> are the boxes from annotation file in which each line takes the form:</p>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{some/directory/hash.jpg 79,537,107,574,0 297,547,318,575,0}</script></div></div>
<pre><div class="jss33 jss144" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span><span>    label </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>zeros</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>train_output_sizes</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span><span>                       self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>train_output_sizes</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span><span>                       self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>anchor_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span><span>                       </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>num_classes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> i </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>    bboxes_xywh </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>zeros</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>max_bbox_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> _ </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>    bbox_count </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>zeros</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> bbox </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>        bbox_coor </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span><span>        bbox_class_ind </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>        onehot </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>zeros</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>num_classes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> dtype</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(181, 118, 20);">float</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span><span>        onehot</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>bbox_class_ind</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span><span>        uniform_distribution </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>full</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>num_classes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>num_classes</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span><span>        deta </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.01</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>        smooth_onehot </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> onehot </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> deta</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> deta </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> uniform_distribution
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span><span>        </span><span class="token token" style="color: rgb(124, 111, 100);"># bbox_xywh is ground truth</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>        bbox_xywh </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concatenate</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_coor</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> bbox_coor</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bbox_coor</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> bbox_coor</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>        </span><span class="token token" style="color: rgb(124, 111, 100);"># bbox_xywh_scaled is scaled ground truth relative to stride (13, 26, 52, as a unit)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span><span>        bbox_xywh_scaled </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> bbox_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>strides</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">]</span></span></code></pre></div></pre>
<p>Note that</p>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{bbox_xywh[np.newaxis, :]}</script></div></div>
<p>is of shape <span><script type="math/tex; ">(1, 4)</script></span> and</p>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{1/self.strides[:, np.newaxis]}</script></div></div>
<p>is of shape <span><script type="math/tex; ">(3, 1)</script></span>, their multiplication will be conducted by "broadcasting'' in numpy, which yields a <span><script type="math/tex; ">(3, 4)</script></span> dimensional numpy array. The product <span><script type="math/tex; ">\texttt{bbox_xywh_scaled}</script></span> consists of <span><script type="math/tex; ">(c_x,c_y,w,h)</script></span> which use "stride" as a unit, so 1 means "1 grid" (recall there are <span><script type="math/tex; ">13\times 13</script></span>, <span><script type="math/tex; ">26\times 26</script></span>, <span><script type="math/tex; ">52\times 52</script></span> grids predictions from Darknet backbone).</p>
<pre><div class="jss33 jss145" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span><span>        iou </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span><span>        exist_positive </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> i </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span><span>            anchors_xywh </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>zeros</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>anchor_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>            anchors_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>floor</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_xywh_scaled</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>astype</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>int32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>            anchors_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>anchors</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span></span></code></pre></div></pre>
<p><span><script type="math/tex; ">\texttt{anchors_xywh}</script></span> essentially moves centers of <span><script type="math/tex; ">\texttt{bbox_xywh_scaled}</script></span> to the middle of the grid where the original center lies in, then the anchor boxes' width and height are assigned, replacing the original width, height of <span><script type="math/tex; ">\texttt{bbox_xywh_scaled}</script></span>.</p>
<pre><div class="jss33 jss146" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span><span>            iou_scale </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>bbox_iou</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_xywh_scaled</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> anchors_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>The presence of <span><script type="math/tex; ">\texttt{np.newaxis}</script></span> is simply because multiplication between <span><script type="math/tex; ">(4,)</script></span> and <span><script type="math/tex; ">(3,4)</script></span> array does not make sense. The additional dimension expand <span><script type="math/tex; ">(4,)</script></span> array into <span><script type="math/tex; ">(1,4)</script></span> array, which is broadcasted and multiplied to <span><script type="math/tex; ">(3,4)</script></span> array to give another <span><script type="math/tex; ">(3,4)</script></span> array, and therefore, <span><script type="math/tex; ">\texttt{iou_scale.shape} = (3, )</script></span>.</p>
<pre><div class="jss33 jss147" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span><span>            iou</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>append</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>iou_scale</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">30</span><span>            iou_mask </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> iou_scale </span><span class="token token" style="color: rgb(124, 111, 100);">&gt;</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.3</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);"># a boolean list of length 3</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">31</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">32</span><span>            </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(181, 118, 20);">any</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>iou_mask</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);"># if one of them is True</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">33</span><span>                xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> yind </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>floor</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_xywh_scaled</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>astype</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>int32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">34</span><span>                label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> iou_mask</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">35</span><span>                label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> iou_mask</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox_xywh
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">36</span><span>                label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> iou_mask</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">37</span><span>                label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> iou_mask</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> smooth_onehot</span></span></code></pre></div></pre>
<p><span><script type="math/tex; ">\texttt{label[i]}</script></span> is initialized at the beginning which is of size</p>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{train_output_sizes}\times \texttt{train_output_sizes}\times 3\times 85</script></div></div>
<p>for each <span><script type="math/tex; ">\texttt{i}</script></span>, where <span><script type="math/tex; ">\texttt{train_output_sizes} = 13,26</script></span> or <span><script type="math/tex; ">52</script></span>.</p>
<pre><div class="jss33 jss148" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">38</span><span>                bbox_ind </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">int</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_count</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">%</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>max_bbox_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">39</span><span>                bboxes_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>bbox_ind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox_xywh</span></span></code></pre></div></pre>
<p><span><script type="math/tex; ">\texttt{bboxes_xywh}</script></span> is initialized (with zeros) at the beginning, <span><script type="math/tex; ">\texttt{bboxes_xywh.shape} = (3,150,4)</script></span>.</p>
<pre><div class="jss33 jss149" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">40</span><span>                bbox_count</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">41</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">42</span><span>                exist_positive </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">True</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">43</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">44</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">not</span><span> exist_positive</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">45</span><span>            best_anchor_ind </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>argmax</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>array</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>iou</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reshape</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);"># flatten and take max</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">46</span><span>            </span><span class="token token" style="color: rgb(124, 111, 100);"># best_detect belongs to which "i", namely, best "i"</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">47</span><span>            best_detect </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">int</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>best_anchor_ind </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>anchor_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">48</span><span>            </span><span class="token token" style="color: rgb(124, 111, 100);"># for this i, which index it is:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">49</span><span>            best_anchor </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">int</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>best_anchor_ind </span><span class="token token" style="color: rgb(124, 111, 100);">%</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>anchor_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">50</span><span>            </span><span class="token token" style="color: rgb(124, 111, 100);"># get the grid point in our 13x13, 26x26, 52x52 grid:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">51</span><span>            xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> yind </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>floor</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_xywh_scaled</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>astype</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>int32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">52</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">53</span><span>            label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> best_anchor</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">54</span><span>            label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> best_anchor</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox_xywh
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">55</span><span>            label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> best_anchor</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">56</span><span>            label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>yind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> xind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> best_anchor</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> smooth_onehot
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">57</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">58</span><span>            bbox_ind </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">int</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_count</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">%</span><span> self</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>max_bbox_per_scale</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">59</span><span>            bboxes_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>bbox_ind</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox_xywh
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">60</span><span>            </span><span class="token token" style="color: rgb(124, 111, 100);"># assign bbox_xywh into the list instead of append,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">61</span><span>            </span><span class="token token" style="color: rgb(124, 111, 100);"># this is to make sure there are at most 150 boxes within all 3 scales.</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">62</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">63</span><span>            bbox_count</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>best_detect</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">64</span><span>    label_sbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> label_mbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> label_lbbox </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> label
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">65</span><span>    sbboxes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> mbboxes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> lbboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bboxes_xywh
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">66</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> label_sbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> label_mbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> label_lbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> sbboxes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> mbboxes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> lbboxes</span></span></code></pre></div></pre>
<p>In short,</p>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{sbboxes, mbboxes, lbboxe}</script></div></div>
<p>are just ground truth bounding boxes (center, width and height), while</p>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{label_sbbox, label_mbbox, label_lbbox}</script></div></div>
<p>are ground truth bounding boxes with objectiveness and probabilities of <strong><em>each grid</em></strong>.
<span><script type="math/tex; ">\qed</script></span></p>
<h4 id="3.-model-structure-of-yolov3" class="md-title"><div class="h4-left-block" style="height: 100%; display: inline;"></div><div class="MuiBox-root css-9hkc"><div style="flex: 1 1 0%; margin-right: 20px; display: flex; padding-bottom: 6px; align-items: center;"><div class="MuiBox-root css-o7pfz8" style="color: white; background-color: rgba(59, 98, 145, 0.55); padding: 3px 50px 6px 30px; border-top-left-radius: 10px; border-right: 10px solid rgb(215, 219, 232); margin-bottom: 0px;">3. Model Structure of YOLOv3</div></div></div></h4>
<p>In <span><script type="math/tex; ">\texttt{darknet53}</script></span> after a bunch of residue modules we get 3 branches <span><script type="math/tex; ">\texttt{route_1}</script></span>, <span><script type="math/tex; ">\texttt{route_2}</script></span> and <span><script type="math/tex; ">\texttt{cov}</script></span>, where <code>route_1, route_2, conv = backbone.darknet53(input_layer)</code> in <code>YOLOv3</code> function. Moreover,</p>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{route_1.shape}= (-1,52,52,256)</script></div></div>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{route_2.shape} = (-1,26,26, 512)</script></div></div>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{conv.shape} =(-1,13,13,1024)</script></div></div>
<center>
<a href="/assets/tech/042-yolo_structure.png" target="_blank" rel="noopener noreferrer">
<img src="/assets/tech/042-yolo_structure.png" width="100%">
</a>
<p></p>
</center>
<p>Each branch then jumps into several stages of feature extractions, the whole process finally gives another 3 branches of undecoded/raw data of features, and they are endowed with the meaning of "grid-based detection" after reshaping into</p>
<div class="display-math"><div><script type="math/tex; mode=display">(-1,\texttt{output_size},\texttt{output_size}, 3, 85)</script></div></div>
<p>dimensional array in <code>decode</code> function (see <code>conv_output</code> in the body).</p>
<h4 id="4.-yolov3::{-yolov3,-decode-}" class="md-title"><div class="h4-left-block" style="height: 100%; display: inline;"></div><div class="MuiBox-root css-9hkc"><div style="flex: 1 1 0%; margin-right: 20px; display: flex; padding-bottom: 6px; align-items: center;"><div class="MuiBox-root css-o7pfz8" style="color: white; background-color: rgba(59, 98, 145, 0.55); padding: 3px 50px 6px 30px; border-top-left-radius: 10px; border-right: 10px solid rgb(215, 219, 232); margin-bottom: 0px;">4. yolov3::{ YOLOv3, decode }</div></div></div></h4>
<p><a href="https://github.com/machingclee/deep-learning-study/blob/main/2021-02-15-yolo-trials/2021-02-15-YOLOV3-head-detection/core/yolov3.py" target="_blank" rel="noopener noreferrer"><i>Source Code</i></a></p>
<pre><div class="jss33 jss156" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">YOLOv3</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>input_layer</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span><span>    route_1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> route_2</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> backbone</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>darknet53</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>input_layer</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>As <code>padding="same"</code> is being used along the chain of conv nets, there is no spatial dimension change.</p>
<pre><div class="jss33 jss158" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>    conv_lobj_branch </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>    conv_lbbox </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_lobj_branch</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1024</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>NUM_CLASS </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> activate</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bn</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>  </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>upsample</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> route_2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">768</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span><span>    conv_mobj_branch </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>    conv_mbbox </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_mobj_branch</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">512</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>NUM_CLASS </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> activate</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bn</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>upsample</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> route_1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">30</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">31</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">384</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">32</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">33</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">34</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">35</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">36</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">37</span><span>    conv_sobj_branch </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">128</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">38</span><span>    conv_sbbox </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> common</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>convolutional</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_sobj_branch</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">256</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>NUM_CLASS </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> activate</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bn</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">False</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">39</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">40</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>conv_sbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conv_mbbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conv_lbbox</span><span class="token token" style="color: rgb(124, 111, 100);">]</span></span></code></pre></div></pre>
<p><span><script type="math/tex; ">\qed</script></span></p>
<pre><div class="jss33 jss159" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">decode</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> i</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span><span>    </span><span class="token token triple-quoted-string" style="color: rgb(121, 116, 3);">"""
</span></span><span class="token token triple-quoted-string" style="color: rgb(121, 116, 3);"><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span>    return tensor of shape [batch_size, output_size, output_size, anchor_per_scale, 5 + num_classes]
</span><span class="token token triple-quoted-string" style="color: rgb(121, 116, 3);"><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span>            contains (x, y, w, h, score, probability)
</span><span class="token token triple-quoted-string" style="color: rgb(121, 116, 3);"><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span>    """</span></code></pre></div></pre>
<p><span><script type="math/tex; ">\texttt{conv_output}</script></span> is the output of <span><script type="math/tex; ">\texttt{YOLOv3}</script></span> (i.e., <span><script type="math/tex; ">\texttt{conv_sbbox}</script></span>, <span><script type="math/tex; ">\texttt{conv_mbbox}</script></span> or <span><script type="math/tex; ">\texttt{conv_lbbox}</script></span>).</p>
<pre><div class="jss33 jss160" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>    conv_shape       </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>shape</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>    batch_size       </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_shape</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span><span>    output_size      </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_shape</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>    conv_output </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reshape</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>batch_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> NUM_CLASS</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span><span>    conv_raw_dxdy </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>    conv_raw_dwdh </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span><span>    conv_raw_conf </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span><span>    conv_raw_prob </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_output</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>    y </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>tile</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> dtype</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>int32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> output_size</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span><span>    x </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>tile</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> dtype</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>int32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>For example, let's take <span><script type="math/tex; ">\texttt{output_size}=13</script></span>, then</p>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{y = np.tile(np.arange(13)[:, np.newaxis], [1, 13])}</script></div></div>
<p>and</p>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{x = np.tile(np.arange(13)[np.newaxis, :], [13, 1])}</script></div></div>
<p>are respectively:</p>
<pre><div class="jss33 jss161" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="no-bg" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-none" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span>[[ 0  0  0  0  0  0  0  0  0  0  0  0  0]   [[ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span> [ 1  1  1  1  1  1  1  1  1  1  1  1  1]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span> [ 2  2  2  2  2  2  2  2  2  2  2  2  2]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span> [ 3  3  3  3  3  3  3  3  3  3  3  3  3]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span> [ 4  4  4  4  4  4  4  4  4  4  4  4  4]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span> [ 5  5  5  5  5  5  5  5  5  5  5  5  5]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span> [ 6  6  6  6  6  6  6  6  6  6  6  6  6]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span> [ 7  7  7  7  7  7  7  7  7  7  7  7  7]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span> [ 8  8  8  8  8  8  8  8  8  8  8  8  8]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span> [ 9  9  9  9  9  9  9  9  9  9  9  9  9]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span> [10 10 10 10 10 10 10 10 10 10 10 10 10]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span> [11 11 11 11 11 11 11 11 11 11 11 11 11]    [ 0  1  2  3  4  5  6  7  8  9 10 11 12]
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span> [12 12 12 12 12 12 12 12 12 12 12 12 12]]   [ 0  1  2  3  4  5  6  7  8  9 10 11 12]]</span></code></pre></div></pre>
<p>For <span><script type="math/tex; ">\texttt{x}</script></span> and <span><script type="math/tex; ">\texttt{y}</script></span> we expand dimension again along the last axis (break every single element into a bracketed element) before concatenation:</p>
<pre><div class="jss33 jss162" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>    xy_grid </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>x</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> y</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>At this point, <span><script type="math/tex; ">\texttt{xy_grid}</script></span> is <span><script type="math/tex; ">(13,13,2)</script></span> dimensional.</p>
<pre><div class="jss33 jss163" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>    xy_grid </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>tile</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>xy_grid</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>batch_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span><span>    xy_grid </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>cast</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>xy_grid</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>float32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>Now <span><script type="math/tex; ">\texttt{xy_grid}</script></span> is <span><script type="math/tex; ">(\texttt{batch_size}, 13, 13, 3, 2)</script></span> dimensional. Recall that</p>
<center>
<img src="/assets/tech/042-decode_anchor.png" width="360">
</center>
<pre><div class="jss33 jss164" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span><span>    pred_xy </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>sigmoid</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_raw_dxdy</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> xy_grid</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> STRIDES</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span><span>    pred_wh </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>exp</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_raw_dwdh</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> ANCHORS</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> STRIDES</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>    pred_xywh </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>pred_xy</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> pred_wh</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>    pred_conf </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>sigmoid</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_raw_conf</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>    pred_prob </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>sigmoid</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv_raw_prob</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>pred_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> pred_conf</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> pred_prob</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>Bear in mind that decoded <span><script type="math/tex; ">\texttt{x}</script></span>, <span><script type="math/tex; ">\texttt{y}</script></span> in <span><script type="math/tex; ">\texttt{pred_xywh}</script></span> denote the center of prediction rectangle, as is the output of the function <span><script type="math/tex; ">\texttt{preprocess_true_boxes}</script></span>. <span><script type="math/tex; ">\qed</script></span></p>
<h4 id="5.-yolov3::{-compute_loss-}" class="md-title"><div class="h4-left-block" style="height: 100%; display: inline;"></div><div class="MuiBox-root css-9hkc"><div style="flex: 1 1 0%; margin-right: 20px; display: flex; padding-bottom: 6px; align-items: center;"><div class="MuiBox-root css-o7pfz8" style="color: white; background-color: rgba(59, 98, 145, 0.55); padding: 3px 50px 6px 30px; border-top-left-radius: 10px; border-right: 10px solid rgb(215, 219, 232); margin-bottom: 0px;">5. yolov3::{ compute_loss }</div></div></div></h4>
<p><a href="https://github.com/machingclee/deep-learning-study/blob/main/2021-02-15-yolo-trials/2021-02-15-YOLOV3-head-detection/core/yolov3.py" target="_blank" rel="noopener noreferrer"><i>Source Code</i></a></p>
<pre><div class="jss33 jss166" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">bbox_giou</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span><span>    boxes1 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span><span>                        boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span><span>    boxes2 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>                        boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span><span>    boxes1 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>minimum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>                        tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>    boxes2 </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>concat</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>minimum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span><span>                        tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>    boxes1_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span><span>    boxes2_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span><span>    left_up </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>    right_down </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>minimum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>    inter_section </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>right_down </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> left_up</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.0</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>    inter_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> inter_section</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> inter_section</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span><span>    union_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> boxes1_area </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> boxes2_area </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> inter_area
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span><span>    iou </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> inter_area </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> union_area
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>    enclose_left_up </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>minimum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span><span>    enclose_right_down </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>boxes1</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> boxes2</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>    enclose </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>maximum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>enclose_right_down </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> enclose_left_up</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.0</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>    enclose_area </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> enclose</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> enclose</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span><span>    giou </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> iou </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>enclose_area </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> union_area</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> enclose_area
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">30</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> giou</span></span></code></pre></div></pre>
<pre><div class="jss33 jss167" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">compute_loss</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>pred</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> label</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> i</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span><span>    conv_shape  </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>shape</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span><span>    batch_size  </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_shape</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span><span>    output_size </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv_shape</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>    input_size  </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> STRIDES</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> output_size
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>    conv </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reshape</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>batch_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> output_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> NUM_CLASS</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>    conv_raw_conf </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>    conv_raw_prob </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conv</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span><span>    pred_xywh     </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> pred</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>    pred_conf     </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> pred</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span><span>    label_xywh    </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span><span>    respond_bbox  </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);"># objectiveness</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span><span>    label_prob    </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> label</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">5</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span><span>    giou </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>expand_dims</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>bbox_giou</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>pred_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> label_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>    input_size </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>cast</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>input_size</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>float32</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span><span>    bbox_loss_scale </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2.0</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> label_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> label_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>input_size </span><span class="token token" style="color: rgb(124, 111, 100);">**</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span><span>    giou_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> respond_bbox </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> bbox_loss_scale </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> giou</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>Note that for two sets <span><script type="math/tex; ">U,V\in \mathcal C</script></span>, where <span><script type="math/tex; ">\mathcal C\in 2^{\mathbb R^2}</script></span>, the function <span><script type="math/tex; ">d(U,V) := 1-\text{giou}(U,V)</script></span> defines a metric, so <span><script type="math/tex; ">\texttt{giou_loss}</script></span> makes sense.</p>
<pre><div class="jss33 jss168" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>    iou </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> bbox_iou</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>pred_xywh</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>newaxis</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p><span><script type="math/tex; ">\texttt{bboxes}</script></span> are batched inside <code>Dataset("train").__next__</code> before passing into <span><script type="math/tex; ">\texttt{compute_loss}</script></span> (in a while loop until image count reaches batch size). Therefore <span><script type="math/tex; ">\texttt{bboxes.shape} = (16, 150, 4)</script></span>, where <span><script type="math/tex; ">150</script></span> is the maximal number of anchors (most of them are zeros due to initialization), so we see 3 <code>:</code>'s in <span><script type="math/tex; ">\texttt{bboxes}</script></span>.</p>
<p>Finally</p>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{pred_xywh.shape}=(16, 13,13,3,150,4)=\texttt{bboxes.shape}</script></div></div>
<p>and</p>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{iou.shape} = (16,13,13,3,150)</script></div></div>
<p>where computation gets rid of the last dimension. <span><script type="math/tex; ">\texttt{bboxes}</script></span> is copied to every grid for computation because from the original paper of YOLOv3:</p>
<blockquote>
<p>"the confidence prediction represents the IOU between the predicted box and any ground truth box"</p>
</blockquote>
<pre><div class="jss33 jss171" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span><span>    max_iou </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>expand_dims</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_max</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>iou</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>    respond_bgd </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1.0</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> respond_bbox</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>cast</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span> max_iou </span><span class="token token" style="color: rgb(124, 111, 100);">&lt;</span><span> IOU_LOSS_THRESH</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>float32 </span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>In the internet some people call <span><script type="math/tex; ">\texttt{IOU_LOSS_THRESH}</script></span> as <span><script type="math/tex; ">\texttt{ignore_thresh}</script></span>. <span><script type="math/tex; ">\texttt{respond_bgd}</script></span> determines whether to penalize a prediction</p>
<ul>
<li>that overlaps too few with ground truth anchors (i.e., detected wrong location) <strong><em>and</em></strong></li>
<li>that makes false positive error.</li>
</ul>
<pre><div class="jss33 jss172" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>    conf_focal </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(181, 118, 20);">pow</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>respond_bbox </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> pred_conf</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>The concept of focal loss with <span><script type="math/tex; ">\gamma = 2</script></span> was introduced in <strong>[TY]</strong>, which down-weights the loss contributed by well-classificed (high confidence) examples.</p>
<pre><div class="jss33 jss173" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span><span>    conf_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conf_focal </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span><span>    </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">30</span><span>        respond_bbox </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>nn</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>sigmoid_cross_entropy_with_logits</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>labels</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>respond_bbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> logits</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>conv_raw_conf</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">31</span><span>        </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">32</span><span>        respond_bgd </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>nn</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>sigmoid_cross_entropy_with_logits</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>labels</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>respond_bbox</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> logits</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>conv_raw_conf</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 2.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">33</span><span>    </span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<p>Where <span><script type="math/tex; ">\texttt{tf.nn.sigmoid_cross_entropy_with_logits(labels=z, logits=x)}</script></span> is</p>
<div class="display-math"><div><script type="math/tex; mode=display">\texttt{z} * -\log(\texttt{sigmoid}(\texttt{x})) + (1 - \texttt{z}) * -\log(1 - \texttt{sigmoid}(\texttt{x})),</script></div></div>
<p>therefore <span><script type="math/tex; ">\texttt{x}</script></span> has to be a raw prediction data (i.e., without signmoid).</p>
<pre><div class="jss33 jss174" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">34</span><span>    prob_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> respond_bbox </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>nn</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>sigmoid_cross_entropy_with_logits</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>labels</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>label_prob</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> logits</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>conv_raw_prob</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">35</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">36</span><span>    giou_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_mean</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_sum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>giou_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">37</span><span>    conf_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_mean</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_sum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>conf_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">38</span><span>    prob_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_mean</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>reduce_sum</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>prob_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> axis</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span class="token token" style="color: rgb(143, 63, 113);">4</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">39</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: inline-block; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">40</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">return</span><span> giou_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conf_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> prob_loss</span></span></code></pre></div></pre>
<p><span><script type="math/tex; ">\qed</script></span></p>
<h4 id="6.-training" class="md-title"><div class="h4-left-block" style="height: 100%; display: inline;"></div><div class="MuiBox-root css-9hkc"><div style="flex: 1 1 0%; margin-right: 20px; display: flex; padding-bottom: 6px; align-items: center;"><div class="MuiBox-root css-o7pfz8" style="color: white; background-color: rgba(59, 98, 145, 0.55); padding: 3px 50px 6px 30px; border-top-left-radius: 10px; border-right: 10px solid rgb(215, 219, 232); margin-bottom: 0px;">6. Training</div></div></div></h4>
<p><a href="https://github.com/machingclee/deep-learning-study/blob/main/2021-02-15-yolo-trials/2021-02-15-YOLOV3-head-detection/train.py" target="_blank" rel="noopener noreferrer"><i>Source Code</i></a></p>
<h6 id="1.-recap-of-customized-training-loop-with-tf.gradienttape" class="md-title"><div class="h6-left-block" style="height: 100%; display: inline;"></div><div class="MuiBox-root css-9hkc"><div style="display: flex; opacity: 0.35;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M64.9 96C67.1 84.4 73.7 76.2 86 70.6c13.8-6.2 34.8-8.9 61.2-4.5c8.8 1.4 36.1 7.1 44.1 9.3c17 4.8 34.7-5.1 39.5-22.2s-5.1-34.7-22.2-39.5c-11.1-3.1-41-9.2-50.9-10.8C123-2.7 88.3-.6 59.7 12.3C29.9 25.8 7.5 50.9 1.6 86.5c-.1 .5-.2 1.1-.2 1.6c-2.2 19.7 .3 37.9 8.1 54.1c7.7 16.1 19.4 28 32 36.9c.6 .5 1.3 .9 2 1.4C22.3 194.2 6.5 215.1 1.7 243c-.1 .6-.2 1.1-.2 1.7c-2.3 19.3 .4 37.1 8.4 53c7.9 15.6 19.8 27 32.3 35.5c22.4 15.2 51.9 24 75.4 31l0 0 3.7 1.1c27.2 8.2 46.9 14.6 59.4 23.8c5.5 4 8.2 7.6 9.5 10.9c1.3 3.2 2.6 8.6 .9 18.1c-1.7 10.1-7.7 18-20.7 23.5c-14 6-35.4 8.5-62 4.4c-12.8-2.1-35.1-9.7-54.1-16.2l0 0c-4.3-1.5-8.5-2.9-12.3-4.2C25.3 420 7.2 429.1 1.6 445.8s3.5 34.9 20.3 40.5c2.6 .8 5.7 1.9 9.2 3.1c18.6 6.3 48.5 16.6 67.3 19.6l0 0 .2 0c34.5 5.4 68.8 3.4 97.2-8.7c29.4-12.6 52.5-36.5 58.5-71.5c3.3-19.3 1.9-37.4-5-53.9c-6.3-15-16.4-26.4-27.6-35.2c16.5-13.9 28.5-33.2 32.6-58.2c3.2-19.8 1.9-38.3-4.8-55.1c-6.7-16.8-17.8-29.4-30.2-39c-22.8-17.6-53.6-27.4-77.7-35l-1.4-.5c-27.4-8.7-47.8-15.3-61.5-25c-6.1-4.4-9.5-8.5-11.4-12.4c-1.8-3.7-3.2-9.3-2.3-18.5zm76.7 208.5c-.2-.1-.4-.1-.6-.2l-1.4-.4c-27.4-8.2-47.9-14.5-61.7-23.8c-6.2-4.2-9.3-7.9-11-11.3c-1.5-3-2.9-7.7-2.1-15.7c1.9-9.7 7.9-17.3 20.5-22.7c14-6 35.4-8.5 62.1-4.3l16.4 2.6c6.3 2.9 11.7 6 16.2 9.5c5.5 4.2 8.4 8.2 10 12.2c1.6 4 2.8 10.4 1.1 20.9c-2.4 14.7-12.8 26.4-37.1 31l-12.4 2.3z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg" style="margin-right: 10px; margin-left: -7px;"><path d="M64.9 96C67.1 84.4 73.7 76.2 86 70.6c13.8-6.2 34.8-8.9 61.2-4.5c8.8 1.4 36.1 7.1 44.1 9.3c17 4.8 34.7-5.1 39.5-22.2s-5.1-34.7-22.2-39.5c-11.1-3.1-41-9.2-50.9-10.8C123-2.7 88.3-.6 59.7 12.3C29.9 25.8 7.5 50.9 1.6 86.5c-.1 .5-.2 1.1-.2 1.6c-2.2 19.7 .3 37.9 8.1 54.1c7.7 16.1 19.4 28 32 36.9c.6 .5 1.3 .9 2 1.4C22.3 194.2 6.5 215.1 1.7 243c-.1 .6-.2 1.1-.2 1.7c-2.3 19.3 .4 37.1 8.4 53c7.9 15.6 19.8 27 32.3 35.5c22.4 15.2 51.9 24 75.4 31l0 0 3.7 1.1c27.2 8.2 46.9 14.6 59.4 23.8c5.5 4 8.2 7.6 9.5 10.9c1.3 3.2 2.6 8.6 .9 18.1c-1.7 10.1-7.7 18-20.7 23.5c-14 6-35.4 8.5-62 4.4c-12.8-2.1-35.1-9.7-54.1-16.2l0 0c-4.3-1.5-8.5-2.9-12.3-4.2C25.3 420 7.2 429.1 1.6 445.8s3.5 34.9 20.3 40.5c2.6 .8 5.7 1.9 9.2 3.1c18.6 6.3 48.5 16.6 67.3 19.6l0 0 .2 0c34.5 5.4 68.8 3.4 97.2-8.7c29.4-12.6 52.5-36.5 58.5-71.5c3.3-19.3 1.9-37.4-5-53.9c-6.3-15-16.4-26.4-27.6-35.2c16.5-13.9 28.5-33.2 32.6-58.2c3.2-19.8 1.9-38.3-4.8-55.1c-6.7-16.8-17.8-29.4-30.2-39c-22.8-17.6-53.6-27.4-77.7-35l-1.4-.5c-27.4-8.7-47.8-15.3-61.5-25c-6.1-4.4-9.5-8.5-11.4-12.4c-1.8-3.7-3.2-9.3-2.3-18.5zm76.7 208.5c-.2-.1-.4-.1-.6-.2l-1.4-.4c-27.4-8.2-47.9-14.5-61.7-23.8c-6.2-4.2-9.3-7.9-11-11.3c-1.5-3-2.9-7.7-2.1-15.7c1.9-9.7 7.9-17.3 20.5-22.7c14-6 35.4-8.5 62.1-4.3l16.4 2.6c6.3 2.9 11.7 6 16.2 9.5c5.5 4.2 8.4 8.2 10 12.2c1.6 4 2.8 10.4 1.1 20.9c-2.4 14.7-12.8 26.4-37.1 31l-12.4 2.3z"></path></svg></div><div style="flex: 1 1 0%;">1. Recap of Customized Training Loop with tf.GradientTape</div></div></h6>
<p>Apart from predefined loss functions (such as <span><script type="math/tex; ">\texttt{categorical_crossentropy}</script></span> for classfication, <span><script type="math/tex; ">\texttt{mse}</script></span> for regression, etc), it is ocassional to come across non-standard loss functions from other repository with the use of <span><script type="math/tex; ">\texttt{tf.GradientTape}</script></span>.</p>
<p>Such implementation usually involves 4 components:</p>
<ul>
<li>
<p><strong>Component 1.</strong> The model <strong>architecture</strong></p>
</li>
<li>
<p><strong>Component 2.</strong> The <strong>loss function</strong> used when computing the model loss</p>
</li>
<li>
<p><strong>Component 3.</strong> The <strong>optimizer</strong> used to update the model weights</p>
</li>
<li>
<p><strong>Component 4.</strong> The <strong>step function</strong> that encapsulates the forward and backward pass of the network</p>
</li>
</ul>
<p>Now the code below is self-explanatory:</p>
<h6 id="2.-start-training" class="md-title"><div class="h6-left-block" style="height: 100%; display: inline;"></div><div class="MuiBox-root css-9hkc"><div style="display: flex; opacity: 0.35;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M64.9 96C67.1 84.4 73.7 76.2 86 70.6c13.8-6.2 34.8-8.9 61.2-4.5c8.8 1.4 36.1 7.1 44.1 9.3c17 4.8 34.7-5.1 39.5-22.2s-5.1-34.7-22.2-39.5c-11.1-3.1-41-9.2-50.9-10.8C123-2.7 88.3-.6 59.7 12.3C29.9 25.8 7.5 50.9 1.6 86.5c-.1 .5-.2 1.1-.2 1.6c-2.2 19.7 .3 37.9 8.1 54.1c7.7 16.1 19.4 28 32 36.9c.6 .5 1.3 .9 2 1.4C22.3 194.2 6.5 215.1 1.7 243c-.1 .6-.2 1.1-.2 1.7c-2.3 19.3 .4 37.1 8.4 53c7.9 15.6 19.8 27 32.3 35.5c22.4 15.2 51.9 24 75.4 31l0 0 3.7 1.1c27.2 8.2 46.9 14.6 59.4 23.8c5.5 4 8.2 7.6 9.5 10.9c1.3 3.2 2.6 8.6 .9 18.1c-1.7 10.1-7.7 18-20.7 23.5c-14 6-35.4 8.5-62 4.4c-12.8-2.1-35.1-9.7-54.1-16.2l0 0c-4.3-1.5-8.5-2.9-12.3-4.2C25.3 420 7.2 429.1 1.6 445.8s3.5 34.9 20.3 40.5c2.6 .8 5.7 1.9 9.2 3.1c18.6 6.3 48.5 16.6 67.3 19.6l0 0 .2 0c34.5 5.4 68.8 3.4 97.2-8.7c29.4-12.6 52.5-36.5 58.5-71.5c3.3-19.3 1.9-37.4-5-53.9c-6.3-15-16.4-26.4-27.6-35.2c16.5-13.9 28.5-33.2 32.6-58.2c3.2-19.8 1.9-38.3-4.8-55.1c-6.7-16.8-17.8-29.4-30.2-39c-22.8-17.6-53.6-27.4-77.7-35l-1.4-.5c-27.4-8.7-47.8-15.3-61.5-25c-6.1-4.4-9.5-8.5-11.4-12.4c-1.8-3.7-3.2-9.3-2.3-18.5zm76.7 208.5c-.2-.1-.4-.1-.6-.2l-1.4-.4c-27.4-8.2-47.9-14.5-61.7-23.8c-6.2-4.2-9.3-7.9-11-11.3c-1.5-3-2.9-7.7-2.1-15.7c1.9-9.7 7.9-17.3 20.5-22.7c14-6 35.4-8.5 62.1-4.3l16.4 2.6c6.3 2.9 11.7 6 16.2 9.5c5.5 4.2 8.4 8.2 10 12.2c1.6 4 2.8 10.4 1.1 20.9c-2.4 14.7-12.8 26.4-37.1 31l-12.4 2.3z"></path></svg><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg" style="margin-right: 10px; margin-left: -7px;"><path d="M64.9 96C67.1 84.4 73.7 76.2 86 70.6c13.8-6.2 34.8-8.9 61.2-4.5c8.8 1.4 36.1 7.1 44.1 9.3c17 4.8 34.7-5.1 39.5-22.2s-5.1-34.7-22.2-39.5c-11.1-3.1-41-9.2-50.9-10.8C123-2.7 88.3-.6 59.7 12.3C29.9 25.8 7.5 50.9 1.6 86.5c-.1 .5-.2 1.1-.2 1.6c-2.2 19.7 .3 37.9 8.1 54.1c7.7 16.1 19.4 28 32 36.9c.6 .5 1.3 .9 2 1.4C22.3 194.2 6.5 215.1 1.7 243c-.1 .6-.2 1.1-.2 1.7c-2.3 19.3 .4 37.1 8.4 53c7.9 15.6 19.8 27 32.3 35.5c22.4 15.2 51.9 24 75.4 31l0 0 3.7 1.1c27.2 8.2 46.9 14.6 59.4 23.8c5.5 4 8.2 7.6 9.5 10.9c1.3 3.2 2.6 8.6 .9 18.1c-1.7 10.1-7.7 18-20.7 23.5c-14 6-35.4 8.5-62 4.4c-12.8-2.1-35.1-9.7-54.1-16.2l0 0c-4.3-1.5-8.5-2.9-12.3-4.2C25.3 420 7.2 429.1 1.6 445.8s3.5 34.9 20.3 40.5c2.6 .8 5.7 1.9 9.2 3.1c18.6 6.3 48.5 16.6 67.3 19.6l0 0 .2 0c34.5 5.4 68.8 3.4 97.2-8.7c29.4-12.6 52.5-36.5 58.5-71.5c3.3-19.3 1.9-37.4-5-53.9c-6.3-15-16.4-26.4-27.6-35.2c16.5-13.9 28.5-33.2 32.6-58.2c3.2-19.8 1.9-38.3-4.8-55.1c-6.7-16.8-17.8-29.4-30.2-39c-22.8-17.6-53.6-27.4-77.7-35l-1.4-.5c-27.4-8.7-47.8-15.3-61.5-25c-6.1-4.4-9.5-8.5-11.4-12.4c-1.8-3.7-3.2-9.3-2.3-18.5zm76.7 208.5c-.2-.1-.4-.1-.6-.2l-1.4-.4c-27.4-8.2-47.9-14.5-61.7-23.8c-6.2-4.2-9.3-7.9-11-11.3c-1.5-3-2.9-7.7-2.1-15.7c1.9-9.7 7.9-17.3 20.5-22.7c14-6 35.4-8.5 62.1-4.3l16.4 2.6c6.3 2.9 11.7 6 16.2 9.5c5.5 4.2 8.4 8.2 10 12.2c1.6 4 2.8 10.4 1.1 20.9c-2.4 14.7-12.8 26.4-37.1 31l-12.4 2.3z"></path></svg></div><div style="flex: 1 1 0%;">2. Start Training</div></div></h6>
<pre><div class="jss33 jss176" style="position: relative;"><button style="position: absolute; top: 8px; right: 8px; padding: 0px 10px; background-color: rgb(250, 250, 250); color: rgb(55, 65, 81); border: 1px solid rgb(229, 229, 229); border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px 4px; font-size: 12px; font-weight: 500; transition: all 0.2s ease 0s; opacity: 0.7; z-index: 10;"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="14" width="14" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg><span>Copy</span></button><pre class="" style="color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; background: rgb(249, 245, 215);"><code class="language-python" style="white-space: pre; color: rgb(60, 56, 54); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, monospace; direction: ltr; text-align: left; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">1</span><span class="token token" style="color: rgb(157, 0, 6);">def</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">train_step</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_data</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> target</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> epoch</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">2</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">3</span><span>    </span><span class="token token" style="color: rgb(124, 111, 100);"># image_data = batch of images</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">4</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">5</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">with</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>GradientTape</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">as</span><span> tape</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">6</span><span>        pred_result </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> model</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_data</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> training</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span class="token token" style="color: rgb(157, 0, 6);">True</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">7</span><span>        giou_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> conf_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> prob_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">8</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">9</span><span>        </span><span class="token token" style="color: rgb(124, 111, 100);"># optimizing process</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">10</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> i </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">3</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">11</span><span>            conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> pred </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> pred_result</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> pred_result</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">12</span><span>            batch_label</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> batch_bboxes </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> target</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span>i</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">13</span><span>            loss_items </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> compute_loss</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>pred</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conv</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> batch_label</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> batch_bboxes</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> i</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">14</span><span>            giou_loss </span><span class="token token" style="color: rgb(124, 111, 100);">+=</span><span> loss_items</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">0</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">15</span><span>            conf_loss </span><span class="token token" style="color: rgb(124, 111, 100);">+=</span><span> loss_items</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">16</span><span>            prob_loss </span><span class="token token" style="color: rgb(124, 111, 100);">+=</span><span> loss_items</span><span class="token token" style="color: rgb(124, 111, 100);">[</span><span class="token token" style="color: rgb(143, 63, 113);">2</span><span class="token token" style="color: rgb(124, 111, 100);">]</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">17</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">18</span><span>        total_loss </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> giou_loss </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> conf_loss </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> prob_loss
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">19</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">20</span><span>        gradients </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> tape</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>gradient</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>total_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> model</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>trainable_variables</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">21</span><span>        optimizer</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>apply_gradients</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(181, 118, 20);">zip</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>gradients</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> model</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>trainable_variables</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">22</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">23</span><span>        </span><span class="token token" style="color: rgb(124, 111, 100);"># update learning rate</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">24</span><span>        global_steps</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>assign_add</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">25</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">if</span><span> global_steps </span><span class="token token" style="color: rgb(124, 111, 100);">&lt;</span><span> warmup_steps</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">26</span><span>            lr </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> global_steps </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> warmup_steps </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> cfg</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>TRAIN</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>LR_INIT
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">27</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">else</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">28</span><span>            lr </span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span> cfg</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>TRAIN</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>LR_END </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> </span><span class="token token" style="color: rgb(143, 63, 113);">0.5</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>cfg</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>TRAIN</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>LR_INIT </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> cfg</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>TRAIN</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>LR_END</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">29</span><span>                </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(143, 63, 113);">1</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">+</span><span> tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>cos</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>global_steps </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> warmup_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">/</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>total_steps </span><span class="token token" style="color: rgb(124, 111, 100);">-</span><span> warmup_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">*</span><span> np</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>pi</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">30</span><span>            </span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">31</span><span>        optimizer</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>lr</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>assign</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>lr</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>numpy</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">32</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">33</span><span>        </span><span class="token token" style="color: rgb(124, 111, 100);"># writing summary data</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">34</span><span>        </span><span class="token token" style="color: rgb(157, 0, 6);">with</span><span> writer</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>as_default</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">35</span><span>            tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>summary</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>scalar</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"lr"</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> optimizer</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>lr</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> step</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>global_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">36</span><span>            tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>summary</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>scalar</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"loss/total_loss"</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> total_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> step</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>global_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">37</span><span>            tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>summary</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>scalar</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"loss/giou_loss"</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> giou_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> step</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>global_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">38</span><span>            tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>summary</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>scalar</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"loss/conf_loss"</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> conf_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> step</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>global_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">39</span><span>            tf</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>summary</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>scalar</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"loss/prob_loss"</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> prob_loss</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> step</span><span class="token token" style="color: rgb(124, 111, 100);">=</span><span>global_steps</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">40</span><span>        writer</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>flush</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">41</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">42</span><span></span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> epoch </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">range</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>cfg</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>TRAIN</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>EPOCHS</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">43</span><span>    </span><span class="token token" style="color: rgb(157, 0, 6);">for</span><span> index</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> </span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_data</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> target</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span> </span><span class="token token" style="color: rgb(157, 0, 6);">in</span><span> </span><span class="token token" style="color: rgb(181, 118, 20);">enumerate</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>trainset</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">:</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">44</span><span>        train_step</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>image_data</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> target</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> epoch</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span>
</span></span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">45</span>
</span><span><span class="linenumber react-syntax-highlighter-line-number" style="display: none; min-width: 3.25em; padding-right: 1em; text-align: right; user-select: none; opacity: 0.3; color: rgb(124, 111, 100);">46</span><span>    model</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>save_weights</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span class="token token" style="color: rgb(121, 116, 3);">"./checkpoints/yolov3-{}-{}.h5"</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span class="token token" style="color: rgb(181, 118, 20);">format</span><span class="token token" style="color: rgb(124, 111, 100);">(</span><span>cfg</span><span class="token token" style="color: rgb(124, 111, 100);">.</span><span>WEIGHT_NAME_TO_SAVE</span><span class="token token" style="color: rgb(124, 111, 100);">,</span><span> epoch</span><span class="token token" style="color: rgb(124, 111, 100);">)</span><span class="token token" style="color: rgb(124, 111, 100);">)</span></span></code></pre></div></pre>
<h4 id="7.-reference" class="md-title"><div class="h4-left-block" style="height: 100%; display: inline;"></div><div class="MuiBox-root css-9hkc"><div style="flex: 1 1 0%; margin-right: 20px; display: flex; padding-bottom: 6px; align-items: center;"><div class="MuiBox-root css-o7pfz8" style="color: white; background-color: rgba(59, 98, 145, 0.55); padding: 3px 50px 6px 30px; border-top-left-radius: 10px; border-right: 10px solid rgb(215, 219, 232); margin-bottom: 0px;">7. Reference</div></div></div></h4>
<ul>
<li>
<p>YOLOv3 源码解析 1-5, <a href="https://blog.csdn.net/sxlsxl119/article/details/103028021" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/sxlsxl119/article/details/103028021</a></p>
</li>
<li>
<p>YOLOv3 算法的一点理解, <a href="https://yunyang1994.gitee.io/2018/12/28/YOLOv3/" target="_blank" rel="noopener noreferrer">https://yunyang1994.gitee.io/2018/12/28/YOLOv3/</a></p>
</li>
<li>
<p>Joseph Redmon, Ali Farhadi, <a href="https://arxiv.org/abs/1804.02767" target="_blank" rel="noopener noreferrer"> <i>YOLOv3: An Incremental Improvement </i></a></p>
</li>
<li>
<p><strong>[TY]</strong> Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He and Piotr Dollar, <a href="https://arxiv.org/pdf/1708.02002.pdf?fbclid=IwAR38T65chV0UNPhBDbAExH021_afC0L6o9PEztpBPBAzqY3dBR8vOGy2qwg" target="_blank" rel="noopener noreferrer"><i>Focal Loss for Dense Object Detection</i></a></p>
</li>
<li>
<p>Adrian Rosebrock, <a href="https://www.pyimagesearch.com/2020/03/23/using-tensorflow-and-gradienttape-to-train-a-keras-model/" target="_blank" rel="noopener noreferrer"><i>Using TensorFlow and GradientTape to train a Keras model</i></a></p>
</li>
</ul></div></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="height: 40px; width: 5px; min-height: 40px; user-select: none; display: block;"></div><div style="border-top: 3px solid rgba(0, 0, 0, 0.1);"></div><div style="height: 10px; width: 5px; min-height: 10px; user-select: none; display: block;"></div></div></div></div></div><div style="user-select: none;"></div><div class="prev-next-article-buttons-row"><div><button class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" type="button" title="WGAN and WGAN-GP"><span class="MuiButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg> WGAN and WGAN-GP</span><span class="MuiTouchRipple-root"></span></button></div><div><button class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" type="button" title="Different Kinds of Residue Blocks"><span class="MuiButton-label">Different Kinds of Residu ... <svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></span><span class="MuiTouchRipple-root"></span></button></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div></div></div></div></div></div><div class="os-scrollbar os-scrollbar-horizontal os-scrollbar-unusable"><div class="os-scrollbar-track os-scrollbar-track-off"><div class="os-scrollbar-handle" style="width: 100%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar os-scrollbar-vertical"><div class="os-scrollbar-track os-scrollbar-track-off"><div class="os-scrollbar-handle" style="height: 3.4398%; transform: translate(0px, 0px);"></div></div></div><div class="os-scrollbar-corner"></div></div></div></div><canvas class="vanta-canvas" width="400" height="300" style="position: absolute; z-index: 0; top: 0px; left: 0px; width: 800px; height: 600px;"></canvas></div></div><script>!function(e){function r(r){for(var n,i,a=r[0],c=r[1],l=r[2],s=0,p=[];s<a.length;s++)i=a[s],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(f&&f(r);p.length;)p.shift()();return u.push.apply(u,l||[]),t()}function t(){for(var e,r=0;r<u.length;r++){for(var t=u[r],n=!0,a=1;a<t.length;a++){var c=t[a];0!==o[c]&&(n=!1)}n&&(u.splice(r--,1),e=i(i.s=t[0]))}return e}var n={},o={1:0},u=[];function i(r){if(n[r])return n[r].exports;var t=n[r]={i:r,l:!1,exports:{}};return e[r].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.e=function(e){var r=[],t=o[e];if(0!==t)if(t)r.push(t[2]);else{var n=new Promise((function(r,n){t=o[e]=[r,n]}));r.push(t[2]=n);var u,a=document.createElement("script");a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=function(e){return i.p+"static/js/"+({}[e]||e)+"."+{3:"07bbf7e9",4:"c8acd527",5:"d8914a05"}[e]+".chunk.js"}(e);var c=new Error;u=function(r){a.onerror=a.onload=null,clearTimeout(l);var t=o[e];if(0!==t){if(t){var n=r&&("load"===r.type?"missing":r.type),u=r&&r.target&&r.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+u+")",c.name="ChunkLoadError",c.type=n,c.request=u,t[1](c)}o[e]=void 0}};var l=setTimeout((function(){u({type:"timeout",target:a})}),12e4);a.onerror=a.onload=u,document.head.appendChild(a)}return Promise.all(r)},i.m=e,i.c=n,i.d=function(e,r,t){i.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,r){if(1&r&&(e=i(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)i.d(t,n,function(r){return e[r]}.bind(null,n));return t},i.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(r,"a",r),r},i.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},i.p="/",i.oe=function(e){throw console.error(e),e};var a=this["webpackJsonpgithub.io.source"]=this["webpackJsonpgithub.io.source"]||[],c=a.push.bind(a);a.push=r,a=a.slice();for(var l=0;l<a.length;l++)r(a[l]);var f=c;t()}([])</script><script src="/static/js/2.bc1851d9.chunk.js"></script><script src="/static/js/main.d7849d10.chunk.js"></script><div role="presentation" class="MuiDrawer-root MuiDrawer-modal" aria-hidden="true" style="position: fixed; z-index: 1300; right: 0px; bottom: 0px; top: 0px; left: 0px; visibility: hidden;"><div class="MuiBackdrop-root" aria-hidden="true" style="opacity: 0; visibility: hidden;"></div><div tabindex="0" data-test="sentinelStart"></div><div class="MuiPaper-root MuiDrawer-paper jss9 jss16 MuiDrawer-paperAnchorRight MuiPaper-elevation16" tabindex="-1" style="visibility: hidden; transform: translateX(800px) translateX(-200px);"><div><div class="achive-drawer"><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Convenient <code>BottomSheet</code> Trigger in React-Native</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 17, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>各標點符號的倉頡碼</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 16, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>停用 mac 的 power button</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 15, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Prisma with SQLite for GUI Application in Rust</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 14, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Iced: First Trial to GUI Application in Rust</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 13, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Open Draw.io by Clicking a "Redirect" HTML</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 12, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Temporary Values get Killed After the end of a Statement</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 11, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>References don't Track Ownership Changes</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 11, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Implement ECDSA for Transaction Verification in a Blockchain</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 8, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>不工作學畫畫，3 年的美術人生</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 7, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>中學時期的插畫</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 6, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Rust Fundamentals</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 30, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Event Storming via PUML (Improved)</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 28, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>FastAPI and SqlAlchemy ORM in Python</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 26, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Create a Paging API in Spring Boot</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 24, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Drawing Fractal (Mandelbrot Set) in Rust</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 23, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Problem of SQL Based Nodejs Backend, Should we use Query Builder?</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 17, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Problems in Controller-Service-Repository That are Solvable by Tactical Design in DDD (Domain Driven Design)</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 16, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Performance Boost: Batch Insert in Spring Boot with Relations</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 14, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Use Bytecode Enhancement to Solve the Problem that @JoinColumn and @OneToOne Cannot be Truely Lazy</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 11, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>New Side Project using DDD was Added to Portfolio!</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 8, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p><code>react-dev-inspector</code>, an Alternative to <code>click-to-react-component</code></p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 4, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Links to Lucid-React Resources</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 2, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Spring Data MongoDB</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 28, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Multithreading with Semaphore</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 27, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Value Objects and Embedded Classes</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 23, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>PlantUML for EventSourcing and an GUI-application (for Editing)</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 17, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Postgresql and MySQL DB from Docker-Compose and Clone From Existing DB</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 2, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>居屋 2024 注意時項</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 30, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Multi-threading For Elementary Tasks in Browsers</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 22, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>A Simple Proof to Stirling's Formula <span><script type="math/tex; ">n!\sim \sqrt{2\pi n} \left(\frac{n}{e}\right)^n</script></span></p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 1, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>JPA Case Study: When repository.delete(someEntity) failed in a transaction <em>silently</em></p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 30, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Two kinds of Side Effects in JPA</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 28, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Migrate from ThunkActions to RTK-Query</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 21, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Float Desired Folders on Top in Vscode</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 17, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Fundamentals of Nestjs</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 5, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Deletion of a VPC with Dangling/Orphaned ENIs</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 21, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Migration from Terraform-Cloud to S3-Backend; Study on Terragrunt</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 18, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>PR and Empty Git Commit via SimpleGit in Nodejs</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 9, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Environment Variables via Secret Managers in Backend using Expo Approach</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 6, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>How to Build an NPM Package?</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 2, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Count Execution Time of a Shell Script</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 30, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Replace Redux by Zustand and React-Query</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 28, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Recover Bullet-Points and Ordered List Overriden by Tailwind</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 25, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>How to work with Multiple ENV files in Serverless Framework??</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 24, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p><code>useBlocker</code> hook to Block the Change of Route for Unsaved Update</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 22, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>"In-line" Policies via Serverless.yml: ① Self-Invokation ② s3 GetObject</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 20, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Transform Execls file Into Json</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 14, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Amazon EventBridge Schedule to Trigger Springboot Endpoint</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 13, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Google Login in Popup Window</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 12, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Import Existing Resources Into Terraform Project</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 9, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Terraform Modularization for DRY Deployment from DEV to UAT and Input Infrastructure Information</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 7, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Lambda Client</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 1, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Custom Modal Simplification</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 30, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Code Separation of Domain Entity Class, Domain Behaviour (Actions) and the Corresponding Validations</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 24, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>AWS Websocket-API 2: Complete Integration of React and Spring Boot using Websocket-API from API-Gateway</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 22, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Combine useQuery and Redux Toolkit Thunk Actions</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 21, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Generate Typescript Interfaces from Swagger-UI</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 20, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Run npm Script Using Gradle Task</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 19, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Mongo in "JPA": spring-boot-starter-data-mongodb</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 18, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Manage Multiple Github Accounts Using SSH Keys in One Machine</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 16, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Speed up Data Migration using JPA with Channels and CountDownLatch</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 15, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Deduplicate data in Database</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 14, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Toolkits and Caveats Working with Spring Boot and JPA</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 13, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>CLI Program by Bubble Tea</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 8, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Pruning old Lambda Functions</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 4, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Golang Simple yet Useful Knowledge</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 2, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Terraform Project to Manage Console-Created Lambdas</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 27, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Terraform from Real Project Experience: ECS, Lambda, RDS, RDS-Proxy, VPC, VPC-Endpoints and IAM-Roles</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 15, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Self-Managed Kubenetes Cluster Using k3s, EC2 and RDS</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 13, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>General Concept in Terraform (Revisited)</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 19, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Connection to RDS-Proxy Using Lambda Functions</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 13, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>AWS Presigned URLs for File-Uploading</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 12, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>AWS Websocket-API 1: An overview from API Gateway</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 5, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>① Swagger-UI for Spring Boot in SnapStarted Lambda ② Automation of  Authorization-Header Assignment for API Testings ③ Basic Functionalities</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 2, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>React-Query Fundamentals</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 1, 2025</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Unit Testing in Kotlin with MockK</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 31, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Pragmatic drag and drop from Atlassian Design System</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 29, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>JPA and DDD Notes from Real Project Experience</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 29, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>General Purpose Dialog using MUI with Flexible { xs, sm, md, lg, ...etc } Widths</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Auto-generated Mapper From Entity Classes into DTO Classes</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 24, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Redirect from 3rd-party Subdomain (WIX in our example) to AWS Cloudfront Distribution Where we host our Frontend</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 22, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Architecture for Private Lamdba functions called via another lambda function</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 19, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Multiple Ngroks Via Docker Compose</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 18, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Set up ESLINT and Husky for Vite React Project</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 16, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Useful Util Functions to Log Excutation time and the Hibernate Generated Query within a code block by Trailing Closures</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 2, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Email Configuration for Spring Boot in SnapStarted Lambda</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 1, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Redis Task Distribution in Kotlin</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 30, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>HTTP Request Logger in Springboot</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Testcontainer, a Replacement of In-Memory Database in Testing</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 18, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Postman Scripts for Testing and Setting Results into Environment Variables</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 17, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Snapstarted Lambda running Spring Boot and Transition into Spring Boot as a Node.js Developer</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 16, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>ApplicationEventPublisher with Decorators for Domain Driven Design</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 9, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Doubly-Linked List in Typescript</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 8, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Lambda Function Running Python Docker Image</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 6, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Github Action: Docker Action in Python to get Artifact of CloudWatch Logging</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 5, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Scheduled Tasks in ECS: Demonstration via Regular Database Backup</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 27, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Create an HTML via a PDF File!</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 26, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Restore MongoDB from Backup</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 25, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Restore PostgreSQL DB from Backup</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 25, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Github Action: workflow_dispatch</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 24, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>JPA with DB-First Approach: Surgery on JOOQ's POJO into Base @Entity Class</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 20, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>RevenueCat Fundamentals</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 10, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Distributive Lock in Kotlin</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 4, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Application Event Publisher for Monolithic DDD in Nodejs</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 30, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Run Blocking Servlet Requests to Achieve Non-Blocking Performance</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 23, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>SSE, Coroutine and Channel to Notify Frontend for Stripe Events in Spring Boot and Kotlin</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 21, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Function Literals with Receiver</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 16, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Stripe Technical Detail for Add, Upgrade, Downgrade, and Cancel Subscrpition</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 15, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Customization on build.gradle.kts</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 12, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Lambda Function Running Spring Boot in Docker Image</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 7, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Lambda Function Running Nodejs Docker Image</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 6, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Containerization of Spring Boot Application in Kotlin and Troubles in Deployment through ECS</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 5, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Joda Time</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 27, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Monolithic DDD Without ORM by Separating Data and Domain Behaviour</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 21, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Dockerfile for Springboot Application in Gradle</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 17, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Useful Query in JOOQ</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 12, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Custom Overlay Scrollbar Container</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 11, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Stripe Events and metadata in Stripe Checkout Sessions</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 10, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Quartz DeadlineManager in Saga</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 10, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Json Query in PostgreSQL for domain_event_entry in Axon Framework</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 9, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Access Nested Properties from Json String in Kotlin</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 8, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>CORS Configuration for HandlerInterceptors via Spring Security</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 7, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Logging of Commands and Events in Axon Framework</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 6, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>AOP in Kotlin</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 5, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Send Gmail in Kotlin</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 4, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Subscription Query and Error Handling of API Calls</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 3, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Logger in Kotlin</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 1, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Routing Config in React Router v6</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 29, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>A Minimal Example for react-beautiful-dnd</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Git-Crypt Study</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 27, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Create a React-App via Vite, Config for MUI, Load Env Variable from Custom Files.</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 14, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Various ways of Implementing Chatroom Input Field in React Native</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 13, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>K8S Basics Part III: EKS and Container Logging of Pods in CloudWatch via Fluentbit</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 29, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>K8S Basics Part II: Networking</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>K8S Basics Part I: Deployment, Service, Volume and ConfigMap</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 27, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Time-Series Data via WIDTH_BUCKET and Multi-Column Chart</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 26, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>JWT in Spring boot II: Get rid of Spring-Security. More on Parsing Json String into Pojo</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 24, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>JWT in Spring boot I: Using Spring-Security</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 23, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Gradle Fundamentals: Modularization of Spring Boot Project and Dependencies Control</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 22, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Global Exception Handler</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 18, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Simple Study of Transaction</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 17, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Event Publishing and Listening in Spring boot</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 16, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>① Spring boot in Kotlin with JOOQ and Prisma ② Simple Commands for Gradles ③ Integration and Unit Tests</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 15, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Role and User Management in PostgreSQL</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 7, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Record my IntelliJ IDE Setting</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 6, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Get the full type hint from VSCode</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 31, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Github Actions for Serverless Functions</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 23, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Download the Entire CloudWatch Log</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 9, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Self-Reflection on Database Schema Design</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 2, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Kafka and Debezium with Everything Hosted Locally Without Confluent</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>EAS Update</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 17, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>CRUD in DynamoDB</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 16, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>AWS CDK in Typescript and Python with ① Application in S3 ② Lambda Functions with Debugging ③ API Gateway and ④ DynamoDB</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 15, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Create Custom Layer for Lambda Functions in Python</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 12, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>More About Lambda Functions, Thottling, Concurrency, RDS-Proxy and Integration with CloudWatch Events</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 4, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Dev Container</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 29, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>CDC in Confluent and Kafka</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Read Write Lock for Go</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 24, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Channel and WaitGroup</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 23, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Custom HashTable by Separate Chaining</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 15, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>In-App Notification</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 14, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Code Organization for RabbitMQ</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 3, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>How to <code>node your-script.js --env=some_env</code></p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 2, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>SQL Functions to Generate created_at, human-readable created_at and updated_at</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 1, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>As-With Clause in SQL</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 28, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Javascript Compatible Timestamp in PostgreSQL</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 27, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Use ULID in PostgreSQL</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 26, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Forcefully Make Prisma Ignore The Changes in a Migrated .sql File</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 25, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Prisma Migration Script</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 25, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Declare Types for Non-typed 3rd Party Library</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 24, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Push-Notification in Android and iOS via Expo</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 20, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Code Organization for Redis</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 27, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Auto-hotkey Config for Vscode Switching (Windows)</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 26, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Github Action for Deployment on ECS Fargate</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 22, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Algolia Revisit</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 21, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Fundamentals of Github Actions</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 16, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Advanced Combat Tracker (ACT): Scriping for Trigger</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 11, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Reverse Engineer PostgreSQL to Go Structs</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 6, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Minimal Code for Setting Prisma as Just a Table Migration tool</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 5, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Paste Image in Markdown Files from Clipboard</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 4, 2024</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Dead-letter and Delayed Queues</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 24, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Run Kysely Generated SQL in Tableplus</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 23, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Springboot with JOOQ and Functional Endpoints</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 17, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>TSS as a Replacement of makeStyles</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Manage Environment Varisbles for Dev, Uat, Prod in Springboot Using a Single Yaml File</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 8, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Prisma, Prisma-Kysely and Kysely</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 30, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Frontend Retry Mechanism for Refresh Token</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 20, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Load Test and Stress Test by Gatling</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 19, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Record Table Migration Script in SQL</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 17, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Load Environment Variables from Aws Secret Managers and Run Shell Script in Go for DB Schema Migration Based on DB_URL from Secrets</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 15, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Two Stage Docker Image; Docker-Compose with Service B waiting for the Connection of Service A</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 14, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Complete Golang Project Structure</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 13, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Send Google Gmail Without Sendgrid</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 12, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>SQL for Table Migrations in the Course of Developement</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 11, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Transactions, Go and sqlc</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 6, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Make a Custom Swipable Item</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 5, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>PostgreSQL Revisit</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 4, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Docker Containerization of Nodejs with Typescript</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Custom Winston Logger in Nodejs</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Mongoose way to Convert String into Objectid in Aggregation</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 2, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Goose and Sqlc for Database Migration and Query Function Generation</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 28, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Push Data to Frontend by SSE via Event-Driven Approach with NO Short Polling</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 22, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>@gorhom/bottom-sheet</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 21, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Generate Excel by Openpyxl</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 20, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Long Running Task in Background for Mobile App</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 17, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Terraform Modules</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 16, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Remote State for Whole Development Team; Create and Deploy on a Public Subnet of Custom VPC</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 15, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Conditions and Loops</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 14, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Variables and Remote Execution</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 13, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>AWS Resources Instanciation in Terraform</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Pin to Zoom Camera</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 9, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Audio Recording in React-Native</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 7, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>AWS Fargate: Let's Create Service and Run Task!</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 7, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>File Upload and Download Using Stream and FormData in React-Native</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 5, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Custom BottomSheet</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Custom Toast Messages</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 1, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Expo-CLI for Development Build</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 30, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Clone a Swipable Page Inspired from Discord Mobile App</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 26, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Auto-Incremented Id for Mongo Collection</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 24, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Voice Chat on Mobile Using AgoraRTC</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 23, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Create a left-join in Mongoose</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 21, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Scaling Websocket Chat Sever by Redis</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 20, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Simple Chat Server in Rust via Telnet</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 19, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Setup of Express with Socket.io with JWT Authentication Using Cookie</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 16, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Jest Fundamentals in TS</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 15, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Environment Variable by env-cmdrc</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 11, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Rust Formatter Configruation</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Elliptic Curve and Operator Overloading</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 9, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Routing Schema for Frontend Project</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 5, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Rust Study Notes</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 4, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Restrict CORS to Limited Origins</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Handle Streams in File-Responding Request</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Server Sent Event in Java and Node.js Backend</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Scroll Up and Down Events in React</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 2, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Box Shadow</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 27, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Hook to Rerender Component By Making use of the Single Threaded Event Driven Model Behind v8</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 15, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>forwardRef and useImperativeHandle</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 14, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Google Login</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 13, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Getting Path Parameters</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 11, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Snackbar Utils</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Multi-Selections</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 3, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Write Mongo Aggregation Using JSON in Springboot</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 30, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Detect Click Outside</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 27, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Build a Search Function</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 26, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Serverless Flask and Serverless Express-ts</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 19, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Gmail and Inbox Push Notification</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 17, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Flask with Uwsgi and Docker Image Deployment</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Deployment of React Project Using S3 and Cloudfront</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 8, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Lazy Loading</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 5, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>normalizr --- Convert Array of Data Into Hashmap</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 5, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Remote Debugger for Spring Application</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 2, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>.gitlab-ci.yml for Deploying Static Pages to S3</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 28, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Docker Run Indefinitely</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 25, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>tsconfig.json</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 24, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Revisit Docker and Gitlab-CI</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 23, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Quick Step to Make a Reducer Persist its Data</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 21, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Radio Buttons Group and General Dropdown List</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 21, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Scrollbar Style Like Mac</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 20, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Write Middlewares in Redux-Toolkit</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 20, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Use of dayjs</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 16, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Two Kinds of $lookup, and use Javascript in Advanced lookup</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 15, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Inner and Left Joining Multiple Collections in Mongo --- The preserveNullAndEmptyArrays in $unwind</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 15, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Redux Slice Template</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 13, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>List of Mongo Aggregation Pipelines that I have Used.</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Mui CSS Animation with Keyframes</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 9, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Data Scrapping for Data that Requires Click by Click</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 27, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>General Post Request in Springboot and File Uploading</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 25, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Register URL Scheme for an Application</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 6, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>std::variant</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 5, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Libtorch Study Notes With OpenCV</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 2, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Precompiled Header in CMake Project</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 27, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Control C++ Standard Accurately</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 24, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Install Opencv and Libtorch for CMake Project</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 20, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Diffusion Model Study</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 7, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Commuication Between Two Threads</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 27, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>C++ Useful Util Functions Mimiced from Python, Regular Expression</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 9, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>C++ VSCode says it cannot open source file when it really can</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 28, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Pytorch/libtorch with CPP API</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 11, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Socket Programming Fundamentals by winsock</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 10, 2023</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Simple Introduction to CMake Files</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Gray Matter</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 14, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>TCP Server Fundamental</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 12, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Variadic Version of Print in C++</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 9, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Iterator</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 30, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Array and Dynamic Array Class</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 29, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Precompiled Header</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 27, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Copy Constructor</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 23, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Visual Studio Solution Configuration</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 16, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>makeStyles for react-mui v5.0 and tss-react/mui</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Redux Toolkit Quick Setup</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Config Files Organization in Frontend Project (Next.js Specific)</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Onnx Model Deployment to Frontend From Pytorch Model</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 14, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>RetinaFace</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 6, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Albumentations and Common Helper Functions with PyTorch</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 5, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>collate_fn in pytorch</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 3, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>CPP VSCode Configuration for 2020 Standard</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 8, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Cascade RCNN</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 30, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Squeeze and Excitation Network</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 29, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Gradient Clipping</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 22, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Swin-Transformer Backbone in Faster RCNN</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 20, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Swin Transformer with einops Implementation</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 19, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Mesh Grid Trick</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 7, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Vision Transformer with einops Implementation</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 6, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Angular Fundamental</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 18, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Transformer 2: A More in Depth Training with Real World Dataset Using Modern NLP Dataset Pipeline in Pytorch</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 17, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Transformer 1: The Model Definition and Naive Training Dataset for Machine Translation</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 11, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Retrain Model when Nan Occurs</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 22, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Feature Extractors</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 14, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Data Augmentation for Object Detection</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 30, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Faster RCNN in PyTorch</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>June 27, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>EAST: A Text Detection Algorithm</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 29, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>CV2, Pillow and shapely for Polygons</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 28, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Masks in Numpy and Retrive Corresponding Indexes</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 28, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>tqdm: The Progress bar for Iterations</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 27, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Logging Without Printing New Lines</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 23, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Pytorch Fundamentals</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 23, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Shell Script Fundamentals</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 20, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Install tensorflow-gpu</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>DefectGAN</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>May 9, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Singular Value Decomposition</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 30, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Principal Component Analysis</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 30, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Pandoc</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 29, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>WGAN and WGAN-GP</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 22, 2022</i></div></div><div class="toc-home-row active"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>YOLOv3 Deep Dive</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 22, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Different Kinds of Residue Blocks</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 20, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Element that has Default Fade-in Transition on Mount</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 19, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Discrete Cosine Transform and JPEG Compression Implementation in Python</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 16, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Summarize Rust Beginning Tutorial by a Simplified Multithreading Web Server</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>SSH Config and Download File in SSH Client</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 12, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Typescript Debugger Config</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 11, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>pathlib and json in Python</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 7, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Countability of a kind of Discontinuity</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 4, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Color-GAN with Auto-Coloring on Animated Gray Images</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>April 1, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Ctrl- and Middle-Clickable Button;  Method to Scroll to Target Element</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 30, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Mongoose in Nodejs and Mongoengine in Python</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 29, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Cycle-GAN in Tensorflow</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 25, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Two Methods to Read Excel Files in Python</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 24, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Type Annotation Record in Typescript for 3rd-party Library and Usual Import</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 23, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Resulting Shapes of Conv-net by Direct Experiment</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 23, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Simple Introduction to mAP and F1-Score</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 21, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Additional Configuration for makeStyles in Next js</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 13, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>How to Configure S3 to Send SQS Message</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 10, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Customized Logger in Python and Javascript</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>March 7, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Set up Local Environment for Mongo using Docker</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 25, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>GAN and DCGAN in Tensorflow</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>February 15, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Python Generator</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>January 4, 2022</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Nodejs Image Compression in Backend with sharp</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 16, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Call Python Script in Node.js</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 11, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Nextjs with Electron</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 6, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Debug Nextjs with Typescript in VSCode</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 2, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Debug Javascript For Individual File</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>December 1, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Datetime Object in Python</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>November 20, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Decompose a Class into Separate Files</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 26, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Python Debugger with Project Directory Included in sys.path</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 25, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>How to Include Project Directory in sys.path when Running pytest</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 20, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Auto Hotkey Record</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 17, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Automation Task for Chrome</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 2, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>First to Leave Problem of Elevator</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>October 1, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Live2D 心得</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 18, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p><span><script type="math/tex; ">\LaTeX</script></span> template</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 10, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>C++ Beginner Notes 02 - Shallow Copy, Deep Copy and Move Semantics</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 9, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>C++ Beginner Notes 01 - Stack and Heap</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>September 8, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Scrapping Images with Selenium and Beautifulsoup on Chrome</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 30, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Image Augmentation with Custom Dataset Pipeline</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 29, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Transfer Learning Based on VGG-16</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 28, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Tensorflow Callbacks and Restart Training Process Based on Past Epoches</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 28, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Comprehensive List of SVG Icon Available in React</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 27, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Colab Setting</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 27, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Dataset Pipeline and Custom Training in Tensorflow</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 26, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>The Set Equality <span><script type="math/tex; ">\overline{C} = \overline{C^\circ}</script></span> for Convex Set <span><script type="math/tex; ">C</script></span></p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 20, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Understand Pytorch via GAN</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 20, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Computational Example on Probability Distribution</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 19, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Make your React App Scrapable by Google Search Engine</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 14, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Disqus Comment Plug-in in React</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 12, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Convex Analysis - More on Convex Functions and Characterize Convex lsc Functions by Biconjugate Functionals</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 11, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Convex Analysis - Characterization of Convex lsc Functions</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>August 8, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Exercises on Algorithms</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 26, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Algorithm: Merge Sort and its Time Complexity</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 25, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>On Redux-Saga</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 19, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Useful Conda Commands</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 18, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Review of Basic Statistics</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 15, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Typescript Type Tricks</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 14, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>On Looping all Files in Frontend</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 13, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Lazy React Router</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 12, 2021</i></div></div><div class="toc-home-row"><div class="toc-home-title"><span class="toc-home-title-text"><div><p>Study Notes on Distribution and Latent Variable Model in Vartiaonal Auto Encoder</p></div></span></div><div style="border-top: 1px solid rgba(0, 0, 0, 0.1);"></div><div class="toc-home-date"><i>July 10, 2021</i></div></div></div></div></div></div><div tabindex="0" data-test="sentinelEnd"></div></div><div role="presentation" class="MuiDrawer-root MuiDrawer-modal" aria-hidden="true" style="position: fixed; z-index: 1300; right: 0px; bottom: 0px; top: 0px; left: 0px; visibility: hidden;"><div class="MuiBackdrop-root" aria-hidden="true" style="opacity: 0; visibility: hidden;"></div><div tabindex="0" data-test="sentinelStart"></div><div class="MuiPaper-root MuiDrawer-paper jss9 jss21 MuiDrawer-paperAnchorRight MuiPaper-elevation16" tabindex="-1" style="visibility: hidden; transform: translateX(800px) translateX(-300px);"><div><div class="tags-drawer"><div style="height: 20px; width: 5px; min-height: 20px; user-select: none; display: block;"></div><div class="tags-drawer-header"><h3>All Categories</h3><button class="close-button" aria-label="Close drawer"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>Close</button></div><div style="height: 24px; width: 5px; min-height: 24px; user-select: none; display: block;"></div><div class="search-section MuiBox-root css-1nspjci"><div class="MuiFormControl-root MuiTextField-root tag-search-input MuiFormControl-fullWidth" style="outline: none;"><div class="MuiInputBase-root MuiOutlinedInput-root MuiInputBase-fullWidth MuiInputBase-formControl MuiInputBase-adornedStart MuiOutlinedInput-adornedStart MuiInputBase-marginDense MuiOutlinedInput-marginDense" style="outline: none;"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true" style="margin-right: 8px; color: rgb(102, 102, 102);"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg><input aria-invalid="false" placeholder="Search tags..." type="text" class="MuiInputBase-input MuiOutlinedInput-input MuiInputBase-inputAdornedStart MuiOutlinedInput-inputAdornedStart MuiInputBase-inputMarginDense MuiOutlinedInput-inputMarginDense" value=""><fieldset aria-hidden="true" class="jss47 MuiOutlinedInput-notchedOutline" style="padding-left: 8px;"><legend class="jss48" style="width: 0.01px;"><span>​</span></legend></fieldset></div></div></div><div style="height: 16px; width: 5px; min-height: 16px; user-select: none; display: block;"></div><div class="clear-select-section"><button class="clear-select-button disabled" disabled="">Clear Selection</button></div><div class="tags-drawer-content"></div></div></div></div><div tabindex="0" data-test="sentinelEnd"></div></div></body></html>